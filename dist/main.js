"use strict";var Dg=Object.create;var Nn=Object.defineProperty,Lg=Object.defineProperties,qg=Object.getOwnPropertyDescriptor,Fg=Object.getOwnPropertyDescriptors,Bg=Object.getOwnPropertyNames,Kc=Object.getOwnPropertySymbols,Ug=Object.getPrototypeOf,Qc=Object.prototype.hasOwnProperty,zg=Object.prototype.propertyIsEnumerable;var Xc=(r,e,t)=>e in r?Nn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Zc=(r,e)=>{for(var t in e||(e={}))Qc.call(e,t)&&Xc(r,t,e[t]);if(Kc)for(var t of Kc(e))zg.call(e,t)&&Xc(r,t,e[t]);return r},eu=(r,e)=>Lg(r,Fg(e));var tu=(r,e)=>()=>(r&&(e=r(r=0)),e);var p=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),ru=(r,e)=>{for(var t in e)Nn(r,t,{get:e[t],enumerable:!0})},nu=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Bg(e))!Qc.call(r,i)&&i!==t&&Nn(r,i,{get:()=>e[i],enumerable:!(n=qg(e,i))||n.enumerable});return r};var ga=(r,e,t)=>(t=r!=null?Dg(Ug(r)):{},nu(e||!r||!r.__esModule?Nn(t,"default",{value:r,enumerable:!0}):t,r)),iu=r=>nu(Nn({},"__esModule",{value:!0}),r);var q=(r,e,t)=>new Promise((n,i)=>{var s=l=>{try{o(t.next(l))}catch(c){i(c)}},a=l=>{try{o(t.throw(l))}catch(c){i(c)}},o=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,a);o((t=t.apply(r,e)).next())});var mi=p(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.toCommandProperties=kr.toCommandValue=void 0;function jg(r){return r==null?"":typeof r=="string"||r instanceof String?r:JSON.stringify(r)}kr.toCommandValue=jg;function Hg(r){return Object.keys(r).length?{title:r.title,file:r.file,line:r.startLine,endLine:r.endLine,col:r.startColumn,endColumn:r.endColumn}:{}}kr.toCommandProperties=Hg});var lu=p(Ie=>{"use strict";var $g=Ie&&Ie.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Gg=Ie&&Ie.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Wg=Ie&&Ie.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&$g(e,r,t);return Gg(e,r),e};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.issue=Ie.issueCommand=void 0;var Vg=Wg(require("os")),au=mi();function ou(r,e,t){let n=new ma(r,e,t);process.stdout.write(n.toString()+Vg.EOL)}Ie.issueCommand=ou;function Jg(r,e=""){ou(r,{},e)}Ie.issue=Jg;var su="::",ma=class{constructor(e,t,n){e||(e="missing.command"),this.command=e,this.properties=t,this.message=n}toString(){let e=su+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let t=!0;for(let n in this.properties)if(this.properties.hasOwnProperty(n)){let i=this.properties[n];i&&(t?t=!1:e+=",",e+=`${n}=${Kg(i)}`)}}return e+=`${su}${Yg(this.message)}`,e}};function Yg(r){return au.toCommandValue(r).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function Kg(r){return au.toCommandValue(r).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}});var ya=p(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.default=Zg;var Xg=Qg(require("crypto"));function Qg(r){return r&&r.__esModule?r:{default:r}}var yi=new Uint8Array(256),vi=yi.length;function Zg(){return vi>yi.length-16&&(Xg.default.randomFillSync(yi),vi=0),yi.slice(vi,vi+=16)}});var cu=p(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.default=void 0;var em=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;_i.default=em});var kn=p(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});Si.default=void 0;var tm=rm(cu());function rm(r){return r&&r.__esModule?r:{default:r}}function nm(r){return typeof r=="string"&&tm.default.test(r)}var im=nm;Si.default=im});var Pn=p(Ei=>{"use strict";Object.defineProperty(Ei,"__esModule",{value:!0});Ei.default=void 0;var sm=am(kn());function am(r){return r&&r.__esModule?r:{default:r}}var ce=[];for(let r=0;r<256;++r)ce.push((r+256).toString(16).substr(1));function om(r,e=0){let t=(ce[r[e+0]]+ce[r[e+1]]+ce[r[e+2]]+ce[r[e+3]]+"-"+ce[r[e+4]]+ce[r[e+5]]+"-"+ce[r[e+6]]+ce[r[e+7]]+"-"+ce[r[e+8]]+ce[r[e+9]]+"-"+ce[r[e+10]]+ce[r[e+11]]+ce[r[e+12]]+ce[r[e+13]]+ce[r[e+14]]+ce[r[e+15]]).toLowerCase();if(!(0,sm.default)(t))throw TypeError("Stringified UUID is invalid");return t}var lm=om;Ei.default=lm});var hu=p(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.default=void 0;var cm=du(ya()),um=du(Pn());function du(r){return r&&r.__esModule?r:{default:r}}var uu,_a,Sa=0,Ea=0;function dm(r,e,t){let n=e&&t||0,i=e||new Array(16);r=r||{};let s=r.node||uu,a=r.clockseq!==void 0?r.clockseq:_a;if(s==null||a==null){let h=r.random||(r.rng||cm.default)();s==null&&(s=uu=[h[0]|1,h[1],h[2],h[3],h[4],h[5]]),a==null&&(a=_a=(h[6]<<8|h[7])&16383)}let o=r.msecs!==void 0?r.msecs:Date.now(),l=r.nsecs!==void 0?r.nsecs:Ea+1,c=o-Sa+(l-Ea)/1e4;if(c<0&&r.clockseq===void 0&&(a=a+1&16383),(c<0||o>Sa)&&r.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Sa=o,Ea=l,_a=a,o+=122192928e5;let u=((o&268435455)*1e4+l)%4294967296;i[n++]=u>>>24&255,i[n++]=u>>>16&255,i[n++]=u>>>8&255,i[n++]=u&255;let d=o/4294967296*1e4&268435455;i[n++]=d>>>8&255,i[n++]=d&255,i[n++]=d>>>24&15|16,i[n++]=d>>>16&255,i[n++]=a>>>8|128,i[n++]=a&255;for(let h=0;h<6;++h)i[n+h]=s[h];return e||(0,um.default)(i)}var hm=dm;bi.default=hm});var ba=p(Ci=>{"use strict";Object.defineProperty(Ci,"__esModule",{value:!0});Ci.default=void 0;var fm=pm(kn());function pm(r){return r&&r.__esModule?r:{default:r}}function gm(r){if(!(0,fm.default)(r))throw TypeError("Invalid UUID");let e,t=new Uint8Array(16);return t[0]=(e=parseInt(r.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(r.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(r.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(r.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(r.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}var mm=gm;Ci.default=mm});var Ca=p(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.default=Sm;fr.URL=fr.DNS=void 0;var vm=fu(Pn()),ym=fu(ba());function fu(r){return r&&r.__esModule?r:{default:r}}function _m(r){r=unescape(encodeURIComponent(r));let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t));return e}var pu="6ba7b810-9dad-11d1-80b4-00c04fd430c8";fr.DNS=pu;var gu="6ba7b811-9dad-11d1-80b4-00c04fd430c8";fr.URL=gu;function Sm(r,e,t){function n(i,s,a,o){if(typeof i=="string"&&(i=_m(i)),typeof s=="string"&&(s=(0,ym.default)(s)),s.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+i.length);if(l.set(s),l.set(i,s.length),l=t(l),l[6]=l[6]&15|e,l[8]=l[8]&63|128,a){o=o||0;for(let c=0;c<16;++c)a[o+c]=l[c];return a}return(0,vm.default)(l)}try{n.name=r}catch(i){}return n.DNS=pu,n.URL=gu,n}});var mu=p(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.default=void 0;var Em=bm(require("crypto"));function bm(r){return r&&r.__esModule?r:{default:r}}function Cm(r){return Array.isArray(r)?r=Buffer.from(r):typeof r=="string"&&(r=Buffer.from(r,"utf8")),Em.default.createHash("md5").update(r).digest()}var Tm=Cm;Ti.default=Tm});var yu=p(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});Ri.default=void 0;var Rm=vu(Ca()),wm=vu(mu());function vu(r){return r&&r.__esModule?r:{default:r}}var Om=(0,Rm.default)("v3",48,wm.default),Am=Om;Ri.default=Am});var Su=p(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});wi.default=void 0;var Nm=_u(ya()),km=_u(Pn());function _u(r){return r&&r.__esModule?r:{default:r}}function Pm(r,e,t){r=r||{};let n=r.random||(r.rng||Nm.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(let i=0;i<16;++i)e[t+i]=n[i];return e}return(0,km.default)(n)}var Im=Pm;wi.default=Im});var Eu=p(Oi=>{"use strict";Object.defineProperty(Oi,"__esModule",{value:!0});Oi.default=void 0;var Mm=xm(require("crypto"));function xm(r){return r&&r.__esModule?r:{default:r}}function Dm(r){return Array.isArray(r)?r=Buffer.from(r):typeof r=="string"&&(r=Buffer.from(r,"utf8")),Mm.default.createHash("sha1").update(r).digest()}var Lm=Dm;Oi.default=Lm});var Cu=p(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});Ai.default=void 0;var qm=bu(Ca()),Fm=bu(Eu());function bu(r){return r&&r.__esModule?r:{default:r}}var Bm=(0,qm.default)("v5",80,Fm.default),Um=Bm;Ai.default=Um});var Tu=p(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});Ni.default=void 0;var zm="00000000-0000-0000-0000-000000000000";Ni.default=zm});var Ru=p(ki=>{"use strict";Object.defineProperty(ki,"__esModule",{value:!0});ki.default=void 0;var jm=Hm(kn());function Hm(r){return r&&r.__esModule?r:{default:r}}function $m(r){if(!(0,jm.default)(r))throw TypeError("Invalid UUID");return parseInt(r.substr(14,1),16)}var Gm=$m;ki.default=Gm});var wu=p(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Object.defineProperty(Ye,"v1",{enumerable:!0,get:function(){return Wm.default}});Object.defineProperty(Ye,"v3",{enumerable:!0,get:function(){return Vm.default}});Object.defineProperty(Ye,"v4",{enumerable:!0,get:function(){return Jm.default}});Object.defineProperty(Ye,"v5",{enumerable:!0,get:function(){return Ym.default}});Object.defineProperty(Ye,"NIL",{enumerable:!0,get:function(){return Km.default}});Object.defineProperty(Ye,"version",{enumerable:!0,get:function(){return Xm.default}});Object.defineProperty(Ye,"validate",{enumerable:!0,get:function(){return Qm.default}});Object.defineProperty(Ye,"stringify",{enumerable:!0,get:function(){return Zm.default}});Object.defineProperty(Ye,"parse",{enumerable:!0,get:function(){return ev.default}});var Wm=Ot(hu()),Vm=Ot(yu()),Jm=Ot(Su()),Ym=Ot(Cu()),Km=Ot(Tu()),Xm=Ot(Ru()),Qm=Ot(kn()),Zm=Ot(Pn()),ev=Ot(ba());function Ot(r){return r&&r.__esModule?r:{default:r}}});var ku=p(Me=>{"use strict";var tv=Me&&Me.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),rv=Me&&Me.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Au=Me&&Me.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&tv(e,r,t);return rv(e,r),e};Object.defineProperty(Me,"__esModule",{value:!0});Me.prepareKeyValueMessage=Me.issueFileCommand=void 0;var Ou=Au(require("fs")),Ta=Au(require("os")),nv=wu(),Nu=mi();function iv(r,e){let t=process.env[`GITHUB_${r}`];if(!t)throw new Error(`Unable to find environment variable for file command ${r}`);if(!Ou.existsSync(t))throw new Error(`Missing file at path: ${t}`);Ou.appendFileSync(t,`${Nu.toCommandValue(e)}${Ta.EOL}`,{encoding:"utf8"})}Me.issueFileCommand=iv;function sv(r,e){let t=`ghadelimiter_${nv.v4()}`,n=Nu.toCommandValue(e);if(r.includes(t))throw new Error(`Unexpected input: name should not contain the delimiter "${t}"`);if(n.includes(t))throw new Error(`Unexpected input: value should not contain the delimiter "${t}"`);return`${r}<<${t}${Ta.EOL}${n}${Ta.EOL}${t}`}Me.prepareKeyValueMessage=sv});var Iu=p(Pr=>{"use strict";Object.defineProperty(Pr,"__esModule",{value:!0});Pr.checkBypass=Pr.getProxyUrl=void 0;function av(r){let e=r.protocol==="https:";if(Pu(r))return;let t=(()=>e?process.env.https_proxy||process.env.HTTPS_PROXY:process.env.http_proxy||process.env.HTTP_PROXY)();if(t)return new URL(t)}Pr.getProxyUrl=av;function Pu(r){if(!r.hostname)return!1;let e=process.env.no_proxy||process.env.NO_PROXY||"";if(!e)return!1;let t;r.port?t=Number(r.port):r.protocol==="http:"?t=80:r.protocol==="https:"&&(t=443);let n=[r.hostname.toUpperCase()];typeof t=="number"&&n.push(`${n[0]}:${t}`);for(let i of e.split(",").map(s=>s.trim().toUpperCase()).filter(s=>s))if(n.some(s=>s===i))return!0;return!1}Pr.checkBypass=Pu});var Lu=p(Ir=>{"use strict";var fR=require("net"),ov=require("tls"),Ra=require("http"),Mu=require("https"),lv=require("events"),pR=require("assert"),cv=require("util");Ir.httpOverHttp=uv;Ir.httpsOverHttp=dv;Ir.httpOverHttps=hv;Ir.httpsOverHttps=fv;function uv(r){var e=new At(r);return e.request=Ra.request,e}function dv(r){var e=new At(r);return e.request=Ra.request,e.createSocket=xu,e.defaultPort=443,e}function hv(r){var e=new At(r);return e.request=Mu.request,e}function fv(r){var e=new At(r);return e.request=Mu.request,e.createSocket=xu,e.defaultPort=443,e}function At(r){var e=this;e.options=r||{},e.proxyOptions=e.options.proxy||{},e.maxSockets=e.options.maxSockets||Ra.Agent.defaultMaxSockets,e.requests=[],e.sockets=[],e.on("free",function(n,i,s,a){for(var o=Du(i,s,a),l=0,c=e.requests.length;l<c;++l){var u=e.requests[l];if(u.host===o.host&&u.port===o.port){e.requests.splice(l,1),u.request.onSocket(n);return}}n.destroy(),e.removeSocket(n)})}cv.inherits(At,lv.EventEmitter);At.prototype.addRequest=function(e,t,n,i){var s=this,a=wa({request:e},s.options,Du(t,n,i));if(s.sockets.length>=this.maxSockets){s.requests.push(a);return}s.createSocket(a,function(o){o.on("free",l),o.on("close",c),o.on("agentRemove",c),e.onSocket(o);function l(){s.emit("free",o,a)}function c(u){s.removeSocket(o),o.removeListener("free",l),o.removeListener("close",c),o.removeListener("agentRemove",c)}})};At.prototype.createSocket=function(e,t){var n=this,i={};n.sockets.push(i);var s=wa({},n.proxyOptions,{method:"CONNECT",path:e.host+":"+e.port,agent:!1,headers:{host:e.host+":"+e.port}});e.localAddress&&(s.localAddress=e.localAddress),s.proxyAuth&&(s.headers=s.headers||{},s.headers["Proxy-Authorization"]="Basic "+new Buffer(s.proxyAuth).toString("base64")),Bt("making CONNECT request");var a=n.request(s);a.useChunkedEncodingByDefault=!1,a.once("response",o),a.once("upgrade",l),a.once("connect",c),a.once("error",u),a.end();function o(d){d.upgrade=!0}function l(d,h,f){process.nextTick(function(){c(d,h,f)})}function c(d,h,f){if(a.removeAllListeners(),h.removeAllListeners(),d.statusCode!==200){Bt("tunneling socket could not be established, statusCode=%d",d.statusCode),h.destroy();var g=new Error("tunneling socket could not be established, statusCode="+d.statusCode);g.code="ECONNRESET",e.request.emit("error",g),n.removeSocket(i);return}if(f.length>0){Bt("got illegal response body from proxy"),h.destroy();var g=new Error("got illegal response body from proxy");g.code="ECONNRESET",e.request.emit("error",g),n.removeSocket(i);return}return Bt("tunneling connection has established"),n.sockets[n.sockets.indexOf(i)]=h,t(h)}function u(d){a.removeAllListeners(),Bt(`tunneling socket could not be established, cause=%s
`,d.message,d.stack);var h=new Error("tunneling socket could not be established, cause="+d.message);h.code="ECONNRESET",e.request.emit("error",h),n.removeSocket(i)}};At.prototype.removeSocket=function(e){var t=this.sockets.indexOf(e);if(t!==-1){this.sockets.splice(t,1);var n=this.requests.shift();n&&this.createSocket(n,function(i){n.request.onSocket(i)})}};function xu(r,e){var t=this;At.prototype.createSocket.call(t,r,function(n){var i=r.request.getHeader("host"),s=wa({},t.options,{socket:n,servername:i?i.replace(/:.*$/,""):r.host}),a=ov.connect(0,s);t.sockets[t.sockets.indexOf(n)]=a,e(a)})}function Du(r,e,t){return typeof r=="string"?{host:r,port:e,localAddress:t}:r}function wa(r){for(var e=1,t=arguments.length;e<t;++e){var n=arguments[e];if(typeof n=="object")for(var i=Object.keys(n),s=0,a=i.length;s<a;++s){var o=i[s];n[o]!==void 0&&(r[o]=n[o])}}return r}var Bt;process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?Bt=function(){var r=Array.prototype.slice.call(arguments);typeof r[0]=="string"?r[0]="TUNNEL: "+r[0]:r.unshift("TUNNEL:"),console.error.apply(console,r)}:Bt=function(){};Ir.debug=Bt});var Fu=p((mR,qu)=>{qu.exports=Lu()});var Na=p(H=>{"use strict";var pv=H&&H.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),gv=H&&H.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Di=H&&H.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&pv(e,r,t);return gv(e,r),e},ne=H&&H.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};Object.defineProperty(H,"__esModule",{value:!0});H.HttpClient=H.isHttps=H.HttpClientResponse=H.HttpClientError=H.getProxyUrl=H.MediaTypes=H.Headers=H.HttpCodes=void 0;var Pi=Di(require("http")),Oa=Di(require("https")),Bu=Di(Iu()),Ii=Di(Fu()),Ke;(function(r){r[r.OK=200]="OK",r[r.MultipleChoices=300]="MultipleChoices",r[r.MovedPermanently=301]="MovedPermanently",r[r.ResourceMoved=302]="ResourceMoved",r[r.SeeOther=303]="SeeOther",r[r.NotModified=304]="NotModified",r[r.UseProxy=305]="UseProxy",r[r.SwitchProxy=306]="SwitchProxy",r[r.TemporaryRedirect=307]="TemporaryRedirect",r[r.PermanentRedirect=308]="PermanentRedirect",r[r.BadRequest=400]="BadRequest",r[r.Unauthorized=401]="Unauthorized",r[r.PaymentRequired=402]="PaymentRequired",r[r.Forbidden=403]="Forbidden",r[r.NotFound=404]="NotFound",r[r.MethodNotAllowed=405]="MethodNotAllowed",r[r.NotAcceptable=406]="NotAcceptable",r[r.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",r[r.RequestTimeout=408]="RequestTimeout",r[r.Conflict=409]="Conflict",r[r.Gone=410]="Gone",r[r.TooManyRequests=429]="TooManyRequests",r[r.InternalServerError=500]="InternalServerError",r[r.NotImplemented=501]="NotImplemented",r[r.BadGateway=502]="BadGateway",r[r.ServiceUnavailable=503]="ServiceUnavailable",r[r.GatewayTimeout=504]="GatewayTimeout"})(Ke=H.HttpCodes||(H.HttpCodes={}));var pe;(function(r){r.Accept="accept",r.ContentType="content-type"})(pe=H.Headers||(H.Headers={}));var Ut;(function(r){r.ApplicationJson="application/json"})(Ut=H.MediaTypes||(H.MediaTypes={}));function mv(r){let e=Bu.getProxyUrl(new URL(r));return e?e.href:""}H.getProxyUrl=mv;var vv=[Ke.MovedPermanently,Ke.ResourceMoved,Ke.SeeOther,Ke.TemporaryRedirect,Ke.PermanentRedirect],yv=[Ke.BadGateway,Ke.ServiceUnavailable,Ke.GatewayTimeout],_v=["OPTIONS","GET","DELETE","HEAD"],Sv=10,Ev=5,Mr=class extends Error{constructor(e,t){super(e),this.name="HttpClientError",this.statusCode=t,Object.setPrototypeOf(this,Mr.prototype)}};H.HttpClientError=Mr;var xi=class{constructor(e){this.message=e}readBody(){return ne(this,void 0,void 0,function*(){return new Promise(e=>ne(this,void 0,void 0,function*(){let t=Buffer.alloc(0);this.message.on("data",n=>{t=Buffer.concat([t,n])}),this.message.on("end",()=>{e(t.toString())})}))})}};H.HttpClientResponse=xi;function bv(r){return new URL(r).protocol==="https:"}H.isHttps=bv;var Aa=class{constructor(e,t,n){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=e,this.handlers=t||[],this.requestOptions=n,n&&(n.ignoreSslError!=null&&(this._ignoreSslError=n.ignoreSslError),this._socketTimeout=n.socketTimeout,n.allowRedirects!=null&&(this._allowRedirects=n.allowRedirects),n.allowRedirectDowngrade!=null&&(this._allowRedirectDowngrade=n.allowRedirectDowngrade),n.maxRedirects!=null&&(this._maxRedirects=Math.max(n.maxRedirects,0)),n.keepAlive!=null&&(this._keepAlive=n.keepAlive),n.allowRetries!=null&&(this._allowRetries=n.allowRetries),n.maxRetries!=null&&(this._maxRetries=n.maxRetries))}options(e,t){return ne(this,void 0,void 0,function*(){return this.request("OPTIONS",e,null,t||{})})}get(e,t){return ne(this,void 0,void 0,function*(){return this.request("GET",e,null,t||{})})}del(e,t){return ne(this,void 0,void 0,function*(){return this.request("DELETE",e,null,t||{})})}post(e,t,n){return ne(this,void 0,void 0,function*(){return this.request("POST",e,t,n||{})})}patch(e,t,n){return ne(this,void 0,void 0,function*(){return this.request("PATCH",e,t,n||{})})}put(e,t,n){return ne(this,void 0,void 0,function*(){return this.request("PUT",e,t,n||{})})}head(e,t){return ne(this,void 0,void 0,function*(){return this.request("HEAD",e,null,t||{})})}sendStream(e,t,n,i){return ne(this,void 0,void 0,function*(){return this.request(e,t,n,i)})}getJson(e,t={}){return ne(this,void 0,void 0,function*(){t[pe.Accept]=this._getExistingOrDefaultHeader(t,pe.Accept,Ut.ApplicationJson);let n=yield this.get(e,t);return this._processResponse(n,this.requestOptions)})}postJson(e,t,n={}){return ne(this,void 0,void 0,function*(){let i=JSON.stringify(t,null,2);n[pe.Accept]=this._getExistingOrDefaultHeader(n,pe.Accept,Ut.ApplicationJson),n[pe.ContentType]=this._getExistingOrDefaultHeader(n,pe.ContentType,Ut.ApplicationJson);let s=yield this.post(e,i,n);return this._processResponse(s,this.requestOptions)})}putJson(e,t,n={}){return ne(this,void 0,void 0,function*(){let i=JSON.stringify(t,null,2);n[pe.Accept]=this._getExistingOrDefaultHeader(n,pe.Accept,Ut.ApplicationJson),n[pe.ContentType]=this._getExistingOrDefaultHeader(n,pe.ContentType,Ut.ApplicationJson);let s=yield this.put(e,i,n);return this._processResponse(s,this.requestOptions)})}patchJson(e,t,n={}){return ne(this,void 0,void 0,function*(){let i=JSON.stringify(t,null,2);n[pe.Accept]=this._getExistingOrDefaultHeader(n,pe.Accept,Ut.ApplicationJson),n[pe.ContentType]=this._getExistingOrDefaultHeader(n,pe.ContentType,Ut.ApplicationJson);let s=yield this.patch(e,i,n);return this._processResponse(s,this.requestOptions)})}request(e,t,n,i){return ne(this,void 0,void 0,function*(){if(this._disposed)throw new Error("Client has already been disposed.");let s=new URL(t),a=this._prepareRequest(e,s,i),o=this._allowRetries&&_v.includes(e)?this._maxRetries+1:1,l=0,c;do{if(c=yield this.requestRaw(a,n),c&&c.message&&c.message.statusCode===Ke.Unauthorized){let d;for(let h of this.handlers)if(h.canHandleAuthentication(c)){d=h;break}return d?d.handleAuthentication(this,a,n):c}let u=this._maxRedirects;for(;c.message.statusCode&&vv.includes(c.message.statusCode)&&this._allowRedirects&&u>0;){let d=c.message.headers.location;if(!d)break;let h=new URL(d);if(s.protocol==="https:"&&s.protocol!==h.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(yield c.readBody(),h.hostname!==s.hostname)for(let f in i)f.toLowerCase()==="authorization"&&delete i[f];a=this._prepareRequest(e,h,i),c=yield this.requestRaw(a,n),u--}if(!c.message.statusCode||!yv.includes(c.message.statusCode))return c;l+=1,l<o&&(yield c.readBody(),yield this._performExponentialBackoff(l))}while(l<o);return c})}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(e,t){return ne(this,void 0,void 0,function*(){return new Promise((n,i)=>{function s(a,o){a?i(a):o?n(o):i(new Error("Unknown error"))}this.requestRawWithCallback(e,t,s)})})}requestRawWithCallback(e,t,n){typeof t=="string"&&(e.options.headers||(e.options.headers={}),e.options.headers["Content-Length"]=Buffer.byteLength(t,"utf8"));let i=!1;function s(l,c){i||(i=!0,n(l,c))}let a=e.httpModule.request(e.options,l=>{let c=new xi(l);s(void 0,c)}),o;a.on("socket",l=>{o=l}),a.setTimeout(this._socketTimeout||3*6e4,()=>{o&&o.end(),s(new Error(`Request timeout: ${e.options.path}`))}),a.on("error",function(l){s(l)}),t&&typeof t=="string"&&a.write(t,"utf8"),t&&typeof t!="string"?(t.on("close",function(){a.end()}),t.pipe(a)):a.end()}getAgent(e){let t=new URL(e);return this._getAgent(t)}_prepareRequest(e,t,n){let i={};i.parsedUrl=t;let s=i.parsedUrl.protocol==="https:";i.httpModule=s?Oa:Pi;let a=s?443:80;if(i.options={},i.options.host=i.parsedUrl.hostname,i.options.port=i.parsedUrl.port?parseInt(i.parsedUrl.port):a,i.options.path=(i.parsedUrl.pathname||"")+(i.parsedUrl.search||""),i.options.method=e,i.options.headers=this._mergeHeaders(n),this.userAgent!=null&&(i.options.headers["user-agent"]=this.userAgent),i.options.agent=this._getAgent(i.parsedUrl),this.handlers)for(let o of this.handlers)o.prepareRequest(i.options);return i}_mergeHeaders(e){return this.requestOptions&&this.requestOptions.headers?Object.assign({},Mi(this.requestOptions.headers),Mi(e||{})):Mi(e||{})}_getExistingOrDefaultHeader(e,t,n){let i;return this.requestOptions&&this.requestOptions.headers&&(i=Mi(this.requestOptions.headers)[t]),e[t]||i||n}_getAgent(e){let t,n=Bu.getProxyUrl(e),i=n&&n.hostname;if(this._keepAlive&&i&&(t=this._proxyAgent),this._keepAlive&&!i&&(t=this._agent),t)return t;let s=e.protocol==="https:",a=100;if(this.requestOptions&&(a=this.requestOptions.maxSockets||Pi.globalAgent.maxSockets),n&&n.hostname){let o={maxSockets:a,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(n.username||n.password)&&{proxyAuth:`${n.username}:${n.password}`}),{host:n.hostname,port:n.port})},l,c=n.protocol==="https:";s?l=c?Ii.httpsOverHttps:Ii.httpsOverHttp:l=c?Ii.httpOverHttps:Ii.httpOverHttp,t=l(o),this._proxyAgent=t}if(this._keepAlive&&!t){let o={keepAlive:this._keepAlive,maxSockets:a};t=s?new Oa.Agent(o):new Pi.Agent(o),this._agent=t}return t||(t=s?Oa.globalAgent:Pi.globalAgent),s&&this._ignoreSslError&&(t.options=Object.assign(t.options||{},{rejectUnauthorized:!1})),t}_performExponentialBackoff(e){return ne(this,void 0,void 0,function*(){e=Math.min(Sv,e);let t=Ev*Math.pow(2,e);return new Promise(n=>setTimeout(()=>n(),t))})}_processResponse(e,t){return ne(this,void 0,void 0,function*(){return new Promise((n,i)=>ne(this,void 0,void 0,function*(){let s=e.message.statusCode||0,a={statusCode:s,result:null,headers:{}};s===Ke.NotFound&&n(a);function o(u,d){if(typeof d=="string"){let h=new Date(d);if(!isNaN(h.valueOf()))return h}return d}let l,c;try{c=yield e.readBody(),c&&c.length>0&&(t&&t.deserializeDates?l=JSON.parse(c,o):l=JSON.parse(c),a.result=l),a.headers=e.message.headers}catch(u){}if(s>299){let u;l&&l.message?u=l.message:c&&c.length>0?u=c:u=`Failed request: (${s})`;let d=new Mr(u,s);d.result=a.result,i(d)}else n(a)}))})}};H.HttpClient=Aa;var Mi=r=>Object.keys(r).reduce((e,t)=>(e[t.toLowerCase()]=r[t],e),{})});var xa=p(ut=>{"use strict";var Ma=ut&&ut.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};Object.defineProperty(ut,"__esModule",{value:!0});ut.PersonalAccessTokenCredentialHandler=ut.BearerCredentialHandler=ut.BasicCredentialHandler=void 0;var ka=class{constructor(e,t){this.username=e,this.password=t}prepareRequest(e){if(!e.headers)throw Error("The request has no headers");e.headers.Authorization=`Basic ${Buffer.from(`${this.username}:${this.password}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return Ma(this,void 0,void 0,function*(){throw new Error("not implemented")})}};ut.BasicCredentialHandler=ka;var Pa=class{constructor(e){this.token=e}prepareRequest(e){if(!e.headers)throw Error("The request has no headers");e.headers.Authorization=`Bearer ${this.token}`}canHandleAuthentication(){return!1}handleAuthentication(){return Ma(this,void 0,void 0,function*(){throw new Error("not implemented")})}};ut.BearerCredentialHandler=Pa;var Ia=class{constructor(e){this.token=e}prepareRequest(e){if(!e.headers)throw Error("The request has no headers");e.headers.Authorization=`Basic ${Buffer.from(`PAT:${this.token}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return Ma(this,void 0,void 0,function*(){throw new Error("not implemented")})}};ut.PersonalAccessTokenCredentialHandler=Ia});var ju=p(xr=>{"use strict";var Uu=xr&&xr.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};Object.defineProperty(xr,"__esModule",{value:!0});xr.OidcClient=void 0;var Cv=Na(),Tv=xa(),zu=Da(),zt=class{static createHttpClient(e=!0,t=10){let n={allowRetries:e,maxRetries:t};return new Cv.HttpClient("actions/oidc-client",[new Tv.BearerCredentialHandler(zt.getRequestToken())],n)}static getRequestToken(){let e=process.env.ACTIONS_ID_TOKEN_REQUEST_TOKEN;if(!e)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable");return e}static getIDTokenUrl(){let e=process.env.ACTIONS_ID_TOKEN_REQUEST_URL;if(!e)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable");return e}static getCall(e){var t;return Uu(this,void 0,void 0,function*(){let s=(t=(yield zt.createHttpClient().getJson(e).catch(a=>{throw new Error(`Failed to get ID Token. 
 
        Error Code : ${a.statusCode}
 
        Error Message: ${a.result.message}`)})).result)===null||t===void 0?void 0:t.value;if(!s)throw new Error("Response json body do not have ID Token field");return s})}static getIDToken(e){return Uu(this,void 0,void 0,function*(){try{let t=zt.getIDTokenUrl();if(e){let i=encodeURIComponent(e);t=`${t}&audience=${i}`}zu.debug(`ID token url is ${t}`);let n=yield zt.getCall(t);return zu.setSecret(n),n}catch(t){throw new Error(`Error message: ${t.message}`)}})}};xr.OidcClient=zt});var Ba=p(_e=>{"use strict";var La=_e&&_e.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};Object.defineProperty(_e,"__esModule",{value:!0});_e.summary=_e.markdownSummary=_e.SUMMARY_DOCS_URL=_e.SUMMARY_ENV_VAR=void 0;var Rv=require("os"),qa=require("fs"),{access:wv,appendFile:Ov,writeFile:Av}=qa.promises;_e.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY";_e.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";var Fa=class{constructor(){this._buffer=""}filePath(){return La(this,void 0,void 0,function*(){if(this._filePath)return this._filePath;let e=process.env[_e.SUMMARY_ENV_VAR];if(!e)throw new Error(`Unable to find environment variable for $${_e.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`);try{yield wv(e,qa.constants.R_OK|qa.constants.W_OK)}catch(t){throw new Error(`Unable to access summary file: '${e}'. Check if the file has correct read/write permissions.`)}return this._filePath=e,this._filePath})}wrap(e,t,n={}){let i=Object.entries(n).map(([s,a])=>` ${s}="${a}"`).join("");return t?`<${e}${i}>${t}</${e}>`:`<${e}${i}>`}write(e){return La(this,void 0,void 0,function*(){let t=!!(e!=null&&e.overwrite),n=yield this.filePath();return yield(t?Av:Ov)(n,this._buffer,{encoding:"utf8"}),this.emptyBuffer()})}clear(){return La(this,void 0,void 0,function*(){return this.emptyBuffer().write({overwrite:!0})})}stringify(){return this._buffer}isEmptyBuffer(){return this._buffer.length===0}emptyBuffer(){return this._buffer="",this}addRaw(e,t=!1){return this._buffer+=e,t?this.addEOL():this}addEOL(){return this.addRaw(Rv.EOL)}addCodeBlock(e,t){let n=Object.assign({},t&&{lang:t}),i=this.wrap("pre",this.wrap("code",e),n);return this.addRaw(i).addEOL()}addList(e,t=!1){let n=t?"ol":"ul",i=e.map(a=>this.wrap("li",a)).join(""),s=this.wrap(n,i);return this.addRaw(s).addEOL()}addTable(e){let t=e.map(i=>{let s=i.map(a=>{if(typeof a=="string")return this.wrap("td",a);let{header:o,data:l,colspan:c,rowspan:u}=a,d=o?"th":"td",h=Object.assign(Object.assign({},c&&{colspan:c}),u&&{rowspan:u});return this.wrap(d,l,h)}).join("");return this.wrap("tr",s)}).join(""),n=this.wrap("table",t);return this.addRaw(n).addEOL()}addDetails(e,t){let n=this.wrap("details",this.wrap("summary",e)+t);return this.addRaw(n).addEOL()}addImage(e,t,n){let{width:i,height:s}=n||{},a=Object.assign(Object.assign({},i&&{width:i}),s&&{height:s}),o=this.wrap("img",null,Object.assign({src:e,alt:t},a));return this.addRaw(o).addEOL()}addHeading(e,t){let n=`h${t}`,i=["h1","h2","h3","h4","h5","h6"].includes(n)?n:"h1",s=this.wrap(i,e);return this.addRaw(s).addEOL()}addSeparator(){let e=this.wrap("hr",null);return this.addRaw(e).addEOL()}addBreak(){let e=this.wrap("br",null);return this.addRaw(e).addEOL()}addQuote(e,t){let n=Object.assign({},t&&{cite:t}),i=this.wrap("blockquote",e,n);return this.addRaw(i).addEOL()}addLink(e,t){let n=this.wrap("a",e,{href:t});return this.addRaw(n).addEOL()}},Hu=new Fa;_e.markdownSummary=Hu;_e.summary=Hu});var $u=p(Se=>{"use strict";var Nv=Se&&Se.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),kv=Se&&Se.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Pv=Se&&Se.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&Nv(e,r,t);return kv(e,r),e};Object.defineProperty(Se,"__esModule",{value:!0});Se.toPlatformPath=Se.toWin32Path=Se.toPosixPath=void 0;var Iv=Pv(require("path"));function Mv(r){return r.replace(/[\\]/g,"/")}Se.toPosixPath=Mv;function xv(r){return r.replace(/[/]/g,"\\")}Se.toWin32Path=xv;function Dv(r){return r.replace(/[/\\]/g,Iv.sep)}Se.toPlatformPath=Dv});var Da=p(C=>{"use strict";var Lv=C&&C.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),qv=C&&C.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Gu=C&&C.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&Lv(e,r,t);return qv(e,r),e},Wu=C&&C.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(r,e||[])).next())})};Object.defineProperty(C,"__esModule",{value:!0});C.getIDToken=C.getState=C.saveState=C.group=C.endGroup=C.startGroup=C.info=C.notice=C.warning=C.error=C.debug=C.isDebug=C.setFailed=C.setCommandEcho=C.setOutput=C.getBooleanInput=C.getMultilineInput=C.getInput=C.addPath=C.setSecret=C.exportVariable=C.ExitCode=void 0;var xe=lu(),pr=ku(),Dr=mi(),Vu=Gu(require("os")),Fv=Gu(require("path")),Bv=ju(),Ju;(function(r){r[r.Success=0]="Success",r[r.Failure=1]="Failure"})(Ju=C.ExitCode||(C.ExitCode={}));function Uv(r,e){let t=Dr.toCommandValue(e);if(process.env[r]=t,process.env.GITHUB_ENV||"")return pr.issueFileCommand("ENV",pr.prepareKeyValueMessage(r,e));xe.issueCommand("set-env",{name:r},t)}C.exportVariable=Uv;function zv(r){xe.issueCommand("add-mask",{},r)}C.setSecret=zv;function jv(r){process.env.GITHUB_PATH||""?pr.issueFileCommand("PATH",r):xe.issueCommand("add-path",{},r),process.env.PATH=`${r}${Fv.delimiter}${process.env.PATH}`}C.addPath=jv;function Ua(r,e){let t=process.env[`INPUT_${r.replace(/ /g,"_").toUpperCase()}`]||"";if(e&&e.required&&!t)throw new Error(`Input required and not supplied: ${r}`);return e&&e.trimWhitespace===!1?t:t.trim()}C.getInput=Ua;function Hv(r,e){let t=Ua(r,e).split(`
`).filter(n=>n!=="");return e&&e.trimWhitespace===!1?t:t.map(n=>n.trim())}C.getMultilineInput=Hv;function $v(r,e){let t=["true","True","TRUE"],n=["false","False","FALSE"],i=Ua(r,e);if(t.includes(i))return!0;if(n.includes(i))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${r}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}C.getBooleanInput=$v;function Gv(r,e){if(process.env.GITHUB_OUTPUT||"")return pr.issueFileCommand("OUTPUT",pr.prepareKeyValueMessage(r,e));process.stdout.write(Vu.EOL),xe.issueCommand("set-output",{name:r},Dr.toCommandValue(e))}C.setOutput=Gv;function Wv(r){xe.issue("echo",r?"on":"off")}C.setCommandEcho=Wv;function Vv(r){process.exitCode=Ju.Failure,Yu(r)}C.setFailed=Vv;function Jv(){return process.env.RUNNER_DEBUG==="1"}C.isDebug=Jv;function Yv(r){xe.issueCommand("debug",{},r)}C.debug=Yv;function Yu(r,e={}){xe.issueCommand("error",Dr.toCommandProperties(e),r instanceof Error?r.toString():r)}C.error=Yu;function Kv(r,e={}){xe.issueCommand("warning",Dr.toCommandProperties(e),r instanceof Error?r.toString():r)}C.warning=Kv;function Xv(r,e={}){xe.issueCommand("notice",Dr.toCommandProperties(e),r instanceof Error?r.toString():r)}C.notice=Xv;function Qv(r){process.stdout.write(r+Vu.EOL)}C.info=Qv;function Ku(r){xe.issue("group",r)}C.startGroup=Ku;function Xu(){xe.issue("endgroup")}C.endGroup=Xu;function Zv(r,e){return Wu(this,void 0,void 0,function*(){Ku(r);let t;try{t=yield e()}finally{Xu()}return t})}C.group=Zv;function ey(r,e){if(process.env.GITHUB_STATE||"")return pr.issueFileCommand("STATE",pr.prepareKeyValueMessage(r,e));xe.issueCommand("save-state",{name:r},Dr.toCommandValue(e))}C.saveState=ey;function ty(r){return process.env[`STATE_${r}`]||""}C.getState=ty;function ry(r){return Wu(this,void 0,void 0,function*(){return yield Bv.OidcClient.getIDToken(r)})}C.getIDToken=ry;var ny=Ba();Object.defineProperty(C,"summary",{enumerable:!0,get:function(){return ny.summary}});var iy=Ba();Object.defineProperty(C,"markdownSummary",{enumerable:!0,get:function(){return iy.markdownSummary}});var za=$u();Object.defineProperty(C,"toPosixPath",{enumerable:!0,get:function(){return za.toPosixPath}});Object.defineProperty(C,"toWin32Path",{enumerable:!0,get:function(){return za.toWin32Path}});Object.defineProperty(C,"toPlatformPath",{enumerable:!0,get:function(){return za.toPlatformPath}})});var Zu={};ru(Zu,{ActionsCache:()=>$a});function ja(r){return r?200<=r&&r<300:!1}var Ha,Qu,$a,ed=tu(()=>{Ha=ga(Na()),Qu=ga(xa());$a=class{constructor(e,t){this.baseUrl=e,this.token=t,this.httpClient=new Ha.HttpClient("bazel-github-actions-cache",[new Qu.BearerCredentialHandler(t)],{headers:{Accept:"application/json;api-version=6.0-preview.1"}})}putCache(e,t,n,i){return q(this,null,function*(){var f;let o={key:`${e}-${t}`,version:"b",cacheSize:n},l=yield this.httpClient.postJson(`${this.baseUrl}caches`,o),c=(f=l==null?void 0:l.result)==null?void 0:f.cacheId;if(!c)return i.resume(),!1;let u=yield this.httpClient.sendStream("PATCH",`${this.baseUrl}caches/${c}`,i,{"Content-Type":"application/octet-stream","Content-Range":`bytes 0-${n-1}/*`});if(!ja(u.message.statusCode))return i.resume(),!1;let d={size:n},h=yield this.httpClient.postJson(`${this.baseUrl}caches/${c}`,d);return!!ja(h.statusCode)})}getCache(e,t){return q(this,null,function*(){var c;let n=`${e}-${t}`,i="b",s=yield this.httpClient.getJson(`${this.baseUrl}cache?keys=${n}&version=${i}`),a=(c=s==null?void 0:s.result)==null?void 0:c.archiveLocation;if(!a)return null;let l=yield new Ha.HttpClient("bazel-github-actions-cache").get(a);return ja(l.message.statusCode)?l.message:(l.message.resume(),null)})}}});var rd={};ru(rd,{HttpServer:()=>Wa});var td,Ga,Wa,nd=tu(()=>{td=ga(require("http")),Ga=require("url"),Wa=class extends td.Server{constructor(t){super();this.n_get=0;this.n_get_hit=0;this.n_put=0;this.n_put_succ=0;this.n_put_bytes=0;this.actionsCache=t,this.on("request",this.onRequest)}getStats(){return{n_get:this.n_get,n_get_hit:this.n_get_hit,n_put:this.n_put,n_put_succ:this.n_put_succ,n_put_bytes:this.n_put_bytes}}get_close(t,n){this.close(),n.writeHead(200,{"Content-type":"application/json"}),n.end(JSON.stringify(this.getStats()))}get_cas(t,n){return q(this,null,function*(){var l,c,u,d,h;let i=(0,Ga.parse)((l=t.url)!=null?l:""),s=(u=(c=i.pathname)==null?void 0:c.startsWith("/cas/"))!=null?u:!1,a=(h=(d=i.pathname)==null?void 0:d.substring(s?5:4))!=null?h:"",o=s?"cas":"ac";if(t.method=="PUT"){this.n_put+=1;let f=Number(t.headers["content-length"]),g=!1;try{g=yield this.actionsCache.putCache(o,a,f,t)}catch(y){}g?(this.n_put_succ+=1,this.n_put_bytes+=f,n.writeHead(200)):n.writeHead(500),n.end()}else if(t.method=="GET"){this.n_get+=1;let f=null;try{f=yield this.actionsCache.getCache(o,a)}catch(g){}f?(this.n_get_hit+=1,n.writeHead(200,{"Content-Type":"application/octet-stream"}),f.pipe(n)):(n.writeHead(404),n.end())}})}onRequest(t,n){return q(this,null,function*(){var s,a,o,l;let i=(0,Ga.parse)((s=t.url)!=null?s:"");i.pathname=="/close"?this.get_close(t,n):(a=i.pathname)!=null&&a.startsWith("/_apis/artifactcache/")?(n.writeHead(404),n.end()):((o=i.pathname)==null?void 0:o.startsWith("/cas/"))||((l=i.pathname)==null?void 0:l.startsWith("/ac/"))?this.get_cas(t,n):(n.writeHead(404),n.end())})}}});var $=p(ge=>{"use strict";Object.defineProperty(ge,"__esModule",{value:!0});ge.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=ge.DEFAULT_MAX_SEND_MESSAGE_LENGTH=ge.Propagate=ge.LogVerbosity=ge.Status=void 0;var sy;(function(r){r[r.OK=0]="OK",r[r.CANCELLED=1]="CANCELLED",r[r.UNKNOWN=2]="UNKNOWN",r[r.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",r[r.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",r[r.NOT_FOUND=5]="NOT_FOUND",r[r.ALREADY_EXISTS=6]="ALREADY_EXISTS",r[r.PERMISSION_DENIED=7]="PERMISSION_DENIED",r[r.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",r[r.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",r[r.ABORTED=10]="ABORTED",r[r.OUT_OF_RANGE=11]="OUT_OF_RANGE",r[r.UNIMPLEMENTED=12]="UNIMPLEMENTED",r[r.INTERNAL=13]="INTERNAL",r[r.UNAVAILABLE=14]="UNAVAILABLE",r[r.DATA_LOSS=15]="DATA_LOSS",r[r.UNAUTHENTICATED=16]="UNAUTHENTICATED"})(sy=ge.Status||(ge.Status={}));var ay;(function(r){r[r.DEBUG=0]="DEBUG",r[r.INFO=1]="INFO",r[r.ERROR=2]="ERROR",r[r.NONE=3]="NONE"})(ay=ge.LogVerbosity||(ge.LogVerbosity={}));var oy;(function(r){r[r.DEADLINE=1]="DEADLINE",r[r.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",r[r.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",r[r.CANCELLATION=8]="CANCELLATION",r[r.DEFAULTS=65535]="DEFAULTS"})(oy=ge.Propagate||(ge.Propagate={}));ge.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;ge.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var ie=p(me=>{"use strict";var Va,Ja,Ya,Ka;Object.defineProperty(me,"__esModule",{value:!0});me.isTracerEnabled=me.trace=me.log=me.setLoggerVerbosity=me.setLogger=me.getLogger=void 0;var jt=$(),ly={error:(r,...e)=>{console.error("E "+r,...e)},info:(r,...e)=>{console.error("I "+r,...e)},debug:(r,...e)=>{console.error("D "+r,...e)}},gr=ly,Lr=jt.LogVerbosity.ERROR,cy=(Ja=(Va=process.env.GRPC_NODE_VERBOSITY)!==null&&Va!==void 0?Va:process.env.GRPC_VERBOSITY)!==null&&Ja!==void 0?Ja:"";switch(cy.toUpperCase()){case"DEBUG":Lr=jt.LogVerbosity.DEBUG;break;case"INFO":Lr=jt.LogVerbosity.INFO;break;case"ERROR":Lr=jt.LogVerbosity.ERROR;break;case"NONE":Lr=jt.LogVerbosity.NONE;break;default:}me.getLogger=()=>gr;me.setLogger=r=>{gr=r};me.setLoggerVerbosity=r=>{Lr=r};me.log=(r,...e)=>{let t;if(r>=Lr){switch(r){case jt.LogVerbosity.DEBUG:t=gr.debug;break;case jt.LogVerbosity.INFO:t=gr.info;break;case jt.LogVerbosity.ERROR:t=gr.error;break}t||(t=gr.error),t&&t.bind(gr)(...e)}};var uy=(Ka=(Ya=process.env.GRPC_NODE_TRACE)!==null&&Ya!==void 0?Ya:process.env.GRPC_TRACE)!==null&&Ka!==void 0?Ka:"",Xa=new Set,id=new Set;for(let r of uy.split(","))r.startsWith("-")?id.add(r.substring(1)):Xa.add(r);var dy=Xa.has("all");function hy(r,e,t){sd(e)&&me.log(r,new Date().toISOString()+" | "+e+" | "+t)}me.trace=hy;function sd(r){return!id.has(r)&&(dy||Xa.has(r))}me.isTracerEnabled=sd});var Xe=p(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});qi.Metadata=void 0;var fy=ie(),py=$(),gy=/^[0-9a-z_.-]+$/,my=/^[ -~]*$/;function vy(r){return gy.test(r)}function yy(r){return my.test(r)}function od(r){return r.endsWith("-bin")}function _y(r){return!r.startsWith("grpc-")}function Li(r){return r.toLowerCase()}function ad(r,e){if(!vy(r))throw new Error('Metadata key "'+r+'" contains illegal characters');if(e!=null)if(od(r)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!yy(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var qr=class{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){e=Li(e),ad(e,t),this.internalRepr.set(e,[t])}add(e,t){e=Li(e),ad(e,t);let n=this.internalRepr.get(e);n===void 0?this.internalRepr.set(e,[t]):n.push(t)}remove(e){e=Li(e),this.internalRepr.delete(e)}get(e){return e=Li(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,n]of this.internalRepr)if(n.length>0){let i=n[0];e[t]=Buffer.isBuffer(i)?Buffer.from(i):i}return e}clone(){let e=new qr(this.options),t=e.internalRepr;for(let[n,i]of this.internalRepr){let s=i.map(a=>Buffer.isBuffer(a)?Buffer.from(a):a);t.set(n,s)}return e}merge(e){for(let[t,n]of e.internalRepr){let i=(this.internalRepr.get(t)||[]).concat(n);this.internalRepr.set(t,i)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,n]of this.internalRepr)e[t]=n.map(Sy);return e}_getCoreRepresentation(){return this.internalRepr}toJSON(){let e={};for(let[t,n]of this.internalRepr)e[t]=n;return e}static fromHttp2Headers(e){let t=new qr;for(let n of Object.keys(e)){if(n.charAt(0)===":")continue;let i=e[n];try{od(n)?Array.isArray(i)?i.forEach(s=>{t.add(n,Buffer.from(s,"base64"))}):i!==void 0&&(_y(n)?i.split(",").forEach(s=>{t.add(n,Buffer.from(s.trim(),"base64"))}):t.add(n,Buffer.from(i,"base64"))):Array.isArray(i)?i.forEach(s=>{t.add(n,s)}):i!==void 0&&t.add(n,i)}catch(s){let a=`Failed to add metadata entry ${n}: ${i}. ${s.message}. For more information see https://github.com/grpc/grpc-node/issues/1173`;fy.log(py.LogVerbosity.ERROR,a)}}return t}};qi.Metadata=qr;var Sy=r=>Buffer.isBuffer(r)?r.toString("base64"):r});var Za=p(Fi=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});Fi.CallCredentials=void 0;var Qa=Xe();function Ey(r){return"getRequestHeaders"in r&&typeof r.getRequestHeaders=="function"}var Ht=class{static createFromMetadataGenerator(e){return new In(e)}static createFromGoogleCredential(e){return Ht.createFromMetadataGenerator((t,n)=>{let i;Ey(e)?i=e.getRequestHeaders(t.service_url):i=new Promise((s,a)=>{e.getRequestMetadata(t.service_url,(o,l)=>{if(o){a(o);return}s(l)})}),i.then(s=>{let a=new Qa.Metadata;for(let o of Object.keys(s))a.add(o,s[o]);n(null,a)},s=>{n(s)})})}static createEmpty(){return new Mn}};Fi.CallCredentials=Ht;var Fr=class extends Ht{constructor(e){super(),this.creds=e}generateMetadata(e){return q(this,null,function*(){let t=new Qa.Metadata,n=yield Promise.all(this.creds.map(i=>i.generateMetadata(e)));for(let i of n)t.merge(i);return t})}compose(e){return new Fr(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof Fr?this.creds.every((t,n)=>t._equals(e.creds[n])):!1}},In=class extends Ht{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,n)=>{this.metadataGenerator(e,(i,s)=>{s!==void 0?t(s):n(i)})})}compose(e){return new Fr([this,e])}_equals(e){return this===e?!0:e instanceof In?this.metadataGenerator===e.metadataGenerator:!1}},Mn=class extends Ht{generateMetadata(e){return Promise.resolve(new Qa.Metadata)}compose(e){return e}_equals(e){return e instanceof Mn}}});var to=p(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});Bi.StreamDecoder=void 0;var dt;(function(r){r[r.NO_DATA=0]="NO_DATA",r[r.READING_SIZE=1]="READING_SIZE",r[r.READING_MESSAGE=2]="READING_MESSAGE"})(dt||(dt={}));var eo=class{constructor(){this.readState=dt.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t=0,n,i=[];for(;t<e.length;)switch(this.readState){case dt.NO_DATA:this.readCompressFlag=e.slice(t,t+1),t+=1,this.readState=dt.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case dt.READING_SIZE:if(n=Math.min(e.length-t,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+n),this.readSizeRemaining-=n,t+=n,this.readSizeRemaining===0)if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=dt.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=dt.NO_DATA,i.push(s)}break;case dt.READING_MESSAGE:if(n=Math.min(e.length-t,this.readMessageRemaining),this.readPartialMessage.push(e.slice(t,t+n)),this.readMessageRemaining-=n,t+=n,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),a=Buffer.concat(s,this.readMessageSize+5);this.readState=dt.NO_DATA,i.push(a)}break;default:throw new Error("Unexpected read state")}return i}};Bi.StreamDecoder=eo});var io=p($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.Http2CallStream=$t.InterceptingListenerImpl=$t.isInterceptingListener=void 0;var ft=require("http2"),by=require("os"),D=$(),ht=Xe(),Cy=to(),Ty=ie(),Ry=$(),wy="call_stream",{HTTP2_HEADER_STATUS:AR,HTTP2_HEADER_CONTENT_TYPE:NR,NGHTTP2_CANCEL:Oy}=ft.constants;function Ay(r){for(let[e,t]of Object.entries(by.constants.errno))if(t===r)return e;return"Unknown system error "+r}function Ny(r){let e=1/0;for(let t of r){let n=t instanceof Date?t.getTime():t;n<e&&(e=n)}return e}function ky(r){return r.onReceiveMetadata!==void 0&&r.onReceiveMetadata.length===1}$t.isInterceptingListener=ky;var ro=class{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,t=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(t),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,t=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=t,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(t),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,t=>{this.processingMetadata||this.processingMessage?this.pendingStatus=t:this.nextListener.onReceiveStatus(t)})}};$t.InterceptingListenerImpl=ro;var no=class{constructor(e,t,n,i,s,a){this.methodName=e,this.channel=t,this.options=n,this.channelCallCredentials=s,this.callNumber=a,this.http2Stream=null,this.pendingRead=!1,this.isWriteFilterPending=!1,this.pendingWrite=null,this.pendingWriteCallback=null,this.writesClosed=!1,this.decoder=new Cy.StreamDecoder,this.isReadFilterPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.unfilteredReadMessages=[],this.mappedStatusCode=D.Status.UNKNOWN,this.finalStatus=null,this.subchannel=null,this.listener=null,this.internalError=null,this.configDeadline=1/0,this.statusWatchers=[],this.streamEndWatchers=[],this.callStatsTracker=null,this.filterStack=i.createFilter(this),this.credentials=s,this.disconnectListener=()=>{this.endCall({code:D.Status.UNAVAILABLE,details:"Connection dropped",metadata:new ht.Metadata})},this.options.parentCall&&this.options.flags&D.Propagate.CANCELLATION&&this.options.parentCall.on("cancelled",()=>{this.cancelWithStatus(D.Status.CANCELLED,"Cancelled by parent call")})}outputStatus(){var e;if(this.listener&&!this.statusOutput){this.statusOutput=!0;let t=this.filterStack.receiveTrailers(this.finalStatus);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(n=>n(t)),process.nextTick(()=>{var n;(n=this.listener)===null||n===void 0||n.onReceiveStatus(t)}),(e=this.http2Stream)===null||e===void 0||e.resume(),this.subchannel&&(this.subchannel.callUnref(),this.subchannel.removeDisconnectListener(this.disconnectListener))}}trace(e){Ty.trace(Ry.LogVerbosity.DEBUG,wy,"["+this.callNumber+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===D.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==D.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&this.unfilteredReadMessages.length===0&&!this.isReadFilterPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,process.nextTick(()=>{var t;this.statusOutput||((t=this.listener)===null||t===void 0||t.onReceiveMessage(e),this.maybeOutputStatus())})}handleFilterError(e){this.cancelWithStatus(D.Status.INTERNAL,e.message)}handleFilteredRead(e){if(this.finalStatus!==null&&this.finalStatus.code!==D.Status.OK){this.maybeOutputStatus();return}if(this.isReadFilterPending=!1,this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e)),this.unfilteredReadMessages.length>0){let t=this.unfilteredReadMessages.shift();this.filterReceivedMessage(t)}}filterReceivedMessage(e){if(this.finalStatus!==null&&this.finalStatus.code!==D.Status.OK){this.maybeOutputStatus();return}this.trace("filterReceivedMessage of length "+e.length),this.isReadFilterPending=!0,this.filterStack.receiveMessage(Promise.resolve(e)).then(this.handleFilteredRead.bind(this),this.handleFilterError.bind(this))}tryPush(e){this.isReadFilterPending?(this.trace("unfilteredReadMessages.push message of length "+(e&&e.length)),this.unfilteredReadMessages.push(e)):this.filterReceivedMessage(e)}handleTrailers(e){this.streamEndWatchers.forEach(l=>l(!0));let t="";for(let l of Object.keys(e))t+="		"+l+": "+e[l]+`
`;this.trace(`Received server trailers:
`+t);let n;try{n=ht.Metadata.fromHttp2Headers(e)}catch(l){n=new ht.Metadata}let i=n.getMap(),s=this.mappedStatusCode;if(s===D.Status.UNKNOWN&&typeof i["grpc-status"]=="string"){let l=Number(i["grpc-status"]);l in D.Status&&(s=l,this.trace("received status code "+l+" from server")),n.remove("grpc-status")}let a="";if(typeof i["grpc-message"]=="string"){try{a=decodeURI(i["grpc-message"])}catch(l){a=i["grpc-message"]}n.remove("grpc-message"),this.trace('received status details string "'+a+'" from server')}let o={code:s,details:a,metadata:n};this.endCall(o)}writeMessageToStream(e,t){var n;(n=this.callStatsTracker)===null||n===void 0||n.addMessageSent(),this.http2Stream.write(e,t)}attachHttp2Stream(e,t,n,i){if(this.filterStack.push(n),this.finalStatus!==null)e.close(Oy);else{if(this.trace("attachHttp2Stream from subchannel "+t.getAddress()),this.http2Stream=e,this.subchannel=t,this.callStatsTracker=i,t.addDisconnectListener(this.disconnectListener),t.callRef(),e.on("response",(s,a)=>{var o;let l="";for(let c of Object.keys(s))l+="		"+c+": "+s[c]+`
`;switch(this.trace(`Received server headers:
`+l),s[":status"]){case 400:this.mappedStatusCode=D.Status.INTERNAL;break;case 401:this.mappedStatusCode=D.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=D.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=D.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=D.Status.UNAVAILABLE;break;default:this.mappedStatusCode=D.Status.UNKNOWN}if(a&ft.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(s);else{let c;try{c=ht.Metadata.fromHttp2Headers(s)}catch(u){this.endCall({code:D.Status.UNKNOWN,details:u.message,metadata:new ht.Metadata});return}try{let u=this.filterStack.receiveMetadata(c);(o=this.listener)===null||o===void 0||o.onReceiveMetadata(u)}catch(u){this.endCall({code:D.Status.UNKNOWN,details:u.message,metadata:new ht.Metadata})}}}),e.on("trailers",s=>{this.handleTrailers(s)}),e.on("data",s=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+s.length);let a=this.decoder.write(s);for(let o of a)this.trace("parsed message of length "+o.length),this.callStatsTracker.addMessageReceived(),this.tryPush(o)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var s;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((s=this.finalStatus)===null||s===void 0?void 0:s.code)===D.Status.OK)return;let a,o="";switch(e.rstCode){case ft.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;a=D.Status.INTERNAL,o=`Received RST_STREAM with code ${e.rstCode}`;break;case ft.constants.NGHTTP2_REFUSED_STREAM:a=D.Status.UNAVAILABLE,o="Stream refused by server";break;case ft.constants.NGHTTP2_CANCEL:a=D.Status.CANCELLED,o="Call cancelled";break;case ft.constants.NGHTTP2_ENHANCE_YOUR_CALM:a=D.Status.RESOURCE_EXHAUSTED,o="Bandwidth exhausted or memory limit exceeded";break;case ft.constants.NGHTTP2_INADEQUATE_SECURITY:a=D.Status.PERMISSION_DENIED,o="Protocol not secure enough";break;case ft.constants.NGHTTP2_INTERNAL_ERROR:a=D.Status.INTERNAL,this.internalError===null?o=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(a=D.Status.UNAVAILABLE,o=this.internalError.message):o=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:a=D.Status.INTERNAL,o=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:a,details:o,metadata:new ht.Metadata})})}),e.on("error",s=>{s.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+s.message+" code="+s.code+" errno="+Ay(s.errno)+" syscall="+s.syscall),this.internalError=s),this.streamEndWatchers.forEach(a=>a(!1))}),this.pendingWrite){if(!this.pendingWriteCallback)throw new Error("Invalid state in write handling code");this.trace("sending data chunk of length "+this.pendingWrite.length+" (deferred)");try{this.writeMessageToStream(this.pendingWrite,this.pendingWriteCallback)}catch(s){this.endCall({code:D.Status.UNAVAILABLE,details:`Write failed with error ${s.message}`,metadata:new ht.Metadata})}}this.maybeCloseWrites()}}start(e,t){this.trace("Sending metadata"),this.listener=t,this.channel._startCallStream(this,e),this.maybeOutputStatus()}destroyHttp2Stream(){var e;if(this.http2Stream!==null&&!this.http2Stream.destroyed){let t;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===D.Status.OK?t=ft.constants.NGHTTP2_NO_ERROR:t=ft.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new ht.Metadata})}getDeadline(){let e=[this.options.deadline];return this.options.parentCall&&this.options.flags&D.Propagate.DEADLINE&&e.push(this.options.parentCall.getDeadline()),this.configDeadline&&e.push(this.configDeadline),Ny(e)}getCredentials(){return this.credentials}setCredentials(e){this.credentials=this.channelCallCredentials.compose(e)}getStatus(){return this.finalStatus}getPeer(){var e,t;return(t=(e=this.subchannel)===null||e===void 0?void 0:e.getAddress())!==null&&t!==void 0?t:this.channel.getTarget()}getMethod(){return this.methodName}getHost(){return this.options.host}setConfigDeadline(e){this.configDeadline=e}addStatusWatcher(e){this.statusWatchers.push(e)}addStreamEndWatcher(e){this.streamEndWatchers.push(e)}addFilters(e){this.filterStack.push(e)}getCallNumber(){return this.callNumber}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==D.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.http2Stream===null)this.pendingRead=!0;else{if(this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}}maybeCloseWrites(){this.writesClosed&&!this.isWriteFilterPending&&this.http2Stream!==null&&(this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end())}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let n={message:t,flags:e.flags},i=s=>{var a,o;let l=D.Status.UNAVAILABLE;((a=s)===null||a===void 0?void 0:a.code)==="ERR_STREAM_WRITE_AFTER_END"&&(l=D.Status.INTERNAL),s&&this.cancelWithStatus(l,`Write error: ${s.message}`),(o=e.callback)===null||o===void 0||o.call(e)};this.isWriteFilterPending=!0,this.filterStack.sendMessage(Promise.resolve(n)).then(s=>{if(this.isWriteFilterPending=!1,this.http2Stream===null)this.trace("deferring writing data chunk of length "+s.message.length),this.pendingWrite=s.message,this.pendingWriteCallback=i;else{this.trace("sending data chunk of length "+s.message.length);try{this.writeMessageToStream(s.message,i)}catch(a){this.endCall({code:D.Status.UNAVAILABLE,details:`Write failed with error ${a.message}`,metadata:new ht.Metadata})}this.maybeCloseWrites()}},this.handleFilterError.bind(this))}halfClose(){this.trace("end() called"),this.writesClosed=!0,this.maybeCloseWrites()}};$t.Http2CallStream=no});var ao=p(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.getDefaultRootsData=Br.CIPHER_SUITES=void 0;var Py=require("fs");Br.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var ld=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,so=null;function Iy(){return ld?(so===null&&(so=Py.readFileSync(ld)),so):null}Br.getDefaultRootsData=Iy});var lo=p(Ui=>{"use strict";Object.defineProperty(Ui,"__esModule",{value:!0});Ui.ChannelCredentials=void 0;var My=require("tls"),xy=Za(),cd=ao();function oo(r,e){if(r&&!(r instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var Ur=class{constructor(e){this.callCredentials=e||xy.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,n,i){var s;if(oo(e,"Root certificate"),oo(t,"Private key"),oo(n,"Certificate chain"),t&&!n)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&n)throw new Error("Certificate chain must be given with accompanying private key");let a=My.createSecureContext({ca:(s=e!=null?e:cd.getDefaultRootsData())!==null&&s!==void 0?s:void 0,key:t!=null?t:void 0,cert:n!=null?n:void 0,ciphers:cd.CIPHER_SUITES});return new zr(a,i!=null?i:{})}static createFromSecureContext(e,t){return new zr(e,t!=null?t:{})}static createInsecure(){return new xn}};Ui.ChannelCredentials=Ur;var xn=class extends Ur{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof xn}},zr=class extends Ur{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},t!=null&&t.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){let t=this.callCredentials.compose(e);return new jr(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof zr?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},jr=class extends Ur{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new jr(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof jr?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var Wt=p(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.validateLoadBalancingConfig=de.getFirstUsableConfig=de.isLoadBalancerNameRegistered=de.createLoadBalancer=de.registerDefaultLoadBalancerType=de.registerLoadBalancerType=de.createChildChannelControlHelper=void 0;function Dy(r,e){var t,n,i,s,a,o,l,c,u,d;return{createSubchannel:(n=(t=e.createSubchannel)===null||t===void 0?void 0:t.bind(e))!==null&&n!==void 0?n:r.createSubchannel.bind(r),updateState:(s=(i=e.updateState)===null||i===void 0?void 0:i.bind(e))!==null&&s!==void 0?s:r.updateState.bind(r),requestReresolution:(o=(a=e.requestReresolution)===null||a===void 0?void 0:a.bind(e))!==null&&o!==void 0?o:r.requestReresolution.bind(r),addChannelzChild:(c=(l=e.addChannelzChild)===null||l===void 0?void 0:l.bind(e))!==null&&c!==void 0?c:r.addChannelzChild.bind(r),removeChannelzChild:(d=(u=e.removeChannelzChild)===null||u===void 0?void 0:u.bind(e))!==null&&d!==void 0?d:r.removeChannelzChild.bind(r)}}de.createChildChannelControlHelper=Dy;var Gt={},co=null;function Ly(r,e,t){Gt[r]={LoadBalancer:e,LoadBalancingConfig:t}}de.registerLoadBalancerType=Ly;function qy(r){co=r}de.registerDefaultLoadBalancerType=qy;function Fy(r,e){let t=r.getLoadBalancerName();return t in Gt?new Gt[t].LoadBalancer(e):null}de.createLoadBalancer=Fy;function By(r){return r in Gt}de.isLoadBalancerNameRegistered=By;function Uy(r,e=!1){for(let t of r)if(t.getLoadBalancerName()in Gt)return t;return e&&co?new Gt[co].LoadBalancingConfig:null}de.getFirstUsableConfig=Uy;function zy(r){if(!(r!==null&&typeof r=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(r);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let t=e[0];if(t in Gt)return Gt[t].LoadBalancingConfig.createFromJson(r[t]);throw new Error(`Unrecognized load balancing config name ${t}`)}de.validateLoadBalancingConfig=zy});var uo=p(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.extractAndSelectServiceConfig=Hr.validateServiceConfig=void 0;var jy=require("os"),Hy=Wt(),$y=/^\d+(\.\d{1,9})?s$/,Gy="node";function Wy(r){if(!("service"in r)||typeof r.service!="string")throw new Error("Invalid method config name: invalid service");let e={service:r.service};if("method"in r)if(typeof r.method=="string")e.method=r.method;else throw new Error("Invalid method config name: invalid method");return e}function Vy(r){var e;let t={name:[]};if(!("name"in r)||!Array.isArray(r.name))throw new Error("Invalid method config: invalid name array");for(let n of r.name)t.name.push(Wy(n));if("waitForReady"in r){if(typeof r.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");t.waitForReady=r.waitForReady}if("timeout"in r)if(typeof r.timeout=="object"){if(!("seconds"in r.timeout)||typeof r.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in r.timeout)||typeof r.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");t.timeout=r.timeout}else if(typeof r.timeout=="string"&&$y.test(r.timeout)){let n=r.timeout.substring(0,r.timeout.length-1).split(".");t.timeout={seconds:n[0]|0,nanos:((e=n[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in r){if(typeof r.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxRequestBytes=r.maxRequestBytes}if("maxResponseBytes"in r){if(typeof r.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxResponseBytes=r.maxResponseBytes}return t}function ud(r){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in r)if(typeof r.loadBalancingPolicy=="string")e.loadBalancingPolicy=r.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in r)if(Array.isArray(r.loadBalancingConfig))for(let n of r.loadBalancingConfig)e.loadBalancingConfig.push(Hy.validateLoadBalancingConfig(n));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in r&&Array.isArray(r.methodConfig))for(let n of r.methodConfig)e.methodConfig.push(Vy(n));let t=[];for(let n of e.methodConfig)for(let i of n.name){for(let s of t)if(i.service===s.service&&i.method===s.method)throw new Error(`Invalid service config: duplicate name ${i.service}/${i.method}`);t.push(i)}return e}Hr.validateServiceConfig=ud;function Jy(r){if(!("serviceConfig"in r))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:ud(r.serviceConfig)};if("clientLanguage"in r)if(Array.isArray(r.clientLanguage)){e.clientLanguage=[];for(let n of r.clientLanguage)if(typeof n=="string")e.clientLanguage.push(n);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in r)if(Array.isArray(r.clientHostname)){e.clientHostname=[];for(let n of r.clientHostname)if(typeof n=="string")e.clientHostname.push(n);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in r)if(typeof r.percentage=="number"&&0<=r.percentage&&r.percentage<=100)e.percentage=r.percentage;else throw new Error("Invalid service config choice: invalid percentage");let t=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let n in r)if(!t.includes(n))throw new Error(`Invalid service config choice: unexpected field ${n}`);return e}function Yy(r,e){if(!Array.isArray(r))throw new Error("Invalid service config list");for(let t of r){let n=Jy(t);if(!(typeof n.percentage=="number"&&e>n.percentage)){if(Array.isArray(n.clientHostname)){let i=!1;for(let s of n.clientHostname)s===jy.hostname()&&(i=!0);if(!i)continue}if(Array.isArray(n.clientLanguage)){let i=!1;for(let s of n.clientLanguage)s===Gy&&(i=!0);if(!i)continue}return n.serviceConfig}}throw new Error("No matching service config found")}function Ky(r,e){for(let t of r)if(t.length>0&&t[0].startsWith("grpc_config=")){let n=t.join("").substring(12),i=JSON.parse(n);return Yy(i,e)}return null}Hr.extractAndSelectServiceConfig=Ky});var Qe=p(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.ConnectivityState=void 0;var Xy;(function(r){r[r.IDLE=0]="IDLE",r[r.CONNECTING=1]="CONNECTING",r[r.READY=2]="READY",r[r.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",r[r.SHUTDOWN=4]="SHUTDOWN"})(Xy=Dn.ConnectivityState||(Dn.ConnectivityState={}))});var De=p(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.uriToString=Vt.splitHostPort=Vt.parseUri=void 0;var Qy=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function Zy(r){let e=Qy.exec(r);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}Vt.parseUri=Zy;var dd=/^\d+$/;function e_(r){if(r.startsWith("[")){let e=r.indexOf("]");if(e===-1)return null;let t=r.substring(1,e);if(t.indexOf(":")===-1)return null;if(r.length>e+1)if(r[e+1]===":"){let n=r.substring(e+2);return dd.test(n)?{host:t,port:+n}:null}else return null;else return{host:t}}else{let e=r.split(":");return e.length===2?dd.test(e[1])?{host:e[0],port:+e[1]}:null:{host:r}}}Vt.splitHostPort=e_;function t_(r){let e="";return r.scheme!==void 0&&(e+=r.scheme+":"),r.authority!==void 0&&(e+="//"+r.authority+"/"),e+=r.path,e}Vt.uriToString=t_});var pt=p(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.mapUriDefaultScheme=Le.getDefaultAuthority=Le.createResolver=Le.registerDefaultScheme=Le.registerResolver=void 0;var fo=De(),$r={},ho=null;function r_(r,e){$r[r]=e}Le.registerResolver=r_;function n_(r){ho=r}Le.registerDefaultScheme=n_;function i_(r,e,t){if(r.scheme!==void 0&&r.scheme in $r)return new $r[r.scheme](r,e,t);throw new Error(`No resolver could be created for target ${fo.uriToString(r)}`)}Le.createResolver=i_;function s_(r){if(r.scheme!==void 0&&r.scheme in $r)return $r[r.scheme].getDefaultAuthority(r);throw new Error(`Invalid target ${fo.uriToString(r)}`)}Le.getDefaultAuthority=s_;function a_(r){return r.scheme===void 0||!(r.scheme in $r)?ho!==null?{scheme:ho,authority:void 0,path:fo.uriToString(r)}:null:r}Le.mapUriDefaultScheme=a_});var mr=p(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.QueuePicker=Nt.UnavailablePicker=Nt.PickResultType=void 0;var o_=Xe(),l_=$(),mo;(function(r){r[r.COMPLETE=0]="COMPLETE",r[r.QUEUE=1]="QUEUE",r[r.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",r[r.DROP=3]="DROP"})(mo=Nt.PickResultType||(Nt.PickResultType={}));var po=class{constructor(e){e!==void 0?this.status=e:this.status={code:l_.Status.UNAVAILABLE,details:"No connection established",metadata:new o_.Metadata}}pick(e){return{pickResultType:mo.TRANSIENT_FAILURE,subchannel:null,status:this.status,extraFilterFactories:[],onCallStarted:null}}};Nt.UnavailablePicker=po;var go=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:mo.QUEUE,subchannel:null,status:null,extraFilterFactories:[],onCallStarted:null}}};Nt.QueuePicker=go});var Ln=p(zi=>{"use strict";Object.defineProperty(zi,"__esModule",{value:!0});zi.BackoffTimeout=void 0;var c_=1e3,u_=1.6,d_=12e4,h_=.2;function f_(r,e){return Math.random()*(e-r)+r}var vo=class{constructor(e,t){this.callback=e,this.initialDelay=c_,this.multiplier=u_,this.maxDelay=d_,this.jitter=h_,this.running=!1,this.hasRef=!0,this.startTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,n;clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(n=(t=this.timerId).unref)===null||n===void 0||n.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+f_(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,(t=(e=this.timerId).ref)===null||t===void 0||t.call(e)}unref(){var e,t;this.hasRef=!1,(t=(e=this.timerId).unref)===null||t===void 0||t.call(e)}};zi.BackoffTimeout=vo});var Hi=p(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});ji.ChildLoadBalancerHandler=void 0;var p_=Wt(),g_=Qe(),m_="child_load_balancer_helper",yo=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.ChildPolicyHelper=class{constructor(t){this.parent=t,this.child=null}createSubchannel(t,n){return this.parent.channelControlHelper.createSubchannel(t,n)}updateState(t,n){var i;if(this.calledByPendingChild()){if(t===g_.ConnectivityState.CONNECTING)return;(i=this.parent.currentChild)===null||i===void 0||i.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(t,n)}requestReresolution(){var t;let n=(t=this.parent.pendingChild)!==null&&t!==void 0?t:this.parent.currentChild;this.child===n&&this.parent.channelControlHelper.requestReresolution()}setChild(t){this.child=t}addChannelzChild(t){this.parent.channelControlHelper.addChannelzChild(t)}removeChannelzChild(t){this.parent.channelControlHelper.removeChannelzChild(t)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}updateAddressList(e,t,n){let i;if(this.currentChild===null||this.currentChild.getTypeName()!==t.getLoadBalancerName()){let s=new this.ChildPolicyHelper(this),a=p_.createLoadBalancer(t,s);s.setChild(a),this.currentChild===null?(this.currentChild=a,i=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=a,i=this.pendingChild)}else this.pendingChild===null?i=this.currentChild:i=this.pendingChild;i.updateAddressList(e,t,n)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return m_}};ji.ChildLoadBalancerHandler=yo});var hd=p($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});$i.ResolvingLoadBalancer=void 0;var v_=Wt(),y_=uo(),Oe=Qe(),__=pt(),Gr=mr(),S_=Ln(),_o=$(),E_=Xe(),b_=ie(),C_=$(),T_=De(),R_=Hi(),w_="resolving_load_balancer";function O_(r){b_.trace(C_.LogVerbosity.DEBUG,w_,r)}function A_(r){return function(t,n){var i,s;let a=t.split("/").filter(c=>c.length>0),o=(i=a[0])!==null&&i!==void 0?i:"",l=(s=a[1])!==null&&s!==void 0?s:"";if(r&&r.methodConfig){for(let c of r.methodConfig)for(let u of c.name)if(u.service===o&&(u.method===void 0||u.method===l))return{methodConfig:c,pickInformation:{},status:_o.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:_o.Status.OK,dynamicFilterFactories:[]}}}var So=class{constructor(e,t,n,i,s){this.target=e,this.channelControlHelper=t,this.channelOptions=n,this.onSuccessfulResolution=i,this.onFailedResolution=s,this.latestChildState=Oe.ConnectivityState.IDLE,this.latestChildPicker=new Gr.QueuePicker(this),this.currentState=Oe.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,n["grpc.service_config"]?this.defaultServiceConfig=y_.validateServiceConfig(JSON.parse(n["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(Oe.ConnectivityState.IDLE,new Gr.QueuePicker(this)),this.childLoadBalancer=new R_.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()},updateState:(o,l)=>{this.latestChildState=o,this.latestChildPicker=l,this.updateState(o,l)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=__.createResolver(e,{onSuccessfulResolution:(o,l,c,u,d)=>{var h;let f=null;l===null?c===null?(this.previousServiceConfig=null,f=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(c):f=this.previousServiceConfig:(f=l,this.previousServiceConfig=l);let g=(h=f==null?void 0:f.loadBalancingConfig)!==null&&h!==void 0?h:[],y=v_.getFirstUsableConfig(g,!0);if(y===null){this.handleResolutionFailure({code:_o.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new E_.Metadata});return}this.childLoadBalancer.updateAddressList(o,y,d);let _=f!=null?f:this.defaultServiceConfig;this.onSuccessfulResolution(u!=null?u:A_(_))},onError:o=>{this.handleResolutionFailure(o)}},n);let a={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new S_.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},a),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===Oe.ConnectivityState.IDLE&&this.updateState(Oe.ConnectivityState.CONNECTING,new Gr.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){O_(T_.uriToString(this.target)+" "+Oe.ConnectivityState[this.currentState]+" -> "+Oe.ConnectivityState[e]),e===Oe.ConnectivityState.IDLE&&(t=new Gr.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===Oe.ConnectivityState.IDLE&&(this.updateState(Oe.ConnectivityState.TRANSIENT_FAILURE,new Gr.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===Oe.ConnectivityState.IDLE||this.currentState===Oe.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.updateState(Oe.ConnectivityState.SHUTDOWN,new Gr.UnavailablePicker)}getTypeName(){return"resolving_load_balancer"}};$i.ResolvingLoadBalancer=So});var fd=p(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.channelOptionsEqual=Wr.recognizedOptions=void 0;Wr.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc-node.max_session_memory":!0};function N_(r,e){let t=Object.keys(r).sort(),n=Object.keys(e).sort();if(t.length!==n.length)return!1;for(let i=0;i<t.length;i+=1)if(t[i]!==n[i]||r[t[i]]!==e[n[i]])return!1;return!0}Wr.channelOptionsEqual=N_});var mt=p(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.stringToSubchannelAddress=gt.subchannelAddressToString=gt.subchannelAddressEqual=gt.isTcpSubchannelAddress=void 0;var k_=require("net");function qn(r){return"port"in r}gt.isTcpSubchannelAddress=qn;function P_(r,e){return qn(r)?qn(e)&&r.host===e.host&&r.port===e.port:!qn(e)&&r.path===e.path}gt.subchannelAddressEqual=P_;function I_(r){return qn(r)?r.host+":"+r.port:r.path}gt.subchannelAddressToString=I_;var M_=443;function x_(r,e){return k_.isIP(r)?{host:r,port:e!=null?e:M_}:{path:r}}gt.stringToSubchannelAddress=x_});var Eo=p(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.getProxiedConnection=Jr.mapProxyName=void 0;var Fn=ie(),Vr=$(),D_=pt(),L_=require("http"),q_=require("tls"),F_=ie(),pd=mt(),Bn=De(),B_=require("url"),U_="proxy";function Jt(r){F_.trace(Vr.LogVerbosity.DEBUG,U_,r)}function z_(){let r="",e="";if(process.env.grpc_proxy)e="grpc_proxy",r=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",r=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",r=process.env.http_proxy;else return{};let t;try{t=new B_.URL(r)}catch(o){return Fn.log(Vr.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(t.protocol!=="http:")return Fn.log(Vr.LogVerbosity.ERROR,`"${t.protocol}" scheme not supported in proxy URI`),{};let n=null;t.username&&(t.password?(Fn.log(Vr.LogVerbosity.INFO,"userinfo found in proxy URI"),n=`${t.username}:${t.password}`):n=t.username);let i=t.hostname,s=t.port;s===""&&(s="80");let a={address:`${i}:${s}`};return n&&(a.creds=n),Jt("Proxy server "+a.address+" set by environment variable "+e),a}function j_(){let r=process.env.no_grpc_proxy,e="no_grpc_proxy";return r||(r=process.env.no_proxy,e="no_proxy"),r?(Jt("No proxy server list set by environment variable "+e),r.split(",")):[]}function H_(r,e){var t;let n={target:r,extraOptions:{}};if(((t=e["grpc.enable_http_proxy"])!==null&&t!==void 0?t:1)===0||r.scheme==="unix")return n;let i=z_();if(!i.address)return n;let s=Bn.splitHostPort(r.path);if(!s)return n;let a=s.host;for(let l of j_())if(l===a)return Jt("Not using proxy for target in no_proxy list: "+Bn.uriToString(r)),n;let o={"grpc.http_connect_target":Bn.uriToString(r)};return i.creds&&(o["grpc.http_connect_creds"]=i.creds),{target:{scheme:"dns",path:i.address},extraOptions:o}}Jr.mapProxyName=H_;function $_(r,e,t){if(!("grpc.http_connect_target"in e))return Promise.resolve({});let n=e["grpc.http_connect_target"],i=Bn.parseUri(n);if(i===null)return Promise.resolve({});let s={method:"CONNECT",path:i.path},a={Host:i.path};pd.isTcpSubchannelAddress(r)?(s.host=r.host,s.port=r.port):s.socketPath=r.path,"grpc.http_connect_creds"in e&&(a["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),s.headers=a;let o=pd.subchannelAddressToString(r);return Jt("Using proxy "+o+" to connect to "+s.path),new Promise((l,c)=>{let u=L_.request(s);u.once("connect",(d,h,f)=>{var g;if(u.removeAllListeners(),h.removeAllListeners(),d.statusCode===200)if(Jt("Successfully connected to "+s.path+" through proxy "+o),"secureContext"in t){let y=D_.getDefaultAuthority(i),_=Bn.splitHostPort(y),T=(g=_==null?void 0:_.host)!==null&&g!==void 0?g:y,b=q_.connect(Object.assign({host:T,servername:T,socket:h},t),()=>{Jt("Successfully established a TLS connection to "+s.path+" through proxy "+o),l({socket:b,realTarget:i})});b.on("error",B=>{Jt("Failed to establish a TLS connection to "+s.path+" through proxy "+o+" with error "+B.message),c()})}else Jt("Successfully established a plaintext connection to "+s.path+" through proxy "+o),l({socket:h,realTarget:i});else Fn.log(Vr.LogVerbosity.ERROR,"Failed to connect to "+s.path+" through proxy "+o+" with status "+d.statusCode),c()}),u.once("error",d=>{u.removeAllListeners(),Fn.log(Vr.LogVerbosity.ERROR,"Failed to connect to proxy "+o+" with error "+d.message),c()}),u.end()})}Jr.getProxiedConnection=$_});var Gi=p(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.addAdminServicesToServer=Yr.registerAdminService=void 0;var gd=[];function G_(r,e){gd.push({getServiceDefinition:r,getHandlers:e})}Yr.registerAdminService=G_;function W_(r){for(let{getServiceDefinition:e,getHandlers:t}of gd)r.addService(e(),t())}Yr.addAdminServicesToServer=W_});var md=p(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.ClientDuplexStreamImpl=qe.ClientWritableStreamImpl=qe.ClientReadableStreamImpl=qe.ClientUnaryCallImpl=qe.callErrorFromStatus=void 0;var V_=require("events"),wo=require("stream"),Un=$();function J_(r,e){let t=`${r.code} ${Un.Status[r.code]}: ${r.details}`,i=`${new Error(t).stack}
for call at
${e}`;return Object.assign(new Error(t),r,{stack:i})}qe.callErrorFromStatus=J_;var bo=class extends V_.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Un.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}};qe.ClientUnaryCallImpl=bo;var Co=class extends wo.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Un.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}};qe.ClientReadableStreamImpl=Co;var To=class extends wo.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Un.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,n){var i;let s={callback:n},a=Number(t);Number.isNaN(a)||(s.flags=a),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};qe.ClientWritableStreamImpl=To;var Ro=class extends wo.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Un.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}_write(e,t,n){var i;let s={callback:n},a=Number(t);Number.isNaN(a)||(s.flags=a),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};qe.ClientDuplexStreamImpl=Ro});var Mo=p(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.getInterceptingCall=Fe.InterceptingCall=Fe.RequesterBuilder=Fe.ListenerBuilder=Fe.InterceptorConfigurationError=void 0;var Y_=Xe(),vd=io(),yd=$(),vr=class extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,vr)}};Fe.InterceptorConfigurationError=vr;var Ao=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};Fe.ListenerBuilder=Ao;var No=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};Fe.RequesterBuilder=No;var Oo={onReceiveMetadata:(r,e)=>{e(r)},onReceiveMessage:(r,e)=>{e(r)},onReceiveStatus:(r,e)=>{e(r)}},zn={start:(r,e,t)=>{t(r,e)},sendMessage:(r,e)=>{e(r)},halfClose:r=>{r()},cancel:r=>{r()}},ko=class{constructor(e,t){var n,i,s,a;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:(n=t.start)!==null&&n!==void 0?n:zn.start,sendMessage:(i=t.sendMessage)!==null&&i!==void 0?i:zn.sendMessage,halfClose:(s=t.halfClose)!==null&&s!==void 0?s:zn.halfClose,cancel:(a=t.cancel)!==null&&a!==void 0?a:zn.cancel}:this.requester=zn}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var n,i,s,a,o,l;let c={onReceiveMetadata:(i=(n=t==null?void 0:t.onReceiveMetadata)===null||n===void 0?void 0:n.bind(t))!==null&&i!==void 0?i:u=>{},onReceiveMessage:(a=(s=t==null?void 0:t.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&a!==void 0?a:u=>{},onReceiveStatus:(l=(o=t==null?void 0:t.onReceiveStatus)===null||o===void 0?void 0:o.bind(t))!==null&&l!==void 0?l:u=>{}};this.processingMetadata=!0,this.requester.start(e,c,(u,d)=>{var h,f,g;this.processingMetadata=!1;let y;if(vd.isInterceptingListener(d))y=d;else{let _={onReceiveMetadata:(h=d.onReceiveMetadata)!==null&&h!==void 0?h:Oo.onReceiveMetadata,onReceiveMessage:(f=d.onReceiveMessage)!==null&&f!==void 0?f:Oo.onReceiveMessage,onReceiveStatus:(g=d.onReceiveStatus)!==null&&g!==void 0?g:Oo.onReceiveStatus};y=new vd.InterceptingListenerImpl(_,c)}this.nextCall.start(u,y),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,n=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,n),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}setCredentials(e){this.nextCall.setCredentials(e)}};Fe.InterceptingCall=ko;function K_(r,e,t){var n,i;let s=(n=t.deadline)!==null&&n!==void 0?n:1/0,a=t.host,o=(i=t.parent)!==null&&i!==void 0?i:null,l=t.propagate_flags,c=t.credentials,u=r.createCall(e,s,a,o,l);return c&&u.setCredentials(c),u}var Wi=class{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}setCredentials(e){this.call.setCredentials(e)}sendMessageWithContext(e,t){let n;try{n=this.methodDefinition.requestSerialize(t)}catch(i){this.call.cancelWithStatus(yd.Status.INTERNAL,`Request message serialization failure: ${i.message}`);return}this.call.sendMessageWithContext(e,n)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let n=null;this.call.start(e,{onReceiveMetadata:i=>{var s;(s=t==null?void 0:t.onReceiveMetadata)===null||s===void 0||s.call(t,i)},onReceiveMessage:i=>{var s;let a;try{a=this.methodDefinition.responseDeserialize(i)}catch(o){n={code:yd.Status.INTERNAL,details:`Response message parsing error: ${o.message}`,metadata:new Y_.Metadata},this.call.cancelWithStatus(n.code,n.details);return}(s=t==null?void 0:t.onReceiveMessage)===null||s===void 0||s.call(t,a)},onReceiveStatus:i=>{var s,a;n?(s=t==null?void 0:t.onReceiveStatus)===null||s===void 0||s.call(t,n):(a=t==null?void 0:t.onReceiveStatus)===null||a===void 0||a.call(t,i)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},Po=class extends Wi{constructor(e,t){super(e,t)}start(e,t){var n,i;let s=!1,a={onReceiveMetadata:(i=(n=t==null?void 0:t.onReceiveMetadata)===null||n===void 0?void 0:n.bind(t))!==null&&i!==void 0?i:o=>{},onReceiveMessage:o=>{var l;s=!0,(l=t==null?void 0:t.onReceiveMessage)===null||l===void 0||l.call(t,o)},onReceiveStatus:o=>{var l,c;s||(l=t==null?void 0:t.onReceiveMessage)===null||l===void 0||l.call(t,null),(c=t==null?void 0:t.onReceiveStatus)===null||c===void 0||c.call(t,o)}};super.start(e,a),this.call.startRead()}},Io=class extends Wi{};function X_(r,e,t){let n=K_(r,t.path,e);return t.responseStream?new Io(n,t):new Po(n,t)}function Q_(r,e,t,n){if(r.clientInterceptors.length>0&&r.clientInterceptorProviders.length>0)throw new vr("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(r.callInterceptors.length>0&&r.callInterceptorProviders.length>0)throw new vr("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let i=[];r.callInterceptors.length>0||r.callInterceptorProviders.length>0?i=[].concat(r.callInterceptors,r.callInterceptorProviders.map(o=>o(e))).filter(o=>o):i=[].concat(r.clientInterceptors,r.clientInterceptorProviders.map(o=>o(e))).filter(o=>o);let s=Object.assign({},t,{method_definition:e});return i.reduceRight((o,l)=>c=>l(c,o),o=>X_(n,o,e))(s)}Fe.getInterceptingCall=Q_});var Lo=p(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});Ji.Client=void 0;var vt=md(),Z_=qo(),e0=Qe(),Yt=$(),Kr=Xe(),Vi=Mo(),Ze=Symbol(),Xr=Symbol(),Qr=Symbol(),kt=Symbol();function xo(r){return typeof r=="function"}function Zr(r){return r.stack.split(`
`).slice(1).join(`
`)}var Do=class{constructor(e,t,n={}){var i,s;if(n=Object.assign({},n),this[Xr]=(i=n.interceptors)!==null&&i!==void 0?i:[],delete n.interceptors,this[Qr]=(s=n.interceptor_providers)!==null&&s!==void 0?s:[],delete n.interceptor_providers,this[Xr].length>0&&this[Qr].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[kt]=n.callInvocationTransformer,delete n.callInvocationTransformer,n.channelOverride)this[Ze]=n.channelOverride;else if(n.channelFactoryOverride){let a=n.channelFactoryOverride;delete n.channelFactoryOverride,this[Ze]=a(e,t,n)}else this[Ze]=new Z_.ChannelImplementation(e,t,n)}close(){this[Ze].close()}getChannel(){return this[Ze]}waitForReady(e,t){let n=i=>{if(i){t(new Error("Failed to connect before the deadline"));return}let s;try{s=this[Ze].getConnectivityState(!0)}catch(a){t(new Error("The channel has been closed"));return}if(s===e0.ConnectivityState.READY)t();else try{this[Ze].watchConnectivityState(s,e,n)}catch(a){t(new Error("The channel has been closed"))}};setImmediate(n)}checkOptionalUnaryResponseArguments(e,t,n){if(xo(e))return{metadata:new Kr.Metadata,options:{},callback:e};if(xo(t))return e instanceof Kr.Metadata?{metadata:e,options:{},callback:t}:{metadata:new Kr.Metadata,options:e,callback:t};if(!(e instanceof Kr.Metadata&&t instanceof Object&&xo(n)))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:n}}makeUnaryRequest(e,t,n,i,s,a,o){var l,c;let u=this.checkOptionalUnaryResponseArguments(s,a,o),d={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:n},h={argument:i,metadata:u.metadata,call:new vt.ClientUnaryCallImpl,channel:this[Ze],methodDefinition:d,callOptions:u.options,callback:u.callback};this[kt]&&(h=this[kt](h));let f=h.call,g={clientInterceptors:this[Xr],clientInterceptorProviders:this[Qr],callInterceptors:(l=h.callOptions.interceptors)!==null&&l!==void 0?l:[],callInterceptorProviders:(c=h.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},y=Vi.getInterceptingCall(g,h.methodDefinition,h.callOptions,h.channel);f.call=y,h.callOptions.credentials&&y.setCredentials(h.callOptions.credentials);let _=null,T=!1,b=new Error;return y.start(h.metadata,{onReceiveMetadata:B=>{f.emit("metadata",B)},onReceiveMessage(B){_!==null&&y.cancelWithStatus(Yt.Status.INTERNAL,"Too many responses received"),_=B},onReceiveStatus(B){if(!T){if(T=!0,B.code===Yt.Status.OK)if(_===null){let N=Zr(b);h.callback(vt.callErrorFromStatus({code:Yt.Status.INTERNAL,details:"No message received",metadata:B.metadata},N))}else h.callback(null,_);else{let N=Zr(b);h.callback(vt.callErrorFromStatus(B,N))}f.emit("status",B)}}}),y.sendMessage(i),y.halfClose(),f}makeClientStreamRequest(e,t,n,i,s,a){var o,l;let c=this.checkOptionalUnaryResponseArguments(i,s,a),u={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:n},d={metadata:c.metadata,call:new vt.ClientWritableStreamImpl(t),channel:this[Ze],methodDefinition:u,callOptions:c.options,callback:c.callback};this[kt]&&(d=this[kt](d));let h=d.call,f={clientInterceptors:this[Xr],clientInterceptorProviders:this[Qr],callInterceptors:(o=d.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(l=d.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},g=Vi.getInterceptingCall(f,d.methodDefinition,d.callOptions,d.channel);h.call=g,d.callOptions.credentials&&g.setCredentials(d.callOptions.credentials);let y=null,_=!1,T=new Error;return g.start(d.metadata,{onReceiveMetadata:b=>{h.emit("metadata",b)},onReceiveMessage(b){y!==null&&g.cancelWithStatus(Yt.Status.INTERNAL,"Too many responses received"),y=b},onReceiveStatus(b){if(!_){if(_=!0,b.code===Yt.Status.OK)if(y===null){let B=Zr(T);d.callback(vt.callErrorFromStatus({code:Yt.Status.INTERNAL,details:"No message received",metadata:b.metadata},B))}else d.callback(null,y);else{let B=Zr(T);d.callback(vt.callErrorFromStatus(b,B))}h.emit("status",b)}}}),h}checkMetadataAndOptions(e,t){let n,i;return e instanceof Kr.Metadata?(n=e,t?i=t:i={}):(e?i=e:i={},n=new Kr.Metadata),{metadata:n,options:i}}makeServerStreamRequest(e,t,n,i,s,a){var o,l;let c=this.checkMetadataAndOptions(s,a),u={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:n},d={argument:i,metadata:c.metadata,call:new vt.ClientReadableStreamImpl(n),channel:this[Ze],methodDefinition:u,callOptions:c.options};this[kt]&&(d=this[kt](d));let h=d.call,f={clientInterceptors:this[Xr],clientInterceptorProviders:this[Qr],callInterceptors:(o=d.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(l=d.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},g=Vi.getInterceptingCall(f,d.methodDefinition,d.callOptions,d.channel);h.call=g,d.callOptions.credentials&&g.setCredentials(d.callOptions.credentials);let y=!1,_=new Error;return g.start(d.metadata,{onReceiveMetadata(T){h.emit("metadata",T)},onReceiveMessage(T){h.push(T)},onReceiveStatus(T){if(!y){if(y=!0,h.push(null),T.code!==Yt.Status.OK){let b=Zr(_);h.emit("error",vt.callErrorFromStatus(T,b))}h.emit("status",T)}}}),g.sendMessage(i),g.halfClose(),h}makeBidiStreamRequest(e,t,n,i,s){var a,o;let l=this.checkMetadataAndOptions(i,s),c={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:n},u={metadata:l.metadata,call:new vt.ClientDuplexStreamImpl(t,n),channel:this[Ze],methodDefinition:c,callOptions:l.options};this[kt]&&(u=this[kt](u));let d=u.call,h={clientInterceptors:this[Xr],clientInterceptorProviders:this[Qr],callInterceptors:(a=u.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(o=u.callOptions.interceptor_providers)!==null&&o!==void 0?o:[]},f=Vi.getInterceptingCall(h,u.methodDefinition,u.callOptions,u.channel);d.call=f,u.callOptions.credentials&&f.setCredentials(u.callOptions.credentials);let g=!1,y=new Error;return f.start(u.metadata,{onReceiveMetadata(_){d.emit("metadata",_)},onReceiveMessage(_){d.push(_)},onReceiveStatus(_){if(!g){if(g=!0,d.push(null),_.code!==Yt.Status.OK){let T=Zr(y);d.emit("error",vt.callErrorFromStatus(_,T))}d.emit("status",_)}}}),d}};Ji.Client=Do});var Bo=p(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.loadPackageDefinition=en.makeClientConstructor=void 0;var jn=Lo(),t0={unary:jn.Client.prototype.makeUnaryRequest,server_stream:jn.Client.prototype.makeServerStreamRequest,client_stream:jn.Client.prototype.makeClientStreamRequest,bidi:jn.Client.prototype.makeBidiStreamRequest};function Fo(r){return["__proto__","prototype","constructor"].includes(r)}function _d(r,e,t){t||(t={});class n extends jn.Client{}return Object.keys(r).forEach(i=>{if(Fo(i))return;let s=r[i],a;if(typeof i=="string"&&i.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?a="bidi":a="client_stream":s.responseStream?a="server_stream":a="unary";let o=s.requestSerialize,l=s.responseDeserialize,c=r0(t0[a],s.path,o,l);n.prototype[i]=c,Object.assign(n.prototype[i],s),s.originalName&&!Fo(s.originalName)&&(n.prototype[s.originalName]=n.prototype[i])}),n.service=r,n.serviceName=e,n}en.makeClientConstructor=_d;function r0(r,e,t,n){return function(...i){return r.call(this,e,t,n,...i)}}function n0(r){return"format"in r}function i0(r){let e={};for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t)){let n=r[t],i=t.split(".");if(i.some(o=>Fo(o)))continue;let s=i[i.length-1],a=e;for(let o of i.slice(0,-1))a[o]||(a[o]={}),a=a[o];n0(n)?a[s]=n:a[s]=_d(n,s,{})}return e}en.loadPackageDefinition=i0});var $d=p((XR,Hd)=>{var s0=1/0,a0="[object Symbol]",o0=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,l0=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ki="\\ud800-\\udfff",Od="\\u0300-\\u036f\\ufe20-\\ufe23",Ad="\\u20d0-\\u20f0",Nd="\\u2700-\\u27bf",kd="a-z\\xdf-\\xf6\\xf8-\\xff",c0="\\xac\\xb1\\xd7\\xf7",u0="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",d0="\\u2000-\\u206f",h0=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Pd="A-Z\\xc0-\\xd6\\xd8-\\xde",Id="\\ufe0e\\ufe0f",Md=c0+u0+d0+h0,zo="['\u2019]",f0="["+Ki+"]",Sd="["+Md+"]",Yi="["+Od+Ad+"]",xd="\\d+",p0="["+Nd+"]",Dd="["+kd+"]",Ld="[^"+Ki+Md+xd+Nd+kd+Pd+"]",Uo="\\ud83c[\\udffb-\\udfff]",g0="(?:"+Yi+"|"+Uo+")",qd="[^"+Ki+"]",jo="(?:\\ud83c[\\udde6-\\uddff]){2}",Ho="[\\ud800-\\udbff][\\udc00-\\udfff]",tn="["+Pd+"]",Fd="\\u200d",Ed="(?:"+Dd+"|"+Ld+")",m0="(?:"+tn+"|"+Ld+")",bd="(?:"+zo+"(?:d|ll|m|re|s|t|ve))?",Cd="(?:"+zo+"(?:D|LL|M|RE|S|T|VE))?",Bd=g0+"?",Ud="["+Id+"]?",v0="(?:"+Fd+"(?:"+[qd,jo,Ho].join("|")+")"+Ud+Bd+")*",zd=Ud+Bd+v0,y0="(?:"+[p0,jo,Ho].join("|")+")"+zd,_0="(?:"+[qd+Yi+"?",Yi,jo,Ho,f0].join("|")+")",S0=RegExp(zo,"g"),E0=RegExp(Yi,"g"),b0=RegExp(Uo+"(?="+Uo+")|"+_0+zd,"g"),C0=RegExp([tn+"?"+Dd+"+"+bd+"(?="+[Sd,tn,"$"].join("|")+")",m0+"+"+Cd+"(?="+[Sd,tn+Ed,"$"].join("|")+")",tn+"?"+Ed+"+"+bd,tn+"+"+Cd,xd,y0].join("|"),"g"),T0=RegExp("["+Fd+Ki+Od+Ad+Id+"]"),R0=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,w0={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},O0=typeof global=="object"&&global&&global.Object===Object&&global,A0=typeof self=="object"&&self&&self.Object===Object&&self,N0=O0||A0||Function("return this")();function k0(r,e,t,n){var i=-1,s=r?r.length:0;for(n&&s&&(t=r[++i]);++i<s;)t=e(t,r[i],i,r);return t}function P0(r){return r.split("")}function I0(r){return r.match(o0)||[]}function M0(r){return function(e){return r==null?void 0:r[e]}}var x0=M0(w0);function jd(r){return T0.test(r)}function D0(r){return R0.test(r)}function L0(r){return jd(r)?q0(r):P0(r)}function q0(r){return r.match(b0)||[]}function F0(r){return r.match(C0)||[]}var B0=Object.prototype,U0=B0.toString,Td=N0.Symbol,Rd=Td?Td.prototype:void 0,wd=Rd?Rd.toString:void 0;function z0(r,e,t){var n=-1,i=r.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(i);++n<i;)s[n]=r[n+e];return s}function j0(r){if(typeof r=="string")return r;if(V0(r))return wd?wd.call(r):"";var e=r+"";return e=="0"&&1/r==-s0?"-0":e}function H0(r,e,t){var n=r.length;return t=t===void 0?n:t,!e&&t>=n?r:z0(r,e,t)}function $0(r){return function(e){e=Xi(e);var t=jd(e)?L0(e):void 0,n=t?t[0]:e.charAt(0),i=t?H0(t,1).join(""):e.slice(1);return n[r]()+i}}function G0(r){return function(e){return k0(Q0(K0(e).replace(S0,"")),r,"")}}function W0(r){return!!r&&typeof r=="object"}function V0(r){return typeof r=="symbol"||W0(r)&&U0.call(r)==a0}function Xi(r){return r==null?"":j0(r)}var J0=G0(function(r,e,t){return e=e.toLowerCase(),r+(t?Y0(e):e)});function Y0(r){return X0(Xi(r).toLowerCase())}function K0(r){return r=Xi(r),r&&r.replace(l0,x0).replace(E0,"")}var X0=$0("toUpperCase");function Q0(r,e,t){return r=Xi(r),e=t?void 0:e,e===void 0?D0(r)?F0(r):I0(r):r.match(e)||[]}Hd.exports=J0});var $o=p((QR,Gd)=>{"use strict";Gd.exports=Z0;function Z0(r,e){for(var t=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)t[n++]=arguments[i++];return new Promise(function(o,l){t[n]=function(u){if(s)if(s=!1,u)l(u);else{for(var d=new Array(arguments.length-1),h=0;h<d.length;)d[h++]=arguments[h];o.apply(null,d)}};try{r.apply(e||null,t)}catch(c){s&&(s=!1,l(c))}})}});var Yd=p(Jd=>{"use strict";var Qi=Jd;Qi.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&e.charAt(t)==="=";)++n;return Math.ceil(e.length*3)/4-n};var rn=new Array(64),Vd=new Array(123);for(et=0;et<64;)Vd[rn[et]=et<26?et+65:et<52?et+71:et<62?et-4:et-59|43]=et++;var et;Qi.encode=function(e,t,n){for(var i=null,s=[],a=0,o=0,l;t<n;){var c=e[t++];switch(o){case 0:s[a++]=rn[c>>2],l=(c&3)<<4,o=1;break;case 1:s[a++]=rn[l|c>>4],l=(c&15)<<2,o=2;break;case 2:s[a++]=rn[l|c>>6],s[a++]=rn[c&63],o=0;break}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return o&&(s[a++]=rn[l],s[a++]=61,o===1&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var Wd="invalid encoding";Qi.decode=function(e,t,n){for(var i=n,s=0,a,o=0;o<e.length;){var l=e.charCodeAt(o++);if(l===61&&s>1)break;if((l=Vd[l])===void 0)throw Error(Wd);switch(s){case 0:a=l,s=1;break;case 1:t[n++]=a<<2|(l&48)>>4,a=l,s=2;break;case 2:t[n++]=(a&15)<<4|(l&60)>>2,a=l,s=3;break;case 3:t[n++]=(a&3)<<6|l,s=0;break}}if(s===1)throw Error(Wd);return n-i};Qi.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Xd=p((ew,Kd)=>{"use strict";Kd.exports=Zi;function Zi(){this._listeners={}}Zi.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this};Zi.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this};Zi.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}});var ih=p((tw,nh)=>{"use strict";nh.exports=Qd(Qd);function Qd(r){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),n=t[3]===128;function i(l,c,u){e[0]=l,c[u]=t[0],c[u+1]=t[1],c[u+2]=t[2],c[u+3]=t[3]}function s(l,c,u){e[0]=l,c[u]=t[3],c[u+1]=t[2],c[u+2]=t[1],c[u+3]=t[0]}r.writeFloatLE=n?i:s,r.writeFloatBE=n?s:i;function a(l,c){return t[0]=l[c],t[1]=l[c+1],t[2]=l[c+2],t[3]=l[c+3],e[0]}function o(l,c){return t[3]=l[c],t[2]=l[c+1],t[1]=l[c+2],t[0]=l[c+3],e[0]}r.readFloatLE=n?a:o,r.readFloatBE=n?o:a}():function(){function e(n,i,s,a){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,s,a);else if(isNaN(i))n(2143289344,s,a);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,s,a);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,s,a);else{var l=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-l)*8388608)&8388607;n((o<<31|l+127<<23|c)>>>0,s,a)}}r.writeFloatLE=e.bind(null,Zd),r.writeFloatBE=e.bind(null,eh);function t(n,i,s){var a=n(i,s),o=(a>>31)*2+1,l=a>>>23&255,c=a&8388607;return l===255?c?NaN:o*(1/0):l===0?o*1401298464324817e-60*c:o*Math.pow(2,l-150)*(c+8388608)}r.readFloatLE=t.bind(null,th),r.readFloatBE=t.bind(null,rh)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),n=t[7]===128;function i(l,c,u){e[0]=l,c[u]=t[0],c[u+1]=t[1],c[u+2]=t[2],c[u+3]=t[3],c[u+4]=t[4],c[u+5]=t[5],c[u+6]=t[6],c[u+7]=t[7]}function s(l,c,u){e[0]=l,c[u]=t[7],c[u+1]=t[6],c[u+2]=t[5],c[u+3]=t[4],c[u+4]=t[3],c[u+5]=t[2],c[u+6]=t[1],c[u+7]=t[0]}r.writeDoubleLE=n?i:s,r.writeDoubleBE=n?s:i;function a(l,c){return t[0]=l[c],t[1]=l[c+1],t[2]=l[c+2],t[3]=l[c+3],t[4]=l[c+4],t[5]=l[c+5],t[6]=l[c+6],t[7]=l[c+7],e[0]}function o(l,c){return t[7]=l[c],t[6]=l[c+1],t[5]=l[c+2],t[4]=l[c+3],t[3]=l[c+4],t[2]=l[c+5],t[1]=l[c+6],t[0]=l[c+7],e[0]}r.readDoubleLE=n?a:o,r.readDoubleBE=n?o:a}():function(){function e(n,i,s,a,o,l){var c=a<0?1:0;if(c&&(a=-a),a===0)n(0,o,l+i),n(1/a>0?0:2147483648,o,l+s);else if(isNaN(a))n(0,o,l+i),n(2146959360,o,l+s);else if(a>17976931348623157e292)n(0,o,l+i),n((c<<31|2146435072)>>>0,o,l+s);else{var u;if(a<22250738585072014e-324)u=a/5e-324,n(u>>>0,o,l+i),n((c<<31|u/4294967296)>>>0,o,l+s);else{var d=Math.floor(Math.log(a)/Math.LN2);d===1024&&(d=1023),u=a*Math.pow(2,-d),n(u*4503599627370496>>>0,o,l+i),n((c<<31|d+1023<<20|u*1048576&1048575)>>>0,o,l+s)}}}r.writeDoubleLE=e.bind(null,Zd,0,4),r.writeDoubleBE=e.bind(null,eh,4,0);function t(n,i,s,a,o){var l=n(a,o+i),c=n(a,o+s),u=(c>>31)*2+1,d=c>>>20&2047,h=4294967296*(c&1048575)+l;return d===2047?h?NaN:u*(1/0):d===0?u*5e-324*h:u*Math.pow(2,d-1075)*(h+4503599627370496)}r.readDoubleLE=t.bind(null,th,0,4),r.readDoubleBE=t.bind(null,rh,4,0)}(),r}function Zd(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function eh(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function th(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function rh(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var Go=p((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var ah=p(sh=>{"use strict";var Wo=sh;Wo.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?t+=1:n<2048?t+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,t+=4):t+=3;return t};Wo.read=function(e,t,n){var i=n-t;if(i<1)return"";for(var s=null,a=[],o=0,l;t<n;)l=e[t++],l<128?a[o++]=l:l>191&&l<224?a[o++]=(l&31)<<6|e[t++]&63:l>239&&l<365?(l=((l&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,a[o++]=55296+(l>>10),a[o++]=56320+(l&1023)):a[o++]=(l&15)<<12|(e[t++]&63)<<6|e[t++]&63,o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};Wo.write=function(e,t,n){for(var i=n,s,a,o=0;o<e.length;++o)s=e.charCodeAt(o),s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=s&63|128):(s&64512)===55296&&((a=e.charCodeAt(o+1))&64512)===56320?(s=65536+((s&1023)<<10)+(a&1023),++o,t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=s&63|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=s&63|128);return n-i}});var lh=p((nw,oh)=>{"use strict";oh.exports=eS;function eS(r,e,t){var n=t||8192,i=n>>>1,s=null,a=n;return function(l){if(l<1||l>i)return r(l);a+l>n&&(s=r(n),a=0);var c=e.call(s,a,a+=l);return a&7&&(a=(a|7)+1),c}}});var uh=p((iw,ch)=>{"use strict";ch.exports=se;var Hn=yt();function se(r,e){this.lo=r>>>0,this.hi=e>>>0}var yr=se.zero=new se(0,0);yr.toNumber=function(){return 0};yr.zzEncode=yr.zzDecode=function(){return this};yr.length=function(){return 1};var tS=se.zeroHash="\0\0\0\0\0\0\0\0";se.fromNumber=function(e){if(e===0)return yr;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new se(n,i)};se.from=function(e){if(typeof e=="number")return se.fromNumber(e);if(Hn.isString(e))if(Hn.Long)e=Hn.Long.fromString(e);else return se.fromNumber(parseInt(e,10));return e.low||e.high?new se(e.low>>>0,e.high>>>0):yr};se.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+n*4294967296)}return this.lo+this.hi*4294967296};se.prototype.toLong=function(e){return Hn.Long?new Hn.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Kt=String.prototype.charCodeAt;se.fromHash=function(e){return e===tS?yr:new se((Kt.call(e,0)|Kt.call(e,1)<<8|Kt.call(e,2)<<16|Kt.call(e,3)<<24)>>>0,(Kt.call(e,4)|Kt.call(e,5)<<8|Kt.call(e,6)<<16|Kt.call(e,7)<<24)>>>0)};se.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};se.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};se.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};se.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}});var yt=p(Vo=>{"use strict";var w=Vo;w.asPromise=$o();w.base64=Yd();w.EventEmitter=Xd();w.float=ih();w.inquire=Go();w.utf8=ah();w.pool=lh();w.LongBits=uh();w.isNode=Boolean(typeof global!="undefined"&&global&&global.process&&global.process.versions&&global.process.versions.node);w.global=w.isNode&&global||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Vo;w.emptyArray=Object.freeze?Object.freeze([]):[];w.emptyObject=Object.freeze?Object.freeze({}):{};w.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};w.isString=function(e){return typeof e=="string"||e instanceof String};w.isObject=function(e){return e&&typeof e=="object"};w.isset=w.isSet=function(e,t){var n=e[t];return n!=null&&e.hasOwnProperty(t)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};w.Buffer=function(){try{var r=w.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch(e){return null}}();w._Buffer_from=null;w._Buffer_allocUnsafe=null;w.newBuffer=function(e){return typeof e=="number"?w.Buffer?w._Buffer_allocUnsafe(e):new w.Array(e):w.Buffer?w._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};w.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;w.Long=w.global.dcodeIO&&w.global.dcodeIO.Long||w.global.Long||w.inquire("long");w.key2Re=/^true|false|0|1$/;w.key32Re=/^-?(?:0|[1-9][0-9]*)$/;w.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;w.longToHash=function(e){return e?w.LongBits.from(e).toHash():w.LongBits.zeroHash};w.longFromHash=function(e,t){var n=w.LongBits.fromHash(e);return w.Long?w.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))};function dh(r,e,t){for(var n=Object.keys(e),i=0;i<n.length;++i)(r[n[i]]===void 0||!t)&&(r[n[i]]=e[n[i]]);return r}w.merge=dh;w.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function hh(r){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&dh(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}w.newError=hh;w.ProtocolError=hh("ProtocolError");w.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(t[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};w.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}};w.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};w._configure=function(){var r=w.Buffer;if(!r){w._Buffer_from=w._Buffer_allocUnsafe=null;return}w._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,n){return new r(t,n)},w._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var ts=p((aw,mh)=>{"use strict";mh.exports=F;var Be=yt(),Jo,es=Be.LongBits,fh=Be.base64,ph=Be.utf8;function $n(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function Ko(){}function rS(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function F(){this.len=0,this.head=new $n(Ko,0,0),this.tail=this.head,this.states=null}var gh=function(){return Be.Buffer?function(){return(F.create=function(){return new Jo})()}:function(){return new F}};F.create=gh();F.alloc=function(e){return new Be.Array(e)};Be.Array!==Array&&(F.alloc=Be.pool(F.alloc,Be.Array.prototype.subarray));F.prototype._push=function(e,t,n){return this.tail=this.tail.next=new $n(e,t,n),this.len+=t,this};function Xo(r,e,t){e[t]=r&255}function nS(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function Qo(r,e){this.len=r,this.next=void 0,this.val=e}Qo.prototype=Object.create($n.prototype);Qo.prototype.fn=nS;F.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Qo((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};F.prototype.int32=function(e){return e<0?this._push(Zo,10,es.fromNumber(e)):this.uint32(e)};F.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Zo(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}F.prototype.uint64=function(e){var t=es.from(e);return this._push(Zo,t.length(),t)};F.prototype.int64=F.prototype.uint64;F.prototype.sint64=function(e){var t=es.from(e).zzEncode();return this._push(Zo,t.length(),t)};F.prototype.bool=function(e){return this._push(Xo,1,e?1:0)};function Yo(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}F.prototype.fixed32=function(e){return this._push(Yo,4,e>>>0)};F.prototype.sfixed32=F.prototype.fixed32;F.prototype.fixed64=function(e){var t=es.from(e);return this._push(Yo,4,t.lo)._push(Yo,4,t.hi)};F.prototype.sfixed64=F.prototype.fixed64;F.prototype.float=function(e){return this._push(Be.float.writeFloatLE,4,e)};F.prototype.double=function(e){return this._push(Be.float.writeDoubleLE,8,e)};var iS=Be.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};F.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(Xo,1,0);if(Be.isString(e)){var n=F.alloc(t=fh.length(e));fh.decode(e,n,0),e=n}return this.uint32(t)._push(iS,t,e)};F.prototype.string=function(e){var t=ph.length(e);return t?this.uint32(t)._push(ph.write,t,e):this._push(Xo,1,0)};F.prototype.fork=function(){return this.states=new rS(this),this.head=this.tail=new $n(Ko,0,0),this.len=0,this};F.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new $n(Ko,0,0),this.len=0),this};F.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this};F.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t};F._configure=function(r){Jo=r,F.create=gh(),Jo._configure()}});var _h=p((ow,yh)=>{"use strict";yh.exports=_t;var vh=ts();(_t.prototype=Object.create(vh.prototype)).constructor=_t;var Xt=yt();function _t(){vh.call(this)}_t._configure=function(){_t.alloc=Xt._Buffer_allocUnsafe,_t.writeBytesBuffer=Xt.Buffer&&Xt.Buffer.prototype instanceof Uint8Array&&Xt.Buffer.prototype.set.name==="set"?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}};_t.prototype.bytes=function(e){Xt.isString(e)&&(e=Xt._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(_t.writeBytesBuffer,t,e),this};function sS(r,e,t){r.length<40?Xt.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}_t.prototype.string=function(e){var t=Xt.Buffer.byteLength(e);return this.uint32(t),t&&this._push(sS,t,e),this};_t._configure()});var ns=p((lw,Th)=>{"use strict";Th.exports=Z;var St=yt(),tl,bh=St.LongBits,aS=St.utf8;function tt(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function Z(r){this.buf=r,this.pos=0,this.len=r.length}var Sh=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Z(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Z(e);throw Error("illegal buffer")},Ch=function(){return St.Buffer?function(t){return(Z.create=function(i){return St.Buffer.isBuffer(i)?new tl(i):Sh(i)})(t)}:Sh};Z.create=Ch();Z.prototype._slice=St.Array.prototype.subarray||St.Array.prototype.slice;Z.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,tt(this,10);return e}}();Z.prototype.int32=function(){return this.uint32()|0};Z.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function el(){var r=new bh(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw tt(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw tt(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}Z.prototype.bool=function(){return this.uint32()!==0};function rs(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}Z.prototype.fixed32=function(){if(this.pos+4>this.len)throw tt(this,4);return rs(this.buf,this.pos+=4)};Z.prototype.sfixed32=function(){if(this.pos+4>this.len)throw tt(this,4);return rs(this.buf,this.pos+=4)|0};function Eh(){if(this.pos+8>this.len)throw tt(this,8);return new bh(rs(this.buf,this.pos+=4),rs(this.buf,this.pos+=4))}Z.prototype.float=function(){if(this.pos+4>this.len)throw tt(this,4);var e=St.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Z.prototype.double=function(){if(this.pos+8>this.len)throw tt(this,4);var e=St.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Z.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw tt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)};Z.prototype.string=function(){var e=this.bytes();return aS.read(e,0,e.length)};Z.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw tt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw tt(this);while(this.buf[this.pos++]&128);return this};Z.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};Z._configure=function(r){tl=r,Z.create=Ch(),tl._configure();var e=St.Long?"toLong":"toNumber";St.merge(Z.prototype,{int64:function(){return el.call(this)[e](!1)},uint64:function(){return el.call(this)[e](!0)},sint64:function(){return el.call(this).zzDecode()[e](!1)},fixed64:function(){return Eh.call(this)[e](!0)},sfixed64:function(){return Eh.call(this)[e](!1)}})}});var Ah=p((cw,Oh)=>{"use strict";Oh.exports=_r;var wh=ns();(_r.prototype=Object.create(wh.prototype)).constructor=_r;var Rh=yt();function _r(r){wh.call(this,r)}_r._configure=function(){Rh.Buffer&&(_r.prototype._slice=Rh.Buffer.prototype.slice)};_r.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};_r._configure()});var kh=p((uw,Nh)=>{"use strict";Nh.exports=Gn;var rl=yt();(Gn.prototype=Object.create(rl.EventEmitter.prototype)).constructor=Gn;function Gn(r,e,t){if(typeof r!="function")throw TypeError("rpcImpl must be a function");rl.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}Gn.prototype.rpcCall=function r(e,t,n,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return rl.asPromise(r,a,e,t,n,i);if(!a.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return a.rpcImpl(e,t[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(l,c){if(l)return a.emit("error",l,e),s(l);if(c===null){a.end(!0);return}if(!(c instanceof n))try{c=n[a.responseDelimited?"decodeDelimited":"decode"](c)}catch(u){return a.emit("error",u,e),s(u)}return a.emit("data",c,e),s(null,c)})}catch(o){a.emit("error",o,e),setTimeout(function(){s(o)},0);return}};Gn.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var nl=p(Ph=>{"use strict";var oS=Ph;oS.Service=kh()});var il=p((hw,Ih)=>{"use strict";Ih.exports={}});var Dh=p(xh=>{"use strict";var Ee=xh;Ee.build="minimal";Ee.Writer=ts();Ee.BufferWriter=_h();Ee.Reader=ns();Ee.BufferReader=Ah();Ee.util=yt();Ee.rpc=nl();Ee.roots=il();Ee.configure=Mh;function Mh(){Ee.util._configure(),Ee.Writer._configure(Ee.BufferWriter),Ee.Reader._configure(Ee.BufferReader)}Mh()});var qh=p((pw,Lh)=>{"use strict";Lh.exports=sl;function sl(r,e){typeof r=="string"&&(e=r,r=void 0);var t=[];function n(s){if(typeof s!="string"){var a=i();if(sl.verbose&&console.log("codegen: "+a),a="return "+a,s){for(var o=Object.keys(s),l=new Array(o.length+1),c=new Array(o.length),u=0;u<o.length;)l[u]=o[u],c[u]=s[o[u++]];return l[u]=a,Function.apply(null,l).apply(null,c)}return Function(a)()}for(var d=new Array(arguments.length-1),h=0;h<d.length;)d[h]=arguments[++h];if(h=0,s=s.replace(/%([%dfijs])/g,function(g,y){var _=d[h++];switch(y){case"d":case"f":return String(Number(_));case"i":return String(Math.floor(_));case"j":return JSON.stringify(_);case"s":return String(_)}return"%"}),h!==d.length)throw Error("parameter count mismatch");return t.push(s),n}function i(s){return"function "+(s||e||"")+"("+(r&&r.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return n.toString=i,n}sl.verbose=!1});var Bh=p((gw,Fh)=>{"use strict";Fh.exports=Wn;var lS=$o(),cS=Go(),al=cS("fs");function Wn(r,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&al&&al.readFile?al.readFile(r,function(i,s){return i&&typeof XMLHttpRequest!="undefined"?Wn.xhr(r,e,t):i?t(i):t(null,e.binary?s:s.toString("utf8"))}):Wn.xhr(r,e,t):lS(Wn,this,r,e)}Wn.xhr=function(e,t,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return n(Error("status "+i.status));if(t.binary){var a=i.response;if(!a){a=[];for(var o=0;o<i.responseText.length;++o)a.push(i.responseText.charCodeAt(o)&255)}return n(null,typeof Uint8Array!="undefined"?new Uint8Array(a):a)}return n(null,i.responseText)}},t.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}});var jh=p(zh=>{"use strict";var ll=zh,Uh=ll.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},ol=ll.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),n=Uh(e),i="";n&&(i=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):n?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return i+t.join("/")};ll.resolve=function(e,t,n){return n||(t=ol(t)),Uh(t)?t:(n||(e=ol(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?ol(e+"/"+t):t)}});var Sr=p(Hh=>{"use strict";var Vn=Hh,uS=ae(),dS=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Jn(r,e){var t=0,n={};for(e|=0;t<r.length;)n[dS[t+e]]=r[t++];return n}Vn.basic=Jn([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Vn.defaults=Jn([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",uS.emptyArray,null]);Vn.long=Jn([0,0,0,1,1],7);Vn.mapKey=Jn([0,0,0,5,5,0,0,0,1,1,0,2],2);Vn.packed=Jn([1,5,0,0,0,5,5,0,0,0,1,1,0])});var Qt=p((yw,Wh)=>{"use strict";Wh.exports=Ue;var is=Er();((Ue.prototype=Object.create(is.prototype)).constructor=Ue).className="Field";var $h=rt(),Gh=Sr(),re=ae(),cl,hS=/^required|optional|repeated$/;Ue.fromJSON=function(e,t){return new Ue(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)};function Ue(r,e,t,n,i,s,a){if(re.isObject(n)?(a=i,s=n,n=i=void 0):re.isObject(i)&&(a=s,s=i,i=void 0),is.call(this,r,s),!re.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!re.isString(t))throw TypeError("type must be a string");if(n!==void 0&&!hS.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!re.isString(i))throw TypeError("extend must be a string");n==="proto3_optional"&&(n="optional"),this.rule=n&&n!=="optional"?n:void 0,this.type=t,this.id=e,this.extend=i||void 0,this.required=n==="required",this.optional=!this.required,this.repeated=n==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=re.Long?Gh.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=a}Object.defineProperty(Ue.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});Ue.prototype.setOption=function(e,t,n){return e==="packed"&&(this._packed=null),is.prototype.setOption.call(this,e,t,n)};Ue.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return re.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Ue.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=Gh.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof cl?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof $h&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof $h))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=re.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;re.base64.test(this.typeDefault)?re.base64.decode(this.typeDefault,e=re.newBuffer(re.base64.length(this.typeDefault)),0):re.utf8.write(this.typeDefault,e=re.newBuffer(re.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=re.emptyObject:this.repeated?this.defaultValue=re.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof cl&&(this.parent.ctor.prototype[this.name]=this.defaultValue),is.prototype.resolve.call(this)};Ue.d=function(e,t,n,i){return typeof t=="function"?t=re.decorateType(t).name:t&&typeof t=="object"&&(t=re.decorateEnum(t).name),function(a,o){re.decorateType(a.constructor).add(new Ue(o,e,t,n,{default:i}))}};Ue._configure=function(e){cl=e}});var nn=p((_w,Yh)=>{"use strict";Yh.exports=ze;var as=Er();((ze.prototype=Object.create(as.prototype)).constructor=ze).className="OneOf";var Vh=Qt(),ss=ae();function ze(r,e,t,n){if(Array.isArray(e)||(t=e,e=void 0),as.call(this,r,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=n}ze.fromJSON=function(e,t){return new ze(e,t.oneof,t.options,t.comment)};ze.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return ss.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function Jh(r){if(r.parent)for(var e=0;e<r.fieldsArray.length;++e)r.fieldsArray[e].parent||r.parent.add(r.fieldsArray[e])}ze.prototype.add=function(e){if(!(e instanceof Vh))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,Jh(this),this};ze.prototype.remove=function(e){if(!(e instanceof Vh))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};ze.prototype.onAdd=function(e){as.prototype.onAdd.call(this,e);for(var t=this,n=0;n<this.oneof.length;++n){var i=e.get(this.oneof[n]);i&&!i.partOf&&(i.partOf=t,t.fieldsArray.push(i))}Jh(this)};ze.prototype.onRemove=function(e){for(var t=0,n;t<this.fieldsArray.length;++t)(n=this.fieldsArray[t]).parent&&n.parent.remove(n);as.prototype.onRemove.call(this,e)};ze.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(i,s){ss.decorateType(i.constructor).add(new ze(s,e)),Object.defineProperty(i,s,{get:ss.oneOfGetter(e),set:ss.oneOfSetter(e)})}}});var on=p((Sw,Zh)=>{"use strict";Zh.exports=U;var ul=Er();((U.prototype=Object.create(ul.prototype)).constructor=U).className="Namespace";var Kh=Qt(),os=ae(),fS=nn(),sn,Yn,an;U.fromJSON=function(e,t){return new U(e,t.options).addJSON(t.nested)};function Xh(r,e){if(!!(r&&r.length)){for(var t={},n=0;n<r.length;++n)t[r[n].name]=r[n].toJSON(e);return t}}U.arrayToJSON=Xh;U.isReservedId=function(e,t){if(e){for(var n=0;n<e.length;++n)if(typeof e[n]!="string"&&e[n][0]<=t&&e[n][1]>t)return!0}return!1};U.isReservedName=function(e,t){if(e){for(var n=0;n<e.length;++n)if(e[n]===t)return!0}return!1};function U(r,e){ul.call(this,r,e),this.nested=void 0,this._nestedArray=null}function Qh(r){return r._nestedArray=null,r}Object.defineProperty(U.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=os.toArray(this.nested))}});U.prototype.toJSON=function(e){return os.toObject(["options",this.options,"nested",Xh(this.nestedArray,e)])};U.prototype.addJSON=function(e){var t=this;if(e)for(var n=Object.keys(e),i=0,s;i<n.length;++i)s=e[n[i]],t.add((s.fields!==void 0?sn.fromJSON:s.values!==void 0?an.fromJSON:s.methods!==void 0?Yn.fromJSON:s.id!==void 0?Kh.fromJSON:U.fromJSON)(n[i],s));return this};U.prototype.get=function(e){return this.nested&&this.nested[e]||null};U.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof an)return this.nested[e].values;throw Error("no such enum: "+e)};U.prototype.add=function(e){if(!(e instanceof Kh&&e.extend!==void 0||e instanceof sn||e instanceof fS||e instanceof an||e instanceof Yn||e instanceof U))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof U&&e instanceof U&&!(t instanceof sn||t instanceof Yn)){for(var n=t.nestedArray,i=0;i<n.length;++i)e.add(n[i]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),Qh(this)};U.prototype.remove=function(e){if(!(e instanceof ul))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),Qh(this)};U.prototype.define=function(e,t){if(os.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var n=this;e.length>0;){var i=e.shift();if(n.nested&&n.nested[i]){if(n=n.nested[i],!(n instanceof U))throw Error("path conflicts with non-namespace objects")}else n.add(n=new U(i))}return t&&n.addJSON(t),n};U.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof U?e[t++].resolveAll():e[t++].resolve();return this.resolve()};U.prototype.lookup=function(e,t,n){if(typeof t=="boolean"?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),os.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),t);var i=this.get(e[0]);if(i){if(e.length===1){if(!t||t.indexOf(i.constructor)>-1)return i}else if(i instanceof U&&(i=i.lookup(e.slice(1),t,!0)))return i}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof U&&(i=this._nestedArray[s].lookup(e,t,!0)))return i;return this.parent===null||n?null:this.parent.lookup(e,t)};U.prototype.lookupType=function(e){var t=this.lookup(e,[sn]);if(!t)throw Error("no such type: "+e);return t};U.prototype.lookupEnum=function(e){var t=this.lookup(e,[an]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};U.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[sn,an]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};U.prototype.lookupService=function(e){var t=this.lookup(e,[Yn]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};U._configure=function(r,e,t){sn=r,Yn=e,an=t}});var ls=p((Ew,ef)=>{"use strict";ef.exports=Pt;var dl=Qt();((Pt.prototype=Object.create(dl.prototype)).constructor=Pt).className="MapField";var pS=Sr(),Kn=ae();function Pt(r,e,t,n,i,s){if(dl.call(this,r,e,n,void 0,void 0,i,s),!Kn.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}Pt.fromJSON=function(e,t){return new Pt(e,t.id,t.keyType,t.type,t.options,t.comment)};Pt.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return Kn.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Pt.prototype.resolve=function(){if(this.resolved)return this;if(pS.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return dl.prototype.resolve.call(this)};Pt.d=function(e,t,n){return typeof n=="function"?n=Kn.decorateType(n).name:n&&typeof n=="object"&&(n=Kn.decorateEnum(n).name),function(s,a){Kn.decorateType(s.constructor).add(new Pt(a,e,t,n))}}});var cs=p((bw,tf)=>{"use strict";tf.exports=br;var hl=Er();((br.prototype=Object.create(hl.prototype)).constructor=br).className="Method";var ln=ae();function br(r,e,t,n,i,s,a,o,l){if(ln.isObject(i)?(a=i,i=s=void 0):ln.isObject(s)&&(a=s,s=void 0),!(e===void 0||ln.isString(e)))throw TypeError("type must be a string");if(!ln.isString(t))throw TypeError("requestType must be a string");if(!ln.isString(n))throw TypeError("responseType must be a string");hl.call(this,r,a),this.type=e||"rpc",this.requestType=t,this.requestStream=i?!0:void 0,this.responseType=n,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=o,this.parsedOptions=l}br.fromJSON=function(e,t){return new br(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};br.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return ln.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};br.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),hl.prototype.resolve.call(this))}});var us=p((Cw,nf)=>{"use strict";nf.exports=je;var Zt=on();((je.prototype=Object.create(Zt.prototype)).constructor=je).className="Service";var fl=cs(),Xn=ae(),gS=nl();function je(r,e){Zt.call(this,r,e),this.methods={},this._methodsArray=null}je.fromJSON=function(e,t){var n=new je(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),s=0;s<i.length;++s)n.add(fl.fromJSON(i[s],t.methods[i[s]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n};je.prototype.toJSON=function(e){var t=Zt.prototype.toJSON.call(this,e),n=e?Boolean(e.keepComments):!1;return Xn.toObject(["options",t&&t.options||void 0,"methods",Zt.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])};Object.defineProperty(je.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Xn.toArray(this.methods))}});function rf(r){return r._methodsArray=null,r}je.prototype.get=function(e){return this.methods[e]||Zt.prototype.get.call(this,e)};je.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return Zt.prototype.resolve.call(this)};je.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof fl?(this.methods[e.name]=e,e.parent=this,rf(this)):Zt.prototype.add.call(this,e)};je.prototype.remove=function(e){if(e instanceof fl){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,rf(this)}return Zt.prototype.remove.call(this,e)};je.prototype.create=function(e,t,n){for(var i=new gS.Service(e,t,n),s=0,a;s<this.methodsArray.length;++s){var o=Xn.lcFirst((a=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[o]=Xn.codegen(["r","c"],Xn.isReserved(o)?o+"_":o)("return this.rpcCall(m,q,s,r,c)")({m:a,q:a.resolvedRequestType.ctor,s:a.resolvedResponseType.ctor})}return i}});var ds=p((Tw,sf)=>{"use strict";sf.exports=Et;var mS=yt();function Et(r){if(r)for(var e=Object.keys(r),t=0;t<e.length;++t)this[e[t]]=r[e[t]]}Et.create=function(e){return this.$type.create(e)};Et.encode=function(e,t){return this.$type.encode(e,t)};Et.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};Et.decode=function(e){return this.$type.decode(e)};Et.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};Et.verify=function(e){return this.$type.verify(e)};Et.fromObject=function(e){return this.$type.fromObject(e)};Et.toObject=function(e,t){return this.$type.toObject(e,t)};Et.prototype.toJSON=function(){return this.$type.toObject(this,mS.toJSONOptions)}});var pl=p((Rw,of)=>{"use strict";of.exports=_S;var vS=rt(),It=Sr(),af=ae();function yS(r){return"missing required '"+r.name+"'"}function _S(r){var e=af.codegen(["r","l"],r.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(r.fieldsArray.filter(function(o){return o.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");r.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var t=0;t<r.fieldsArray.length;++t){var n=r._fieldsArray[t].resolve(),i=n.resolvedType instanceof vS?"int32":n.type,s="m"+af.safeProp(n.name);e("case %i: {",n.id),n.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),It.defaults[n.keyType]!==void 0?e("k=%j",It.defaults[n.keyType]):e("k=null"),It.defaults[i]!==void 0?e("value=%j",It.defaults[i]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",n.keyType)("case 2:"),It.basic[i]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",i),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),It.long[n.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):n.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),It.packed[i]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),It.basic[i]===void 0?e(n.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,i)):It.basic[i]===void 0?e(n.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,i),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<r._fieldsArray.length;++t){var a=r._fieldsArray[t];a.required&&e("if(!m.hasOwnProperty(%j))",a.name)("throw util.ProtocolError(%j,{instance:m})",yS(a))}return e("return m")}});var vl=p((ww,lf)=>{"use strict";lf.exports=bS;var SS=rt(),gl=ae();function He(r,e){return r.name+": "+e+(r.repeated&&e!=="array"?"[]":r.map&&e!=="object"?"{k:"+r.keyType+"}":"")+" expected"}function ml(r,e,t,n){if(e.resolvedType)if(e.resolvedType instanceof SS){r("switch(%s){",n)("default:")("return%j",He(e,"enum value"));for(var i=Object.keys(e.resolvedType.values),s=0;s<i.length;++s)r("case %i:",e.resolvedType.values[i[s]]);r("break")("}")}else r("{")("var e=types[%i].verify(%s);",t,n)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":r("if(!util.isInteger(%s))",n)("return%j",He(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":r("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",He(e,"integer|Long"));break;case"float":case"double":r('if(typeof %s!=="number")',n)("return%j",He(e,"number"));break;case"bool":r('if(typeof %s!=="boolean")',n)("return%j",He(e,"boolean"));break;case"string":r("if(!util.isString(%s))",n)("return%j",He(e,"string"));break;case"bytes":r('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",He(e,"buffer"));break}return r}function ES(r,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":r("if(!util.key32Re.test(%s))",t)("return%j",He(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":r("if(!util.key64Re.test(%s))",t)("return%j",He(e,"integer|Long key"));break;case"bool":r("if(!util.key2Re.test(%s))",t)("return%j",He(e,"boolean key"));break}return r}function bS(r){var e=gl.codegen(["m"],r.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=r.oneofsArray,n={};t.length&&e("var p={}");for(var i=0;i<r.fieldsArray.length;++i){var s=r._fieldsArray[i].resolve(),a="m"+gl.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",a,s.name),s.map)e("if(!util.isObject(%s))",a)("return%j",He(s,"object"))("var k=Object.keys(%s)",a)("for(var i=0;i<k.length;++i){"),ES(e,s,"k[i]"),ml(e,s,i,a+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",a)("return%j",He(s,"array"))("for(var i=0;i<%s.length;++i){",a),ml(e,s,i,a+"[i]")("}");else{if(s.partOf){var o=gl.safeProp(s.partOf.name);n[s.partOf.name]===1&&e("if(p%s===1)",o)("return%j",s.partOf.name+": multiple values"),n[s.partOf.name]=1,e("p%s=1",o)}ml(e,s,i,a)}s.optional&&e("}")}return e("return null")}});var Sl=p(uf=>{"use strict";var cf=uf,Qn=rt(),bt=ae();function yl(r,e,t,n){var i=!1;if(e.resolvedType)if(e.resolvedType instanceof Qn){r("switch(d%s){",n);for(var s=e.resolvedType.values,a=Object.keys(s),o=0;o<a.length;++o)s[a[o]]===e.typeDefault&&!i&&(r("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',n,n,n),e.repeated||r("break"),i=!0),r("case%j:",a[o])("case %i:",s[a[o]])("m%s=%j",n,s[a[o]])("break");r("}")}else r('if(typeof d%s!=="object")',n)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,t,n);else{var l=!1;switch(e.type){case"double":case"float":r("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":r("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":r("m%s=d%s|0",n,n);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":r("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,l)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,l?"true":"");break;case"bytes":r('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":r("m%s=String(d%s)",n,n);break;case"bool":r("m%s=Boolean(d%s)",n,n);break}}return r}cf.fromObject=function(e){var t=e.fieldsArray,n=bt.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var i=0;i<t.length;++i){var s=t[i].resolve(),a=bt.safeProp(s.name);s.map?(n("if(d%s){",a)('if(typeof d%s!=="object")',a)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",a)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",a),yl(n,s,i,a+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",a)("if(!Array.isArray(d%s))",a)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",a)("for(var i=0;i<d%s.length;++i){",a),yl(n,s,i,a+"[i]")("}")("}")):(s.resolvedType instanceof Qn||n("if(d%s!=null){",a),yl(n,s,i,a),s.resolvedType instanceof Qn||n("}"))}return n("return m")};function _l(r,e,t,n){if(e.resolvedType)e.resolvedType instanceof Qn?r("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",n,t,n,n,t,n,n):r("d%s=types[%i].toObject(m%s,o)",n,t,n);else{var i=!1;switch(e.type){case"double":case"float":r("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":r('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,i?"true":"",n);break;case"bytes":r("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:r("d%s=m%s",n,n);break}}return r}cf.toObject=function(e){var t=e.fieldsArray.slice().sort(bt.compareFieldsById);if(!t.length)return bt.codegen()("return {}");for(var n=bt.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],a=[],o=0;o<t.length;++o)t[o].partOf||(t[o].resolve().repeated?i:t[o].map?s:a).push(t[o]);if(i.length){for(n("if(o.arrays||o.defaults){"),o=0;o<i.length;++o)n("d%s=[]",bt.safeProp(i[o].name));n("}")}if(s.length){for(n("if(o.objects||o.defaults){"),o=0;o<s.length;++o)n("d%s={}",bt.safeProp(s[o].name));n("}")}if(a.length){for(n("if(o.defaults){"),o=0;o<a.length;++o){var l=a[o],c=bt.safeProp(l.name);if(l.resolvedType instanceof Qn)n("d%s=o.enums===String?%j:%j",c,l.resolvedType.valuesById[l.typeDefault],l.typeDefault);else if(l.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,l.typeDefault.toString(),l.typeDefault.toNumber());else if(l.bytes){var u="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",c,u)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else n("d%s=%j",c,l.typeDefault)}n("}")}var d=!1;for(o=0;o<t.length;++o){var l=t[o],h=e._fieldsArray.indexOf(l),c=bt.safeProp(l.name);l.map?(d||(d=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),_l(n,l,h,c+"[ks2[j]]")("}")):l.repeated?(n("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),_l(n,l,h,c+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",c,l.name),_l(n,l,h,c),l.partOf&&n("if(o.oneofs)")("d%s=%j",bt.safeProp(l.partOf.name),l.name)),n("}")}return n("return d")}});var El=p(df=>{"use strict";var CS=df,TS=ds();CS[".google.protobuf.Any"]={fromObject:function(r){if(r&&r["@type"]){var e=r["@type"].substring(r["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var n=r["@type"].charAt(0)==="."?r["@type"].slice(1):r["@type"];return n.indexOf("/")===-1&&(n="/"+n),this.create({type_url:n,value:t.encode(t.fromObject(r)).finish()})}}return this.fromObject(r)},toObject:function(r,e){var t="type.googleapis.com/",n="",i="";if(e&&e.json&&r.type_url&&r.value){i=r.type_url.substring(r.type_url.lastIndexOf("/")+1),n=r.type_url.substring(0,r.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(r=s.decode(r.value))}if(!(r instanceof this.ctor)&&r instanceof TS){var a=r.$type.toObject(r,e),o=r.$type.fullName[0]==="."?r.$type.fullName.slice(1):r.$type.fullName;return n===""&&(n=t),i=n+o,a["@type"]=i,a}return this.toObject(r,e)}}});var ps=p((Nw,ff)=>{"use strict";ff.exports=G;var nt=on();((G.prototype=Object.create(nt.prototype)).constructor=G).className="Type";var RS=rt(),Tl=nn(),hs=Qt(),wS=ls(),OS=us(),bl=ds(),Cl=ns(),AS=ts(),he=ae(),NS=Rl(),kS=pl(),PS=vl(),hf=Sl(),IS=El();function G(r,e){nt.call(this,r,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(G.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var r=Object.keys(this.fields),e=0;e<r.length;++e){var t=this.fields[r[e]],n=t.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=he.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=he.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=G.generateConstructor(this)())},set:function(r){var e=r.prototype;e instanceof bl||((r.prototype=new bl).constructor=r,he.merge(r.prototype,e)),r.$type=r.prototype.$type=this,he.merge(r,bl,!0),this._ctor=r;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var n={};for(t=0;t<this.oneofsArray.length;++t)n[this._oneofsArray[t].resolve().name]={get:he.oneOfGetter(this._oneofsArray[t].oneof),set:he.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(r.prototype,n)}}});G.generateConstructor=function(e){for(var t=he.codegen(["p"],e.name),n=0,i;n<e.fieldsArray.length;++n)(i=e._fieldsArray[n]).map?t("this%s={}",he.safeProp(i.name)):i.repeated&&t("this%s=[]",he.safeProp(i.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function fs(r){return r._fieldsById=r._fieldsArray=r._oneofsArray=null,delete r.encode,delete r.decode,delete r.verify,r}G.fromJSON=function(e,t){var n=new G(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var i=Object.keys(t.fields),s=0;s<i.length;++s)n.add((typeof t.fields[i[s]].keyType!="undefined"?wS.fromJSON:hs.fromJSON)(i[s],t.fields[i[s]]));if(t.oneofs)for(i=Object.keys(t.oneofs),s=0;s<i.length;++s)n.add(Tl.fromJSON(i[s],t.oneofs[i[s]]));if(t.nested)for(i=Object.keys(t.nested),s=0;s<i.length;++s){var a=t.nested[i[s]];n.add((a.id!==void 0?hs.fromJSON:a.fields!==void 0?G.fromJSON:a.values!==void 0?RS.fromJSON:a.methods!==void 0?OS.fromJSON:nt.fromJSON)(i[s],a))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n};G.prototype.toJSON=function(e){var t=nt.prototype.toJSON.call(this,e),n=e?Boolean(e.keepComments):!1;return he.toObject(["options",t&&t.options||void 0,"oneofs",nt.arrayToJSON(this.oneofsArray,e),"fields",nt.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])};G.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return nt.prototype.resolveAll.call(this)};G.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};G.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof hs&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),fs(this)}return e instanceof Tl?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),fs(this)):nt.prototype.add.call(this,e)};G.prototype.remove=function(e){if(e instanceof hs&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),fs(this)}if(e instanceof Tl){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),fs(this)}return nt.prototype.remove.call(this,e)};G.prototype.isReservedId=function(e){return nt.isReservedId(this.reserved,e)};G.prototype.isReservedName=function(e){return nt.isReservedName(this.reserved,e)};G.prototype.create=function(e){return new this.ctor(e)};G.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=NS(this)({Writer:AS,types:t,util:he}),this.decode=kS(this)({Reader:Cl,types:t,util:he}),this.verify=PS(this)({types:t,util:he}),this.fromObject=hf.fromObject(this)({types:t,util:he}),this.toObject=hf.toObject(this)({types:t,util:he});var i=IS[e];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};G.prototype.encode=function(e,t){return this.setup().encode(e,t)};G.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};G.prototype.decode=function(e,t){return this.setup().decode(e,t)};G.prototype.decodeDelimited=function(e){return e instanceof Cl||(e=Cl.create(e)),this.decode(e,e.uint32())};G.prototype.verify=function(e){return this.setup().verify(e)};G.prototype.fromObject=function(e){return this.setup().fromObject(e)};G.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};G.d=function(e){return function(n){he.decorateType(n,e)}}});var vs=p((kw,yf)=>{"use strict";yf.exports=Ae;var ms=on();((Ae.prototype=Object.create(ms.prototype)).constructor=Ae).className="Root";var Ol=Qt(),gf=rt(),MS=nn(),er=ae(),mf,wl,Zn;function Ae(r){ms.call(this,"",r),this.deferred=[],this.files=[]}Ae.fromJSON=function(e,t){return t||(t=new Ae),e.options&&t.setOptions(e.options),t.addJSON(e.nested)};Ae.prototype.resolvePath=er.path.resolve;Ae.prototype.fetch=er.fetch;function vf(){}Ae.prototype.load=function r(e,t,n){typeof t=="function"&&(n=t,t=void 0);var i=this;if(!n)return er.asPromise(r,i,e,t);var s=n===vf;function a(f,g){if(!!n){var y=n;if(n=null,s)throw f;y(f,g)}}function o(f){var g=f.lastIndexOf("google/protobuf/");if(g>-1){var y=f.substring(g);if(y in Zn)return y}return null}function l(f,g){try{if(er.isString(g)&&g.charAt(0)==="{"&&(g=JSON.parse(g)),!er.isString(g))i.setOptions(g.options).addJSON(g.nested);else{wl.filename=f;var y=wl(g,i,t),_,T=0;if(y.imports)for(;T<y.imports.length;++T)(_=o(y.imports[T])||i.resolvePath(f,y.imports[T]))&&c(_);if(y.weakImports)for(T=0;T<y.weakImports.length;++T)(_=o(y.weakImports[T])||i.resolvePath(f,y.weakImports[T]))&&c(_,!0)}}catch(b){a(b)}!s&&!u&&a(null,i)}function c(f,g){if(!(i.files.indexOf(f)>-1)){if(i.files.push(f),f in Zn){s?l(f,Zn[f]):(++u,setTimeout(function(){--u,l(f,Zn[f])}));return}if(s){var y;try{y=er.fs.readFileSync(f).toString("utf8")}catch(_){g||a(_);return}l(f,y)}else++u,i.fetch(f,function(_,T){if(--u,!!n){if(_){g?u||a(null,i):a(_);return}l(f,T)}})}}var u=0;er.isString(e)&&(e=[e]);for(var d=0,h;d<e.length;++d)(h=i.resolvePath("",e[d]))&&c(h);if(s)return i;u||a(null,i)};Ae.prototype.loadSync=function(e,t){if(!er.isNode)throw Error("not supported");return this.load(e,t,vf)};Ae.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return ms.prototype.resolveAll.call(this)};var gs=/^[A-Z]/;function pf(r,e){var t=e.parent.lookup(e.extend);if(t){var n=new Ol(e.fullName,e.id,e.type,e.rule,void 0,e.options);return n.declaringField=e,e.extensionField=n,t.add(n),!0}return!1}Ae.prototype._handleAdd=function(e){if(e instanceof Ol)e.extend!==void 0&&!e.extensionField&&(pf(this,e)||this.deferred.push(e));else if(e instanceof gf)gs.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof MS)){if(e instanceof mf)for(var t=0;t<this.deferred.length;)pf(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);gs.test(e.name)&&(e.parent[e.name]=e)}};Ae.prototype._handleRemove=function(e){if(e instanceof Ol){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof gf)gs.test(e.name)&&delete e.parent[e.name];else if(e instanceof ms){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);gs.test(e.name)&&delete e.parent[e.name]}};Ae._configure=function(r,e,t){mf=r,wl=e,Zn=t}});var ae=p((Pw,Sf)=>{"use strict";var ee=Sf.exports=yt(),_f=il(),Al,Nl;ee.codegen=qh();ee.fetch=Bh();ee.path=jh();ee.fs=ee.inquire("fs");ee.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),i=0;i<t.length;)n[i]=e[t[i++]];return n}return[]};ee.toObject=function(e){for(var t={},n=0;n<e.length;){var i=e[n++],s=e[n++];s!==void 0&&(t[i]=s)}return t};var xS=/\\/g,DS=/"/g;ee.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};ee.safeProp=function(e){return!/^[$\w_]+$/.test(e)||ee.isReserved(e)?'["'+e.replace(xS,"\\\\").replace(DS,'\\"')+'"]':"."+e};ee.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var LS=/_([a-z])/g;ee.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(LS,function(t,n){return n.toUpperCase()})};ee.compareFieldsById=function(e,t){return e.id-t.id};ee.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(ee.decorateRoot.remove(e.$type),e.$type.name=t,ee.decorateRoot.add(e.$type)),e.$type;Al||(Al=ps());var n=new Al(t||e.name);return ee.decorateRoot.add(n),n.ctor=e,Object.defineProperty(e,"$type",{value:n,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:n,enumerable:!1}),n};var qS=0;ee.decorateEnum=function(e){if(e.$type)return e.$type;Nl||(Nl=rt());var t=new Nl("Enum"+qS++,e);return ee.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};ee.setProperty=function(e,t,n){function i(s,a,o){var l=a.shift();if(l==="__proto__")return s;if(a.length>0)s[l]=i(s[l]||{},a,o);else{var c=s[l];c&&(o=[].concat(c).concat(o)),s[l]=o}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),i(e,t,n)};Object.defineProperty(ee,"decorateRoot",{get:function(){return _f.decorated||(_f.decorated=new(vs()))}})});var Er=p((Iw,Ef)=>{"use strict";Ef.exports=Ne;Ne.className="ReflectionObject";var ys=ae(),_s;function Ne(r,e){if(!ys.isString(r))throw TypeError("name must be a string");if(e&&!ys.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=r,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(Ne.prototype,{root:{get:function(){for(var r=this;r.parent!==null;)r=r.parent;return r}},fullName:{get:function(){for(var r=[this.name],e=this.parent;e;)r.unshift(e.name),e=e.parent;return r.join(".")}}});Ne.prototype.toJSON=function(){throw Error()};Ne.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof _s&&t._handleAdd(this)};Ne.prototype.onRemove=function(e){var t=e.root;t instanceof _s&&t._handleRemove(this),this.parent=null,this.resolved=!1};Ne.prototype.resolve=function(){return this.resolved?this:(this.root instanceof _s&&(this.resolved=!0),this)};Ne.prototype.getOption=function(e){if(this.options)return this.options[e]};Ne.prototype.setOption=function(e,t,n){return(!n||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=t),this};Ne.prototype.setParsedOption=function(e,t,n){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(n){var s=i.find(function(l){return Object.prototype.hasOwnProperty.call(l,e)});if(s){var a=s[e];ys.setProperty(a,n,t)}else s={},s[e]=ys.setProperty({},n,t),i.push(s)}else{var o={};o[e]=t,i.push(o)}return this};Ne.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),i=0;i<n.length;++i)this.setOption(n[i],e[n[i]],t);return this};Ne.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};Ne._configure=function(r){_s=r}});var rt=p((Mw,Tf)=>{"use strict";Tf.exports=Ct;var bf=Er();((Ct.prototype=Object.create(bf.prototype)).constructor=Ct).className="Enum";var Cf=on(),Ss=ae();function Ct(r,e,t,n,i,s){if(bf.call(this,r,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=n,this.comments=i||{},this.valuesOptions=s,this.reserved=void 0,e)for(var a=Object.keys(e),o=0;o<a.length;++o)typeof e[a[o]]=="number"&&(this.valuesById[this.values[a[o]]=e[a[o]]]=a[o])}Ct.fromJSON=function(e,t){var n=new Ct(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n};Ct.prototype.toJSON=function(e){var t=e?Boolean(e.keepComments):!1;return Ss.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};Ct.prototype.add=function(e,t,n,i){if(!Ss.isString(e))throw TypeError("name must be a string");if(!Ss.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return i&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=i||null),this.comments[e]=n||null,this};Ct.prototype.remove=function(e){if(!Ss.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};Ct.prototype.isReservedId=function(e){return Cf.isReservedId(this.reserved,e)};Ct.prototype.isReservedName=function(e){return Cf.isReservedName(this.reserved,e)}});var Rl=p((xw,wf)=>{"use strict";wf.exports=BS;var FS=rt(),kl=Sr(),Pl=ae();function Rf(r,e,t,n){return e.resolvedType.group?r("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,n,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):r("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,n,(e.id<<3|2)>>>0)}function BS(r){for(var e=Pl.codegen(["m","w"],r.name+"$encode")("if(!w)")("w=Writer.create()"),t,n,i=r.fieldsArray.slice().sort(Pl.compareFieldsById),t=0;t<i.length;++t){var s=i[t].resolve(),a=r._fieldsArray.indexOf(s),o=s.resolvedType instanceof FS?"int32":s.type,l=kl.basic[o];n="m"+Pl.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",n,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",n)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|kl.mapKey[s.keyType],s.keyType),l===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",a,n):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|l,o,n),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",n,n),s.packed&&kl.packed[o]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",n)("w.%s(%s[i])",o,n)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",n),l===void 0?Rf(e,s,a,n+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|l)>>>0,o,n)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",n,s.name),l===void 0?Rf(e,s,a,n):e("w.uint32(%i).%s(%s)",(s.id<<3|l)>>>0,o,n))}return e("return w")}});var Af=p((Dw,Of)=>{"use strict";var L=Of.exports=Dh();L.build="light";function US(r,e,t){return typeof e=="function"?(t=e,e=new L.Root):e||(e=new L.Root),e.load(r,t)}L.load=US;function zS(r,e){return e||(e=new L.Root),e.loadSync(r)}L.loadSync=zS;L.encoder=Rl();L.decoder=pl();L.verifier=vl();L.converter=Sl();L.ReflectionObject=Er();L.Namespace=on();L.Root=vs();L.Enum=rt();L.Type=ps();L.Field=Qt();L.OneOf=nn();L.MapField=ls();L.Service=us();L.Method=cs();L.Message=ds();L.wrappers=El();L.types=Sr();L.util=ae();L.ReflectionObject._configure(L.Root);L.Namespace._configure(L.Type,L.Service,L.Enum);L.Root._configure(L.Type);L.Field._configure(L.Type)});var Ml=p((Lw,Pf)=>{"use strict";Pf.exports=kf;var Il=/[\s{}=;:[\],'"()<>]/g,jS=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,HS=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,$S=/^ *[*/]+ */,GS=/^\s*\*?\/*/,WS=/\n/g,VS=/\s/,JS=/\\(.?)/g,YS={0:"\0",r:"\r",n:`
`,t:"	"};function Nf(r){return r.replace(JS,function(e,t){switch(t){case"\\":case"":return t;default:return YS[t]||""}})}kf.unescape=Nf;function kf(r,e){r=r.toString();var t=0,n=r.length,i=1,s=0,a={},o=[],l=null;function c(N){return Error("illegal "+N+" (line "+i+")")}function u(){var N=l==="'"?HS:jS;N.lastIndex=t-1;var z=N.exec(r);if(!z)throw c("string");return t=N.lastIndex,_(l),l=null,Nf(z[1])}function d(N){return r.charAt(N)}function h(N,z,M){var j={type:r.charAt(N++),lineEmpty:!1,leading:M},oe;e?oe=2:oe=3;var Re=N-oe,Je;do if(--Re<0||(Je=r.charAt(Re))===`
`){j.lineEmpty=!0;break}while(Je===" "||Je==="	");for(var lt=r.substring(N,z).split(WS),te=0;te<lt.length;++te)lt[te]=lt[te].replace(e?GS:$S,"").trim();j.text=lt.join(`
`).trim(),a[i]=j,s=i}function f(N){var z=g(N),M=r.substring(N,z),j=/^\s*\/{1,2}/.test(M);return j}function g(N){for(var z=N;z<n&&d(z)!==`
`;)z++;return z}function y(){if(o.length>0)return o.shift();if(l)return u();var N,z,M,j,oe,Re=t===0;do{if(t===n)return null;for(N=!1;VS.test(M=d(t));)if(M===`
`&&(Re=!0,++i),++t===n)return null;if(d(t)==="/"){if(++t===n)throw c("comment");if(d(t)==="/")if(e){if(j=t,oe=!1,f(t)){oe=!0;do if(t=g(t),t===n||(t++,!Re))break;while(f(t))}else t=Math.min(n,g(t)+1);oe&&(h(j,t,Re),Re=!0),i++,N=!0}else{for(oe=d(j=t+1)==="/";d(++t)!==`
`;)if(t===n)return null;++t,oe&&(h(j,t-1,Re),Re=!0),++i,N=!0}else if((M=d(t))==="*"){j=t+1,oe=e||d(j)==="*";do{if(M===`
`&&++i,++t===n)throw c("comment");z=M,M=d(t)}while(z!=="*"||M!=="/");++t,oe&&(h(j,t-2,Re),Re=!0),N=!0}else return"/"}}while(N);var Je=t;Il.lastIndex=0;var lt=Il.test(d(Je++));if(!lt)for(;Je<n&&!Il.test(d(Je));)++Je;var te=r.substring(t,t=Je);return(te==='"'||te==="'")&&(l=te),te}function _(N){o.push(N)}function T(){if(!o.length){var N=y();if(N===null)return null;_(N)}return o[0]}function b(N,z){var M=T(),j=M===N;if(j)return y(),!0;if(!z)throw c("token '"+M+"', '"+N+"' expected");return!1}function B(N){var z=null,M;return N===void 0?(M=a[i-1],delete a[i-1],M&&(e||M.type==="*"||M.lineEmpty)&&(z=M.leading?M.text:null)):(s<N&&T(),M=a[N],delete a[N],M&&!M.lineEmpty&&(e||M.type==="/")&&(z=M.leading?null:M.text)),z}return Object.defineProperty({next:y,peek:T,push:_,skip:b,cmnt:B},"line",{get:function(){return i}})}});var qf=p((qw,Lf)=>{"use strict";Lf.exports=Mt;Mt.filename=null;Mt.defaults={keepCase:!1};var KS=Ml(),If=vs(),Mf=ps(),xf=Qt(),XS=ls(),Df=nn(),QS=rt(),ZS=us(),eE=cs(),xl=Sr(),Dl=ae(),tE=/^[1-9][0-9]*$/,rE=/^-?[1-9][0-9]*$/,nE=/^0[x][0-9a-fA-F]+$/,iE=/^-?0[x][0-9a-fA-F]+$/,sE=/^0[0-7]+$/,aE=/^-?0[0-7]+$/,oE=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,Tt=/^[a-zA-Z_][a-zA-Z_0-9]*$/,Rt=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,lE=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function Mt(r,e,t){e instanceof If||(t=e,e=new If),t||(t=Mt.defaults);var n=t.preferTrailingComment||!1,i=KS(r,t.alternateCommentMode||!1),s=i.next,a=i.push,o=i.peek,l=i.skip,c=i.cmnt,u=!0,d,h,f,g,y=!1,_=e,T=t.keepCase?function(m){return m}:Dl.camelCase;function b(m,v,S){var A=Mt.filename;return S||(Mt.filename=null),Error("illegal "+(v||"token")+" '"+m+"' ("+(A?A+", ":"")+"line "+i.line+")")}function B(){var m=[],v;do{if((v=s())!=='"'&&v!=="'")throw b(v);m.push(s()),l(v),v=o()}while(v==='"'||v==="'");return m.join("")}function N(m){var v=s();switch(v){case"'":case'"':return a(v),B();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return M(v,!0)}catch(S){if(m&&Rt.test(v))return v;throw b(v,"value")}}function z(m,v){var S,A;do v&&((S=o())==='"'||S==="'")?m.push(B()):m.push([A=j(s()),l("to",!0)?j(s()):A]);while(l(",",!0));l(";")}function M(m,v){var S=1;switch(m.charAt(0)==="-"&&(S=-1,m=m.substring(1)),m){case"inf":case"INF":case"Inf":return S*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(tE.test(m))return S*parseInt(m,10);if(nE.test(m))return S*parseInt(m,16);if(sE.test(m))return S*parseInt(m,8);if(oE.test(m))return S*parseFloat(m);throw b(m,"number",v)}function j(m,v){switch(m){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!v&&m.charAt(0)==="-")throw b(m,"id");if(rE.test(m))return parseInt(m,10);if(iE.test(m))return parseInt(m,16);if(aE.test(m))return parseInt(m,8);throw b(m,"id")}function oe(){if(d!==void 0)throw b("package");if(d=s(),!Rt.test(d))throw b(d,"name");_=_.define(d),l(";")}function Re(){var m=o(),v;switch(m){case"weak":v=f||(f=[]),s();break;case"public":s();default:v=h||(h=[]);break}m=B(),l(";"),v.push(m)}function Je(){if(l("="),g=B(),y=g==="proto3",!y&&g!=="proto2")throw b(g,"syntax");l(";")}function lt(m,v){switch(v){case"option":return ct(m,v),l(";"),!0;case"message":return Vc(m,v),!0;case"enum":return Jc(m,v),!0;case"service":return Ig(m,v),!0;case"extend":return xg(m,v),!0}return!1}function te(m,v,S){var A=i.line;if(m&&(typeof m.comment!="string"&&(m.comment=c()),m.filename=Mt.filename),l("{",!0)){for(var O;(O=s())!=="}";)v(O);l(";",!0)}else S&&S(),l(";"),m&&(typeof m.comment!="string"||n)&&(m.comment=c(A)||m.comment)}function Vc(m,v){if(!Tt.test(v=s()))throw b(v,"type name");var S=new Mf(v);te(S,function(O){if(!lt(S,O))switch(O){case"map":Ag(S,O);break;case"required":case"repeated":Pe(S,O);break;case"optional":y?Pe(S,"proto3_optional"):Pe(S,"optional");break;case"oneof":Ng(S,O);break;case"extensions":z(S.extensions||(S.extensions=[]));break;case"reserved":z(S.reserved||(S.reserved=[]),!0);break;default:if(!y||!Rt.test(O))throw b(O);a(O),Pe(S,"optional");break}}),m.add(S)}function Pe(m,v,S){var A=s();if(A==="group"){Og(m,v);return}if(!Rt.test(A))throw b(A,"type");var O=s();if(!Tt.test(O))throw b(O,"name");O=T(O),l("=");var x=new xf(O,j(s()),A,v,S);if(te(x,function(we){if(we==="option")ct(x,we),l(";");else throw b(we)},function(){fa(x)}),v==="proto3_optional"){var le=new Df("_"+O);x.setOption("proto3_optional",!0),le.add(x),m.add(le)}else m.add(x);!y&&x.repeated&&(xl.packed[A]!==void 0||xl.basic[A]===void 0)&&x.setOption("packed",!1,!0)}function Og(m,v){var S=s();if(!Tt.test(S))throw b(S,"name");var A=Dl.lcFirst(S);S===A&&(S=Dl.ucFirst(S)),l("=");var O=j(s()),x=new Mf(S);x.group=!0;var le=new xf(A,O,S,v);le.filename=Mt.filename,te(x,function(we){switch(we){case"option":ct(x,we),l(";");break;case"required":case"repeated":Pe(x,we);break;case"optional":y?Pe(x,"proto3_optional"):Pe(x,"optional");break;case"message":Vc(x,we);break;case"enum":Jc(x,we);break;default:throw b(we)}}),m.add(x).add(le)}function Ag(m){l("<");var v=s();if(xl.mapKey[v]===void 0)throw b(v,"type");l(",");var S=s();if(!Rt.test(S))throw b(S,"type");l(">");var A=s();if(!Tt.test(A))throw b(A,"name");l("=");var O=new XS(T(A),j(s()),v,S);te(O,function(le){if(le==="option")ct(O,le),l(";");else throw b(le)},function(){fa(O)}),m.add(O)}function Ng(m,v){if(!Tt.test(v=s()))throw b(v,"name");var S=new Df(T(v));te(S,function(O){O==="option"?(ct(S,O),l(";")):(a(O),Pe(S,"optional"))}),m.add(S)}function Jc(m,v){if(!Tt.test(v=s()))throw b(v,"name");var S=new QS(v);te(S,function(O){switch(O){case"option":ct(S,O),l(";");break;case"reserved":z(S.reserved||(S.reserved=[]),!0);break;default:kg(S,O)}}),m.add(S)}function kg(m,v){if(!Tt.test(v))throw b(v,"name");l("=");var S=j(s(),!0),A={options:void 0};A.setOption=function(O,x){this.options===void 0&&(this.options={}),this.options[O]=x},te(A,function(x){if(x==="option")ct(A,x),l(";");else throw b(x)},function(){fa(A)}),m.add(v,S,A.comment,A.options)}function ct(m,v){var S=l("(",!0);if(!Rt.test(v=s()))throw b(v,"name");var A=v,O=A,x;S&&(l(")"),A="("+A+")",O=A,v=o(),lE.test(v)&&(x=v.slice(1),A+=v,s())),l("=");var le=Yc(m,A);Pg(m,O,le,x)}function Yc(m,v){if(l("{",!0)){for(var S={};!l("}",!0);){if(!Tt.test(ye=s()))throw b(ye,"name");var A,O=ye;if(l(":",!0),o()==="{")A=Yc(m,v+"."+ye);else if(o()==="["){A=[];var x;if(l("[",!0)){do x=N(!0),A.push(x);while(l(",",!0));l("]"),typeof x!="undefined"&&ha(m,v+"."+ye,x)}}else A=N(!0),ha(m,v+"."+ye,A);var le=S[O];le&&(A=[].concat(le).concat(A)),S[O]=A,l(",",!0),l(";",!0)}return S}var Ft=N(!0);return ha(m,v,Ft),Ft}function ha(m,v,S){m.setOption&&m.setOption(v,S)}function Pg(m,v,S,A){m.setParsedOption&&m.setParsedOption(v,S,A)}function fa(m){if(l("[",!0)){do ct(m,"option");while(l(",",!0));l("]")}return m}function Ig(m,v){if(!Tt.test(v=s()))throw b(v,"service name");var S=new ZS(v);te(S,function(O){if(!lt(S,O))if(O==="rpc")Mg(S,O);else throw b(O)}),m.add(S)}function Mg(m,v){var S=c(),A=v;if(!Tt.test(v=s()))throw b(v,"name");var O=v,x,le,Ft,we;if(l("("),l("stream",!0)&&(le=!0),!Rt.test(v=s())||(x=v,l(")"),l("returns"),l("("),l("stream",!0)&&(we=!0),!Rt.test(v=s())))throw b(v);Ft=v,l(")");var gi=new eE(O,A,x,Ft,le,we);gi.comment=S,te(gi,function(pa){if(pa==="option")ct(gi,pa),l(";");else throw b(pa)}),m.add(gi)}function xg(m,v){if(!Rt.test(v=s()))throw b(v,"reference");var S=v;te(null,function(O){switch(O){case"required":case"repeated":Pe(m,O,S);break;case"optional":y?Pe(m,"proto3_optional",S):Pe(m,"optional",S);break;default:if(!y||!Rt.test(O))throw b(O);a(O),Pe(m,"optional",S);break}})}for(var ye;(ye=s())!==null;)switch(ye){case"package":if(!u)throw b(ye);oe();break;case"import":if(!u)throw b(ye);Re();break;case"syntax":if(!u)throw b(ye);Je();break;case"option":ct(_,ye),l(";");break;default:if(lt(_,ye)){u=!1;continue}throw b(ye)}return Mt.filename=null,{package:d,imports:h,weakImports:f,syntax:g,root:e}}});var Uf=p((Fw,Bf)=>{"use strict";Bf.exports=it;var cE=/\/|\./;function it(r,e){cE.test(r)||(r="google/protobuf/"+r+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),it[r]=e}it("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var Ff;it("duration",{Duration:Ff={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});it("timestamp",{Timestamp:Ff});it("empty",{Empty:{fields:{}}});it("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});it("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});it("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});it.get=function(e){return it[e]||null}});var jf=p((Bw,zf)=>{"use strict";var tr=zf.exports=Af();tr.build="full";tr.tokenize=Ml();tr.parse=qf();tr.common=Uf();tr.Root._configure(tr.Type,tr.parse,tr.common)});var Es=p((Uw,Hf)=>{"use strict";Hf.exports=jf()});var Ll=p((zw,uE)=>{uE.exports={nested:{google:{nested:{protobuf:{nested:{FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}}}}}}}}});var Jf=p((P,Vf)=>{"use strict";var ve=Es();Vf.exports=P=ve.descriptor=ve.Root.fromJSON(Ll()).lookup(".google.protobuf");var $f=ve.Namespace,ei=ve.Root,xt=ve.Enum,rr=ve.Type,nr=ve.Field,dE=ve.MapField,bs=ve.OneOf,ti=ve.Service,Cs=ve.Method;ei.fromDescriptor=function(e){typeof e.length=="number"&&(e=P.FileDescriptorSet.decode(e));var t=new ei;if(e.file)for(var n,i,s=0,a;s<e.file.length;++s){if(i=t,(n=e.file[s]).package&&n.package.length&&(i=t.define(n.package)),n.name&&n.name.length&&t.files.push(i.filename=n.name),n.messageType)for(a=0;a<n.messageType.length;++a)i.add(rr.fromDescriptor(n.messageType[a],n.syntax));if(n.enumType)for(a=0;a<n.enumType.length;++a)i.add(xt.fromDescriptor(n.enumType[a]));if(n.extension)for(a=0;a<n.extension.length;++a)i.add(nr.fromDescriptor(n.extension[a]));if(n.service)for(a=0;a<n.service.length;++a)i.add(ti.fromDescriptor(n.service[a]));var o=cn(n.options,P.FileOptions);if(o){var l=Object.keys(o);for(a=0;a<l.length;++a)i.setOption(l[a],o[l[a]])}}return t};ei.prototype.toDescriptor=function(e){var t=P.FileDescriptorSet.create();return Gf(this,t.file,e),t};function Gf(r,e,t){var n=P.FileDescriptorProto.create({name:r.filename||(r.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});t&&(n.syntax=t),r instanceof ei||(n.package=r.fullName.substring(1));for(var i=0,s;i<r.nestedArray.length;++i)(s=r._nestedArray[i])instanceof rr?n.messageType.push(s.toDescriptor(t)):s instanceof xt?n.enumType.push(s.toDescriptor()):s instanceof nr?n.extension.push(s.toDescriptor(t)):s instanceof ti?n.service.push(s.toDescriptor()):s instanceof $f&&Gf(s,e,t);n.options=un(r.options,P.FileOptions),n.messageType.length+n.enumType.length+n.extension.length+n.service.length&&e.push(n)}var hE=0;rr.fromDescriptor=function(e,t){typeof e.length=="number"&&(e=P.DescriptorProto.decode(e));var n=new rr(e.name.length?e.name:"Type"+hE++,cn(e.options,P.MessageOptions)),i;if(e.oneofDecl)for(i=0;i<e.oneofDecl.length;++i)n.add(bs.fromDescriptor(e.oneofDecl[i]));if(e.field)for(i=0;i<e.field.length;++i){var s=nr.fromDescriptor(e.field[i],t);n.add(s),e.field[i].hasOwnProperty("oneofIndex")&&n.oneofsArray[e.field[i].oneofIndex].add(s)}if(e.extension)for(i=0;i<e.extension.length;++i)n.add(nr.fromDescriptor(e.extension[i],t));if(e.nestedType)for(i=0;i<e.nestedType.length;++i)n.add(rr.fromDescriptor(e.nestedType[i],t)),e.nestedType[i].options&&e.nestedType[i].options.mapEntry&&n.setOption("map_entry",!0);if(e.enumType)for(i=0;i<e.enumType.length;++i)n.add(xt.fromDescriptor(e.enumType[i]));if(e.extensionRange&&e.extensionRange.length)for(n.extensions=[],i=0;i<e.extensionRange.length;++i)n.extensions.push([e.extensionRange[i].start,e.extensionRange[i].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(n.reserved=[],e.reservedRange)for(i=0;i<e.reservedRange.length;++i)n.reserved.push([e.reservedRange[i].start,e.reservedRange[i].end]);if(e.reservedName)for(i=0;i<e.reservedName.length;++i)n.reserved.push(e.reservedName[i])}return n};rr.prototype.toDescriptor=function(e){var t=P.DescriptorProto.create({name:this.name}),n;for(n=0;n<this.fieldsArray.length;++n){var i;if(t.field.push(i=this._fieldsArray[n].toDescriptor(e)),this._fieldsArray[n]instanceof dE){var s=ql(this._fieldsArray[n].keyType,this._fieldsArray[n].resolvedKeyType),a=ql(this._fieldsArray[n].type,this._fieldsArray[n].resolvedType),o=a===11||a===14?this._fieldsArray[n].resolvedType&&Wf(this.parent,this._fieldsArray[n].resolvedType)||this._fieldsArray[n].type:void 0;t.nestedType.push(P.DescriptorProto.create({name:i.typeName,field:[P.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),P.FieldDescriptorProto.create({name:"value",number:2,label:1,type:a,typeName:o})],options:P.MessageOptions.create({mapEntry:!0})}))}}for(n=0;n<this.oneofsArray.length;++n)t.oneofDecl.push(this._oneofsArray[n].toDescriptor());for(n=0;n<this.nestedArray.length;++n)this._nestedArray[n]instanceof nr?t.field.push(this._nestedArray[n].toDescriptor(e)):this._nestedArray[n]instanceof rr?t.nestedType.push(this._nestedArray[n].toDescriptor(e)):this._nestedArray[n]instanceof xt&&t.enumType.push(this._nestedArray[n].toDescriptor());if(this.extensions)for(n=0;n<this.extensions.length;++n)t.extensionRange.push(P.DescriptorProto.ExtensionRange.create({start:this.extensions[n][0],end:this.extensions[n][1]}));if(this.reserved)for(n=0;n<this.reserved.length;++n)typeof this.reserved[n]=="string"?t.reservedName.push(this.reserved[n]):t.reservedRange.push(P.DescriptorProto.ReservedRange.create({start:this.reserved[n][0],end:this.reserved[n][1]}));return t.options=un(this.options,P.MessageOptions),t};var fE=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;nr.fromDescriptor=function(e,t){if(typeof e.length=="number"&&(e=P.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var n;e.typeName&&e.typeName.length?n=e.typeName:n=yE(e.type);var i;switch(e.label){case 1:i=void 0;break;case 2:i="required";break;case 3:i="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;e.extendee!==void 0&&(s=s.length?s:void 0);var a=new nr(e.name.length?e.name:"field"+e.number,e.number,n,i,s);if(a.options=cn(e.options,P.FieldOptions),e.defaultValue&&e.defaultValue.length){var o=e.defaultValue;switch(o){case"true":case"TRUE":o=!0;break;case"false":case"FALSE":o=!1;break;default:var l=fE.exec(o);l&&(o=parseInt(o));break}a.setOption("default",o)}return _E(e.type)&&(t==="proto3"?e.options&&!e.options.packed&&a.setOption("packed",!1):e.options&&e.options.packed||a.setOption("packed",!1)),a};nr.prototype.toDescriptor=function(e){var t=P.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)t.type=11,t.typeName=ve.util.ucFirst(this.name),t.label=3;else{switch(t.type=ql(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:t.typeName=this.resolvedType?Wf(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":t.label=3;break;case"required":t.label=2;break;default:t.label=1;break}}if(t.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(t.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(t.options=un(this.options,P.FieldOptions),this.options.default!=null&&(t.defaultValue=String(this.options.default))),e==="proto3"?this.packed||((t.options||(t.options=P.FieldOptions.create())).packed=!1):this.packed&&((t.options||(t.options=P.FieldOptions.create())).packed=!0),t};var pE=0;xt.fromDescriptor=function(e){typeof e.length=="number"&&(e=P.EnumDescriptorProto.decode(e));var t={};if(e.value)for(var n=0;n<e.value.length;++n){var i=e.value[n].name,s=e.value[n].number||0;t[i&&i.length?i:"NAME"+s]=s}return new xt(e.name&&e.name.length?e.name:"Enum"+pE++,t,cn(e.options,P.EnumOptions))};xt.prototype.toDescriptor=function(){for(var e=[],t=0,n=Object.keys(this.values);t<n.length;++t)e.push(P.EnumValueDescriptorProto.create({name:n[t],number:this.values[n[t]]}));return P.EnumDescriptorProto.create({name:this.name,value:e,options:un(this.options,P.EnumOptions)})};var gE=0;bs.fromDescriptor=function(e){return typeof e.length=="number"&&(e=P.OneofDescriptorProto.decode(e)),new bs(e.name&&e.name.length?e.name:"oneof"+gE++)};bs.prototype.toDescriptor=function(){return P.OneofDescriptorProto.create({name:this.name})};var mE=0;ti.fromDescriptor=function(e){typeof e.length=="number"&&(e=P.ServiceDescriptorProto.decode(e));var t=new ti(e.name&&e.name.length?e.name:"Service"+mE++,cn(e.options,P.ServiceOptions));if(e.method)for(var n=0;n<e.method.length;++n)t.add(Cs.fromDescriptor(e.method[n]));return t};ti.prototype.toDescriptor=function(){for(var e=[],t=0;t<this.methodsArray.length;++t)e.push(this._methodsArray[t].toDescriptor());return P.ServiceDescriptorProto.create({name:this.name,method:e,options:un(this.options,P.ServiceOptions)})};var vE=0;Cs.fromDescriptor=function(e){return typeof e.length=="number"&&(e=P.MethodDescriptorProto.decode(e)),new Cs(e.name&&e.name.length?e.name:"Method"+vE++,"rpc",e.inputType,e.outputType,Boolean(e.clientStreaming),Boolean(e.serverStreaming),cn(e.options,P.MethodOptions))};Cs.prototype.toDescriptor=function(){return P.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:un(this.options,P.MethodOptions)})};function yE(r){switch(r){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+r)}function _E(r){switch(r){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function ql(r,e){switch(r){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof xt)return 14;if(e instanceof rr)return e.group?10:11;throw Error("illegal type: "+r)}function cn(r,e){if(!!r){for(var t=[],n=0,i,s,a;n<e.fieldsArray.length;++n)(s=(i=e._fieldsArray[n]).name)!=="uninterpretedOption"&&r.hasOwnProperty(s)&&(a=r[s],i.resolvedType instanceof xt&&typeof a=="number"&&i.resolvedType.valuesById[a]!==void 0&&(a=i.resolvedType.valuesById[a]),t.push(SE(s),a));return t.length?ve.util.toObject(t):void 0}}function un(r,e){if(!!r){for(var t=[],n=0,i=Object.keys(r),s,a;n<i.length;++n)if(a=r[s=i[n]],s!=="default"){var o=e.fields[s];!o&&!(o=e.fields[s=ve.util.camelCase(s)])||t.push(s,a)}return t.length?e.fromObject(ve.util.toObject(t)):void 0}}function Wf(r,e){var t=r.fullName.split("."),n=e.fullName.split("."),i=0,s=0,a=n.length-1;if(!(r instanceof ei)&&e instanceof $f)for(;i<t.length&&s<a&&t[i]===n[s];){var o=e.lookup(t[i++],!0);if(o!==null&&o!==e)break;++s}else for(;i<t.length&&s<a&&t[i]===n[s];++i,++s);return n.slice(s).join(".")}function SE(r){return r.substring(0,1)+r.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}});var Yf=p((jw,EE)=>{EE.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var Kf=p((Hw,bE)=>{bE.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var Xf=p(($w,CE)=>{CE.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var tp=p(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});ir.addCommonProtos=ir.loadProtosWithOptionsSync=ir.loadProtosWithOptions=void 0;var Qf=require("fs"),Zf=require("path"),dn=Es();function ep(r,e){let t=r.resolvePath;r.resolvePath=(n,i)=>{if(Zf.isAbsolute(i))return i;for(let s of e){let a=Zf.join(s,i);try{return Qf.accessSync(a,Qf.constants.R_OK),a}catch(o){continue}}return process.emitWarning(`${i} not found in any of the include paths ${e}`),t(n,i)}}function TE(r,e){return q(this,null,function*(){let t=new dn.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));ep(t,e.includeDirs)}let n=yield t.load(r,e);return n.resolveAll(),n})}ir.loadProtosWithOptions=TE;function RE(r,e){let t=new dn.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");ep(t,e.includeDirs)}let n=t.loadSync(r,e);return n.resolveAll(),n}ir.loadProtosWithOptionsSync=RE;function wE(){let r=Yf(),e=Ll(),t=Kf(),n=Xf();dn.common("api",r.nested.google.nested.protobuf.nested),dn.common("descriptor",e.nested.google.nested.protobuf.nested),dn.common("source_context",t.nested.google.nested.protobuf.nested),dn.common("type",n.nested.google.nested.protobuf.nested)}ir.addCommonProtos=wE});var hp=p((Ww,dp)=>{dp.exports=W;var $e=null;try{$e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(r){}function W(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}W.prototype.__isLong__;Object.defineProperty(W.prototype,"__isLong__",{value:!0});function Ce(r){return(r&&r.__isLong__)===!0}W.isLong=Ce;var rp={},np={};function Tr(r,e){var t,n,i;return e?(r>>>=0,(i=0<=r&&r<256)&&(n=np[r],n)?n:(t=V(r,(r|0)<0?-1:0,!0),i&&(np[r]=t),t)):(r|=0,(i=-128<=r&&r<128)&&(n=rp[r],n)?n:(t=V(r,r<0?-1:0,!1),i&&(rp[r]=t),t))}W.fromInt=Tr;function Ge(r,e){if(isNaN(r))return e?Cr:We;if(e){if(r<0)return Cr;if(r>=op)return up}else{if(r<=-sp)return be;if(r+1>=sp)return cp}return r<0?Ge(-r,e).neg():V(r%fn|0,r/fn|0,e)}W.fromNumber=Ge;function V(r,e,t){return new W(r,e,t)}W.fromBits=V;var Ts=Math.pow;function Bl(r,e,t){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return We;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return Bl(r.substring(1),e,t).neg();for(var i=Ge(Ts(t,8)),s=We,a=0;a<r.length;a+=8){var o=Math.min(8,r.length-a),l=parseInt(r.substring(a,a+o),t);if(o<8){var c=Ge(Ts(t,o));s=s.mul(c).add(Ge(l))}else s=s.mul(i),s=s.add(Ge(l))}return s.unsigned=e,s}W.fromString=Bl;function st(r,e){return typeof r=="number"?Ge(r,e):typeof r=="string"?Bl(r,e):V(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}W.fromValue=st;var ip=1<<16,OE=1<<24,fn=ip*ip,op=fn*fn,sp=op/2,ap=Tr(OE),We=Tr(0);W.ZERO=We;var Cr=Tr(0,!0);W.UZERO=Cr;var hn=Tr(1);W.ONE=hn;var lp=Tr(1,!0);W.UONE=lp;var Fl=Tr(-1);W.NEG_ONE=Fl;var cp=V(-1,2147483647,!1);W.MAX_VALUE=cp;var up=V(-1,-1,!0);W.MAX_UNSIGNED_VALUE=up;var be=V(0,-2147483648,!1);W.MIN_VALUE=be;var E=W.prototype;E.toInt=function(){return this.unsigned?this.low>>>0:this.low};E.toNumber=function(){return this.unsigned?(this.high>>>0)*fn+(this.low>>>0):this.high*fn+(this.low>>>0)};E.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(be)){var t=Ge(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Ge(Ts(e,6),this.unsigned),a=this,o="";;){var l=a.div(s),c=a.sub(l.mul(s)).toInt()>>>0,u=c.toString(e);if(a=l,a.isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}};E.getHighBits=function(){return this.high};E.getHighBitsUnsigned=function(){return this.high>>>0};E.getLowBits=function(){return this.low};E.getLowBitsUnsigned=function(){return this.low>>>0};E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(be)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};E.isZero=function(){return this.high===0&&this.low===0};E.eqz=E.isZero;E.isNegative=function(){return!this.unsigned&&this.high<0};E.isPositive=function(){return this.unsigned||this.high>=0};E.isOdd=function(){return(this.low&1)===1};E.isEven=function(){return(this.low&1)===0};E.equals=function(e){return Ce(e)||(e=st(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};E.eq=E.equals;E.notEquals=function(e){return!this.eq(e)};E.neq=E.notEquals;E.ne=E.notEquals;E.lessThan=function(e){return this.comp(e)<0};E.lt=E.lessThan;E.lessThanOrEqual=function(e){return this.comp(e)<=0};E.lte=E.lessThanOrEqual;E.le=E.lessThanOrEqual;E.greaterThan=function(e){return this.comp(e)>0};E.gt=E.greaterThan;E.greaterThanOrEqual=function(e){return this.comp(e)>=0};E.gte=E.greaterThanOrEqual;E.ge=E.greaterThanOrEqual;E.compare=function(e){if(Ce(e)||(e=st(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};E.comp=E.compare;E.negate=function(){return!this.unsigned&&this.eq(be)?be:this.not().add(hn)};E.neg=E.negate;E.add=function(e){Ce(e)||(e=st(e));var t=this.high>>>16,n=this.high&65535,i=this.low>>>16,s=this.low&65535,a=e.high>>>16,o=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=s+c,h+=f>>>16,f&=65535,h+=i+l,d+=h>>>16,h&=65535,d+=n+o,u+=d>>>16,d&=65535,u+=t+a,u&=65535,V(h<<16|f,u<<16|d,this.unsigned)};E.subtract=function(e){return Ce(e)||(e=st(e)),this.add(e.neg())};E.sub=E.subtract;E.multiply=function(e){if(this.isZero())return We;if(Ce(e)||(e=st(e)),$e){var t=$e.mul(this.low,this.high,e.low,e.high);return V(t,$e.get_high(),this.unsigned)}if(e.isZero())return We;if(this.eq(be))return e.isOdd()?be:We;if(e.eq(be))return this.isOdd()?be:We;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(ap)&&e.lt(ap))return Ge(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,i=this.high&65535,s=this.low>>>16,a=this.low&65535,o=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,g=0;return g+=a*u,f+=g>>>16,g&=65535,f+=s*u,h+=f>>>16,f&=65535,f+=a*c,h+=f>>>16,f&=65535,h+=i*u,d+=h>>>16,h&=65535,h+=s*c,d+=h>>>16,h&=65535,h+=a*l,d+=h>>>16,h&=65535,d+=n*u+i*c+s*l+a*o,d&=65535,V(f<<16|g,d<<16|h,this.unsigned)};E.mul=E.multiply;E.divide=function(e){if(Ce(e)||(e=st(e)),e.isZero())throw Error("division by zero");if($e){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?$e.div_u:$e.div_s)(this.low,this.high,e.low,e.high);return V(t,$e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Cr:We;var n,i,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Cr;if(e.gt(this.shru(1)))return lp;s=Cr}else{if(this.eq(be)){if(e.eq(hn)||e.eq(Fl))return be;if(e.eq(be))return hn;var a=this.shr(1);return n=a.div(e).shl(1),n.eq(We)?e.isNegative()?hn:Fl:(i=this.sub(e.mul(n)),s=n.add(i.div(e)),s)}else if(e.eq(be))return this.unsigned?Cr:We;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=We}for(i=this;i.gte(e);){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:Ts(2,o-48),c=Ge(n),u=c.mul(e);u.isNegative()||u.gt(i);)n-=l,c=Ge(n,this.unsigned),u=c.mul(e);c.isZero()&&(c=hn),s=s.add(c),i=i.sub(u)}return s};E.div=E.divide;E.modulo=function(e){if(Ce(e)||(e=st(e)),$e){var t=(this.unsigned?$e.rem_u:$e.rem_s)(this.low,this.high,e.low,e.high);return V(t,$e.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};E.mod=E.modulo;E.rem=E.modulo;E.not=function(){return V(~this.low,~this.high,this.unsigned)};E.and=function(e){return Ce(e)||(e=st(e)),V(this.low&e.low,this.high&e.high,this.unsigned)};E.or=function(e){return Ce(e)||(e=st(e)),V(this.low|e.low,this.high|e.high,this.unsigned)};E.xor=function(e){return Ce(e)||(e=st(e)),V(this.low^e.low,this.high^e.high,this.unsigned)};E.shiftLeft=function(e){return Ce(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?V(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):V(0,this.low<<e-32,this.unsigned)};E.shl=E.shiftLeft;E.shiftRight=function(e){return Ce(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?V(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):V(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};E.shr=E.shiftRight;E.shiftRightUnsigned=function(e){if(Ce(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var n=this.low;return V(n>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?V(t,0,this.unsigned):V(t>>>e-32,0,this.unsigned)};E.shru=E.shiftRightUnsigned;E.shr_u=E.shiftRightUnsigned;E.toSigned=function(){return this.unsigned?V(this.low,this.high,!1):this};E.toUnsigned=function(){return this.unsigned?this:V(this.low,this.high,!0)};E.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};E.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};E.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};W.fromBytes=function(e,t,n){return n?W.fromBytesLE(e,t):W.fromBytesBE(e,t)};W.fromBytesLE=function(e,t){return new W(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};W.fromBytesBE=function(e,t){return new W(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}});var yp=p(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.loadFileDescriptorSetFromObject=fe.loadFileDescriptorSetFromBuffer=fe.fromJSON=fe.loadSync=fe.load=fe.isAnyExtension=fe.Long=void 0;var AE=$d(),wt=Es(),zl=Jf(),jl=tp(),NE=hp();fe.Long=NE;function kE(r){return"@type"in r&&typeof r["@type"]=="string"}fe.isAnyExtension=kE;var gp={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function PE(r,e){return r===""?e:r+"."+e}function IE(r){return r instanceof wt.Service||r instanceof wt.Type||r instanceof wt.Enum}function ME(r){return r instanceof wt.Namespace||r instanceof wt.Root}function mp(r,e){let t=PE(e,r.name);return IE(r)?[[t,r]]:ME(r)&&typeof r.nested!="undefined"?Object.keys(r.nested).map(n=>mp(r.nested[n],t)).reduce((n,i)=>n.concat(i),[]):[]}function fp(r,e){return function(n){return r.toObject(r.decode(n),e)}}function pp(r){return function(t){if(Array.isArray(t))throw new Error(`Failed to serialize message: expected object with ${r.name} structure, got array instead`);let n=r.fromObject(t);return r.encode(n).finish()}}function xE(r,e,t,n){let i=r.resolvedRequestType,s=r.resolvedResponseType;return{path:"/"+e+"/"+r.name,requestStream:!!r.requestStream,responseStream:!!r.responseStream,requestSerialize:pp(i),requestDeserialize:fp(i,t),responseSerialize:pp(s),responseDeserialize:fp(s,t),originalName:AE(r.name),requestType:Ul(i,n),responseType:Ul(s,n)}}function DE(r,e,t,n){let i={};for(let s of r.methodsArray)i[s.name]=xE(s,e,t,n);return i}function Ul(r,e){let t=r.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:t.$type.toObject(t,gp),fileDescriptorProtos:e}}function LE(r,e){let t=r.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:t.$type.toObject(t,gp),fileDescriptorProtos:e}}function qE(r,e,t,n){if(r instanceof wt.Service)return DE(r,e,t,n);if(r instanceof wt.Type)return Ul(r,n);if(r instanceof wt.Enum)return LE(r,n);throw new Error("Type mismatch in reflection object handling")}function Rs(r,e){let t={};r.resolveAll();let i=r.toDescriptor("proto3").file.map(s=>Buffer.from(zl.FileDescriptorProto.encode(s).finish()));for(let[s,a]of mp(r,""))t[s]=qE(a,s,e,i);return t}function vp(r,e){e=e||{};let t=wt.Root.fromDescriptor(r);return t.resolveAll(),Rs(t,e)}function FE(r,e){return(0,jl.loadProtosWithOptions)(r,e).then(t=>Rs(t,e))}fe.load=FE;function BE(r,e){let t=(0,jl.loadProtosWithOptionsSync)(r,e);return Rs(t,e)}fe.loadSync=BE;function UE(r,e){e=e||{};let t=wt.Root.fromJSON(r);return t.resolveAll(),Rs(t,e)}fe.fromJSON=UE;function zE(r,e){let t=zl.FileDescriptorSet.decode(r);return vp(t,e)}fe.loadFileDescriptorSetFromBuffer=zE;function jE(r,e){let t=zl.FileDescriptorSet.fromObject(r);return vp(t,e)}fe.loadFileDescriptorSetFromObject=jE;(0,jl.addCommonProtos)()});var pn=p(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.setup=Y.getChannelzServiceDefinition=Y.getChannelzHandlers=Y.unregisterChannelzRef=Y.registerChannelzSocket=Y.registerChannelzServer=Y.registerChannelzSubchannel=Y.registerChannelzChannel=Y.ChannelzCallTracker=Y.ChannelzChildrenTracker=Y.ChannelzTrace=void 0;var _p=require("net"),ri=Qe(),ii=$(),HE=mt(),$E=Gi(),GE=Bo();function Hl(r){return{channel_id:r.id,name:r.name}}function Vl(r){return{subchannel_id:r.id,name:r.name}}function WE(r){return{server_id:r.id}}function Os(r){return{socket_id:r.id,name:r.name}}var Sp=32,$l=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,n){let i=new Date;this.events.push({description:t,severity:e,timestamp:i,childChannel:(n==null?void 0:n.kind)==="channel"?n:void 0,childSubchannel:(n==null?void 0:n.kind)==="subchannel"?n:void 0}),this.events.length>=Sp*2&&(this.events=this.events.slice(Sp)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:Dt(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:Dt(e.timestamp),channel_ref:e.childChannel?Hl(e.childChannel):null,subchannel_ref:e.childSubchannel?Vl(e.childSubchannel):null}))}}};Y.ChannelzTrace=$l;var Gl=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,n,i;switch(e.kind){case"channel":{let s=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(n=this.subchannelChildren.get(e.id))!==null&&n!==void 0?n:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(i=this.socketChildren.get(e.id))!==null&&i!==void 0?i:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t));break}}}getChildLists(){let e=[];for(let{ref:i}of this.channelChildren.values())e.push(i);let t=[];for(let{ref:i}of this.subchannelChildren.values())t.push(i);let n=[];for(let{ref:i}of this.socketChildren.values())n.push(i);return{channels:e,subchannels:t,sockets:n}}};Y.ChannelzChildrenTracker=Gl;var Wl=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};Y.ChannelzCallTracker=Wl;var VE=1;function As(){return VE++}var ni=[],Jl=[],sr=[],Yl=[];function JE(r,e,t){let n=As(),i={id:n,name:r,kind:"channel"};return t&&(ni[n]={ref:i,getInfo:e}),i}Y.registerChannelzChannel=JE;function YE(r,e,t){let n=As(),i={id:n,name:r,kind:"subchannel"};return t&&(Jl[n]={ref:i,getInfo:e}),i}Y.registerChannelzSubchannel=YE;function KE(r,e){let t=As(),n={id:t,kind:"server"};return e&&(sr[t]={ref:n,getInfo:r}),n}Y.registerChannelzServer=KE;function XE(r,e,t){let n=As(),i={id:n,name:r,kind:"socket"};return t&&(Yl[n]={ref:i,getInfo:e}),i}Y.registerChannelzSocket=XE;function QE(r){switch(r.kind){case"channel":delete ni[r.id];return;case"subchannel":delete Jl[r.id];return;case"server":delete sr[r.id];return;case"socket":delete Yl[r.id];return}}Y.unregisterChannelzRef=QE;function ZE(r){let e=Number.parseInt(r,16);return[e/256|0,e%256]}function Ep(r){if(r==="")return[];let e=r.split(":").map(n=>ZE(n));return[].concat(...e)}function eb(r){if(_p.isIPv4(r))return Buffer.from(Uint8Array.from(r.split(".").map(e=>Number.parseInt(e))));if(_p.isIPv6(r)){let e,t,n=r.indexOf("::");n===-1?(e=r,t=""):(e=r.substring(0,n),t=r.substring(n+2));let i=Buffer.from(Ep(e)),s=Buffer.from(Ep(t)),a=Buffer.alloc(16-i.length-s.length,0);return Buffer.concat([i,a,s])}else return null}function Cp(r){switch(r){case ri.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case ri.ConnectivityState.IDLE:return{state:"IDLE"};case ri.ConnectivityState.READY:return{state:"READY"};case ri.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case ri.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function Dt(r){if(!r)return null;let e=r.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function Tp(r){let e=r.getInfo();return{ref:Hl(r.ref),data:{target:e.target,state:Cp(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Dt(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(t=>Hl(t)),subchannel_ref:e.children.subchannels.map(t=>Vl(t))}}function tb(r,e){let t=Number.parseInt(r.request.channel_id),n=ni[t];if(n===void 0){e({code:ii.Status.NOT_FOUND,details:"No channel data found for id "+t});return}e(null,{channel:Tp(n)})}function rb(r,e){let t=Number.parseInt(r.request.max_results),n=[],i=Number.parseInt(r.request.start_channel_id);for(;i<ni.length;i++){let s=ni[i];if(s!==void 0&&(n.push(Tp(s)),n.length>=t))break}e(null,{channel:n,end:i>=sr.length})}function Rp(r){let e=r.getInfo();return{ref:WE(r.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Dt(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(t=>Os(t))}}function nb(r,e){let t=Number.parseInt(r.request.server_id),n=sr[t];if(n===void 0){e({code:ii.Status.NOT_FOUND,details:"No server data found for id "+t});return}e(null,{server:Rp(n)})}function ib(r,e){let t=Number.parseInt(r.request.max_results),n=[],i=Number.parseInt(r.request.start_server_id);for(;i<sr.length;i++){let s=sr[i];if(s!==void 0&&(n.push(Rp(s)),n.length>=t))break}e(null,{server:n,end:i>=sr.length})}function sb(r,e){let t=Number.parseInt(r.request.subchannel_id),n=Jl[t];if(n===void 0){e({code:ii.Status.NOT_FOUND,details:"No subchannel data found for id "+t});return}let i=n.getInfo(),s={ref:Vl(n.ref),data:{target:i.target,state:Cp(i.state),calls_started:i.callTracker.callsStarted,calls_succeeded:i.callTracker.callsSucceeded,calls_failed:i.callTracker.callsFailed,last_call_started_timestamp:Dt(i.callTracker.lastCallStartedTimestamp),trace:i.trace.getTraceMessage()},socket_ref:i.children.sockets.map(a=>Os(a))};e(null,{subchannel:s})}function bp(r){var e;return HE.isTcpSubchannelAddress(r)?{address:"tcpip_address",tcpip_address:{ip_address:(e=eb(r.host))!==null&&e!==void 0?e:void 0,port:r.port}}:{address:"uds_address",uds_address:{filename:r.path}}}function ab(r,e){var t,n,i,s,a;let o=Number.parseInt(r.request.socket_id),l=Yl[o];if(l===void 0){e({code:ii.Status.NOT_FOUND,details:"No socket data found for id "+o});return}let c=l.getInfo(),u=c.security?{model:"tls",tls:{cipher_suite:c.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(t=c.security.cipherSuiteStandardName)!==null&&t!==void 0?t:void 0,other_name:(n=c.security.cipherSuiteOtherName)!==null&&n!==void 0?n:void 0,local_certificate:(i=c.security.localCertificate)!==null&&i!==void 0?i:void 0,remote_certificate:(s=c.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,d={ref:Os(l.ref),local:c.localAddress?bp(c.localAddress):null,remote:c.remoteAddress?bp(c.remoteAddress):null,remote_name:(a=c.remoteName)!==null&&a!==void 0?a:void 0,security:u,data:{keep_alives_sent:c.keepAlivesSent,streams_started:c.streamsStarted,streams_succeeded:c.streamsSucceeded,streams_failed:c.streamsFailed,last_local_stream_created_timestamp:Dt(c.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:Dt(c.lastRemoteStreamCreatedTimestamp),messages_received:c.messagesReceived,messages_sent:c.messagesSent,last_message_received_timestamp:Dt(c.lastMessageReceivedTimestamp),last_message_sent_timestamp:Dt(c.lastMessageSentTimestamp),local_flow_control_window:c.localFlowControlWindow?{value:c.localFlowControlWindow}:null,remote_flow_control_window:c.remoteFlowControlWindow?{value:c.remoteFlowControlWindow}:null}};e(null,{socket:d})}function ob(r,e){let t=Number.parseInt(r.request.server_id),n=sr[t];if(n===void 0){e({code:ii.Status.NOT_FOUND,details:"No server data found for id "+t});return}let i=Number.parseInt(r.request.start_socket_id),s=Number.parseInt(r.request.max_results),o=n.getInfo().sessionChildren.sockets.sort((u,d)=>u.id-d.id),l=[],c=0;for(;c<o.length&&!(o[c].id>=i&&(l.push(Os(o[c])),l.length>=s));c++);e(null,{socket_ref:l,end:c>=o.length})}function wp(){return{GetChannel:tb,GetTopChannels:rb,GetServer:nb,GetServers:ib,GetSubchannel:sb,GetSocket:ab,GetServerSockets:ob}}Y.getChannelzHandlers=wp;var ws=null;function Op(){if(ws)return ws;let r=yp().loadSync,e=r("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return ws=GE.loadPackageDefinition(e).grpc.channelz.v1.Channelz.service,ws}Y.getChannelzServiceDefinition=Op;function lb(){$E.registerAdminService(Op,wp)}Y.setup=lb});var Kl=p((Yw,cb)=>{cb.exports={name:"@grpc/grpc-js",version:"1.7.3",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.108","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","clang-format":"^1.0.55",execa:"^2.0.3",gts:"^2.0.0",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^8.3.0",typescript:"^3.7.2"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"npm run check",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"gts check src/**/*.ts",fix:"gts fix src/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.0","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var Ip=p(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});Ns.Subchannel=void 0;var Ql=require("http2"),Ap=require("tls"),I=Qe(),ub=Ln(),Np=pt(),ar=ie(),or=$(),db=Eo(),hb=require("net"),si=De(),Xl=mt(),Lt=pn(),fb=Kl().version,kp="subchannel",pb="subchannel_flowctrl",Pp=~(1<<31),gb=2e4,{HTTP2_HEADER_AUTHORITY:mb,HTTP2_HEADER_CONTENT_TYPE:vb,HTTP2_HEADER_METHOD:yb,HTTP2_HEADER_PATH:_b,HTTP2_HEADER_TE:Sb,HTTP2_HEADER_USER_AGENT:Eb}=Ql.constants,bb=Buffer.from("too_many_pings","ascii"),Zl=class{constructor(e,t,n,i){this.channelTarget=e,this.subchannelAddress=t,this.options=n,this.credentials=i,this.connectivityState=I.ConnectivityState.IDLE,this.session=null,this.continueConnecting=!1,this.stateListeners=[],this.disconnectListeners=new Set,this.keepaliveTimeMs=Pp,this.keepaliveTimeoutMs=gb,this.keepaliveWithoutCalls=!1,this.callRefcount=0,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new Lt.ChannelzCallTracker,this.childrenTracker=new Lt.ChannelzChildrenTracker,this.channelzSocketRef=null,this.remoteName=null,this.streamTracker=new Lt.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.userAgent=[n["grpc.primary_user_agent"],`grpc-node-js/${fb}`,n["grpc.secondary_user_agent"]].filter(a=>a).join(" "),"grpc.keepalive_time_ms"in n&&(this.keepaliveTimeMs=n["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in n&&(this.keepaliveTimeoutMs=n["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in n?this.keepaliveWithoutCalls=n["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,this.keepaliveIntervalId=setTimeout(()=>{},0),clearTimeout(this.keepaliveIntervalId),this.keepaliveTimeoutId=setTimeout(()=>{},0),clearTimeout(this.keepaliveTimeoutId);let s={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new ub.BackoffTimeout(()=>{this.handleBackoffTimer()},s),this.subchannelAddressString=Xl.subchannelAddressToString(t),n["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Lt.ChannelzTrace,this.channelzRef=Lt.registerChannelzSubchannel(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(n,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}getChannelzSocketInfo(){var e,t,n;if(this.session===null)return null;let i=this.session.socket,s=i.remoteAddress?Xl.stringToSubchannelAddress(i.remoteAddress,i.remotePort):null,a=i.localAddress?Xl.stringToSubchannelAddress(i.localAddress,i.localPort):null,o;if(this.session.encrypted){let c=i,u=c.getCipher(),d=c.getCertificate(),h=c.getPeerCertificate();o={cipherSuiteStandardName:(e=u.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:u.standardName?null:u.name,localCertificate:d&&"raw"in d?d.raw:null,remoteCertificate:h&&"raw"in h?h.raw:null}}else o=null;return{remoteAddress:s,localAddress:a,security:o,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(n=this.session.state.remoteWindowSize)!==null&&n!==void 0?n:null}}resetChannelzSocketInfo(){!this.channelzEnabled||(this.channelzSocketRef&&(Lt.unregisterChannelzRef(this.channelzSocketRef),this.childrenTracker.unrefChild(this.channelzSocketRef),this.channelzSocketRef=null),this.remoteName=null,this.streamTracker=new Lt.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null)}trace(e){ar.trace(or.LogVerbosity.DEBUG,kp,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){ar.trace(or.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){ar.trace(or.LogVerbosity.DEBUG,pb,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){ar.trace(or.LogVerbosity.DEBUG,"subchannel_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){ar.trace(or.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([I.ConnectivityState.TRANSIENT_FAILURE],I.ConnectivityState.CONNECTING):this.transitionToState([I.ConnectivityState.TRANSIENT_FAILURE],I.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}sendPing(){var e,t;this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0||t.call(e);try{this.session.ping((n,i,s)=>{this.keepaliveTrace("Received ping response"),clearTimeout(this.keepaliveTimeoutId)})}catch(n){this.transitionToState([I.ConnectivityState.READY],I.ConnectivityState.TRANSIENT_FAILURE)}}startKeepalivePings(){var e,t;this.keepaliveIntervalId=setInterval(()=>{this.sendPing()},this.keepaliveTimeMs),(t=(e=this.keepaliveIntervalId).unref)===null||t===void 0||t.call(e)}stopKeepalivePings(){clearInterval(this.keepaliveIntervalId),clearTimeout(this.keepaliveTimeoutId)}createSession(e){var t,n,i;e.realTarget?(this.remoteName=si.uriToString(e.realTarget),this.trace("creating HTTP/2 session through proxy to "+e.realTarget)):(this.remoteName=null,this.trace("creating HTTP/2 session"));let s=Np.getDefaultAuthority((t=e.realTarget)!==null&&t!==void 0?t:this.channelTarget),a=this.credentials._getConnectionOptions()||{};a.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in this.options?a.maxSessionMemory=this.options["grpc-node.max_session_memory"]:a.maxSessionMemory=Number.MAX_SAFE_INTEGER;let o="http://";if("secureContext"in a){if(o="https://",this.options["grpc.ssl_target_name_override"]){let c=this.options["grpc.ssl_target_name_override"];a.checkServerIdentity=(u,d)=>Ap.checkServerIdentity(c,d),a.servername=c}else{let c=(i=(n=si.splitHostPort(s))===null||n===void 0?void 0:n.host)!==null&&i!==void 0?i:"localhost";a.servername=c}e.socket&&(a.createConnection=(c,u)=>e.socket)}else a.createConnection=(c,u)=>e.socket?e.socket:hb.connect(this.subchannelAddress);a=Object.assign(Object.assign({},a),this.subchannelAddress);let l=Ql.connect(o+s,a);this.session=l,this.channelzSocketRef=Lt.registerChannelzSocket(this.subchannelAddressString,()=>this.getChannelzSocketInfo(),this.channelzEnabled),this.channelzEnabled&&this.childrenTracker.refChild(this.channelzSocketRef),l.unref(),l.once("connect",()=>{this.session===l&&this.transitionToState([I.ConnectivityState.CONNECTING],I.ConnectivityState.READY)}),l.once("close",()=>{this.session===l&&(this.trace("connection closed"),this.transitionToState([I.ConnectivityState.CONNECTING],I.ConnectivityState.TRANSIENT_FAILURE),this.transitionToState([I.ConnectivityState.READY],I.ConnectivityState.IDLE))}),l.once("goaway",(c,u,d)=>{this.session===l&&(c===Ql.constants.NGHTTP2_ENHANCE_YOUR_CALM&&d.equals(bb)&&(this.keepaliveTimeMs=Math.min(2*this.keepaliveTimeMs,Pp),ar.log(or.LogVerbosity.ERROR,`Connection to ${si.uriToString(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTimeMs} ms`)),this.trace("connection closed by GOAWAY with code "+c),this.transitionToState([I.ConnectivityState.CONNECTING,I.ConnectivityState.READY],I.ConnectivityState.IDLE))}),l.once("error",c=>{this.trace("connection closed with error "+c.message)}),ar.isTracerEnabled(kp)&&(l.on("remoteSettings",c=>{this.trace("new settings received"+(this.session!==l?" on the old connection":"")+": "+JSON.stringify(c))}),l.on("localSettings",c=>{this.trace("local settings acknowledged by remote"+(this.session!==l?" on the old connection":"")+": "+JSON.stringify(c))}))}startConnectingInternal(){var e,t;let n=this.credentials._getConnectionOptions()||{};if("secureContext"in n){if(n.ALPNProtocols=["h2"],this.options["grpc.ssl_target_name_override"]){let i=this.options["grpc.ssl_target_name_override"];n.checkServerIdentity=(s,a)=>Ap.checkServerIdentity(i,a),n.servername=i}else if("grpc.http_connect_target"in this.options){let i=Np.getDefaultAuthority((e=si.parseUri(this.options["grpc.http_connect_target"]))!==null&&e!==void 0?e:{path:"localhost"}),s=si.splitHostPort(i);n.servername=(t=s==null?void 0:s.host)!==null&&t!==void 0?t:i}}db.getProxiedConnection(this.subchannelAddress,this.options,n).then(i=>{this.createSession(i)},i=>{this.transitionToState([I.ConnectivityState.CONNECTING],I.ConnectivityState.TRANSIENT_FAILURE)})}handleDisconnect(){this.transitionToState([I.ConnectivityState.READY],I.ConnectivityState.TRANSIENT_FAILURE);for(let e of this.disconnectListeners.values())e()}transitionToState(e,t){if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(I.ConnectivityState[this.connectivityState]+" -> "+I.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO",I.ConnectivityState[this.connectivityState]+" -> "+I.ConnectivityState[t]);let n=this.connectivityState;switch(this.connectivityState=t,t){case I.ConnectivityState.READY:this.stopBackoff();let i=this.session;i.socket.once("close",()=>{this.session===i&&this.handleDisconnect()}),this.keepaliveWithoutCalls&&this.startKeepalivePings();break;case I.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case I.ConnectivityState.TRANSIENT_FAILURE:this.session&&this.session.close(),this.session=null,this.resetChannelzSocketInfo(),this.stopKeepalivePings(),this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case I.ConnectivityState.IDLE:this.session&&this.session.close(),this.session=null,this.resetChannelzSocketInfo(),this.stopKeepalivePings();break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let i of[...this.stateListeners])i(this,n,t);return!0}checkBothRefcounts(){this.callRefcount===0&&this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.transitionToState([I.ConnectivityState.CONNECTING,I.ConnectivityState.READY],I.ConnectivityState.IDLE),this.channelzEnabled&&Lt.unregisterChannelzRef(this.channelzRef))}callRef(){this.refTrace("callRefcount "+this.callRefcount+" -> "+(this.callRefcount+1)),this.callRefcount===0&&(this.session&&this.session.ref(),this.backoffTimeout.ref(),this.keepaliveWithoutCalls||this.startKeepalivePings()),this.callRefcount+=1}callUnref(){this.refTrace("callRefcount "+this.callRefcount+" -> "+(this.callRefcount-1)),this.callRefcount-=1,this.callRefcount===0&&(this.session&&this.session.unref(),this.backoffTimeout.unref(),this.keepaliveWithoutCalls||clearInterval(this.keepaliveIntervalId),this.checkBothRefcounts())}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.checkBothRefcounts()}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}startCallStream(e,t,n){let i=e.toHttp2Headers();i[mb]=t.getHost(),i[Eb]=this.userAgent,i[vb]="application/grpc",i[yb]="POST",i[_b]=t.getMethod(),i[Sb]="trailers";let s;try{s=this.session.request(i)}catch(c){throw this.transitionToState([I.ConnectivityState.READY],I.ConnectivityState.TRANSIENT_FAILURE),c}let a="";for(let c of Object.keys(i))a+="		"+c+": "+i[c]+`
`;ar.trace(or.LogVerbosity.DEBUG,"call_stream","Starting stream ["+t.getCallNumber()+"] on subchannel ("+this.channelzRef.id+") "+this.subchannelAddressString+` with headers
`+a),this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize);let o=this.session;this.internalsTrace("session.closed="+o.closed+" session.destroyed="+o.destroyed+" session.socket.destroyed="+o.socket.destroyed);let l;this.channelzEnabled?(this.callTracker.addCallStarted(),t.addStatusWatcher(c=>{c.code===or.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),this.streamTracker.addCallStarted(),t.addStreamEndWatcher(c=>{o===this.session&&(c?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed())}),l={addMessageSent:()=>{this.messagesSent+=1,this.lastMessageSentTimestamp=new Date},addMessageReceived:()=>{this.messagesReceived+=1}}):l={addMessageSent:()=>{},addMessageReceived:()=>{}},t.attachHttp2Stream(s,this,n,l)}startConnecting(){this.transitionToState([I.ConnectivityState.IDLE],I.ConnectivityState.CONNECTING)||this.connectivityState===I.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}addDisconnectListener(e){this.disconnectListeners.add(e)}removeDisconnectListener(e){this.disconnectListeners.delete(e)}resetBackoff(){this.backoffTimeout.reset(),this.transitionToState([I.ConnectivityState.TRANSIENT_FAILURE],I.ConnectivityState.CONNECTING)}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}};Ns.Subchannel=Zl});var Mp=p(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.getSubchannelPool=gn.SubchannelPool=void 0;var Cb=fd(),Tb=Ip(),Rb=mt(),wb=De(),Ob=1e4,ai=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let i=this.pool[t].filter(s=>!s.subchannel.unrefIfOneRef());i.length>0&&(e=!1),this.pool[t]=i}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},Ob),(t=(e=this.cleanupTimer).unref)===null||t===void 0||t.call(e))}getOrCreateSubchannel(e,t,n,i){this.ensureCleanupTask();let s=wb.uriToString(e);if(s in this.pool){let o=this.pool[s];for(let l of o)if(Rb.subchannelAddressEqual(t,l.subchannelAddress)&&Cb.channelOptionsEqual(n,l.channelArguments)&&i._equals(l.channelCredentials))return l.subchannel}let a=new Tb.Subchannel(e,t,n,i);return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:t,channelArguments:n,channelCredentials:i,subchannel:a}),a.ref(),a}};gn.SubchannelPool=ai;var Ab=new ai;function Nb(r){return r?Ab:new ai}gn.getSubchannelPool=Nb});var tc=p(mn=>{"use strict";Object.defineProperty(mn,"__esModule",{value:!0});mn.FilterStackFactory=mn.FilterStack=void 0;var ks=class{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let n=0;n<this.filters.length;n++)t=this.filters[n].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let n=this.filters.length-1;n>=0;n--)t=this.filters[n].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let n=0;n<this.filters.length;n++)t=this.filters[n].sendMessage(t);return t}receiveMessage(e){let t=e;for(let n=this.filters.length-1;n>=0;n--)t=this.filters[n].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let n=this.filters.length-1;n>=0;n--)t=this.filters[n].receiveTrailers(t);return t}refresh(){for(let e of this.filters)e.refresh()}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};mn.FilterStack=ks;var ec=class{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}createFilter(e){return new ks(this.factories.map(t=>t.createFilter(e)))}};mn.FilterStackFactory=ec});var Rr=p(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.BaseFilter=void 0;var rc=class{sendMetadata(e){return q(this,null,function*(){return e})}receiveMetadata(e){return e}sendMessage(e){return q(this,null,function*(){return e})}receiveMessage(e){return q(this,null,function*(){return e})}receiveTrailers(e){return e}refresh(){}};Ps.BaseFilter=rc});var Dp=p(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.CallCredentialsFilterFactory=vn.CallCredentialsFilter=void 0;var kb=Rr(),xp=$(),Pb=De(),Is=class extends kb.BaseFilter{constructor(e,t){var n,i;super(),this.channel=e,this.stream=t,this.channel=e,this.stream=t;let s=t.getMethod().split("/"),a="";s.length>=2&&(a=s[1]);let o=(i=(n=Pb.splitHostPort(t.getHost()))===null||n===void 0?void 0:n.host)!==null&&i!==void 0?i:"localhost";this.serviceUrl=`https://${o}/${a}`}sendMetadata(e){return q(this,null,function*(){let n=this.stream.getCredentials().generateMetadata({service_url:this.serviceUrl}),i=yield e;try{i.merge(yield n)}catch(s){return this.stream.cancelWithStatus(xp.Status.UNAUTHENTICATED,`Failed to retrieve auth metadata with error: ${s.message}`),Promise.reject("Failed to retrieve auth metadata")}return i.get("authorization").length>1?(this.stream.cancelWithStatus(xp.Status.INTERNAL,'"authorization" metadata cannot have multiple values'),Promise.reject('"authorization" metadata cannot have multiple values')):i})}};vn.CallCredentialsFilter=Is;var nc=class{constructor(e){this.channel=e,this.channel=e}createFilter(e){return new Is(this.channel,e)}};vn.CallCredentialsFilterFactory=nc});var qp=p(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});yn.DeadlineFilterFactory=yn.DeadlineFilter=void 0;var Lp=$(),Ib=Rr(),Mb=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function xb(r){let e=new Date().getTime(),t=Math.max(r-e,0);for(let[n,i]of Mb){let s=t/i;if(s<1e8)return String(Math.ceil(s))+n}throw new Error("Deadline is too far in the future")}var Ms=class extends Ib.BaseFilter{constructor(e,t){super(),this.channel=e,this.callStream=t,this.timer=null,this.deadline=1/0,this.retreiveDeadline(),this.runTimer()}retreiveDeadline(){let e=this.callStream.getDeadline();e instanceof Date?this.deadline=e.getTime():this.deadline=e}runTimer(){var e,t;this.timer&&clearTimeout(this.timer);let n=new Date().getTime(),i=this.deadline-n;i<=0?process.nextTick(()=>{this.callStream.cancelWithStatus(Lp.Status.DEADLINE_EXCEEDED,"Deadline exceeded")}):this.deadline!==1/0&&(this.timer=setTimeout(()=>{this.callStream.cancelWithStatus(Lp.Status.DEADLINE_EXCEEDED,"Deadline exceeded")},i),(t=(e=this.timer).unref)===null||t===void 0||t.call(e))}refresh(){this.retreiveDeadline(),this.runTimer()}sendMetadata(e){return q(this,null,function*(){if(this.deadline===1/0)return e;let t=yield e,n=xb(this.deadline);return t.set("grpc-timeout",n),t})}receiveTrailers(e){return this.timer&&clearTimeout(this.timer),e}};yn.DeadlineFilter=Ms;var ic=class{constructor(e){this.channel=e}createFilter(e){return new Ms(this.channel,e)}};yn.DeadlineFilterFactory=ic});var sc=p(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.CompressionAlgorithms=void 0;var Db;(function(r){r[r.identity=0]="identity",r[r.deflate=1]="deflate",r[r.gzip=2]="gzip"})(Db=oi.CompressionAlgorithms||(oi.CompressionAlgorithms={}))});var Up=p(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.CompressionFilterFactory=Sn.CompressionFilter=void 0;var xs=require("zlib"),Bp=sc(),Lb=$(),qb=Rr(),Fb=ie(),Bb=r=>typeof r=="number"&&typeof Bp.CompressionAlgorithms[r]=="string",_n=class{writeMessage(e,t){return q(this,null,function*(){let n=e;t&&(n=yield this.compressMessage(n));let i=Buffer.allocUnsafe(n.length+5);return i.writeUInt8(t?1:0,0),i.writeUInt32BE(n.length,1),n.copy(i,5),i})}readMessage(e){return q(this,null,function*(){let t=e.readUInt8(0)===1,n=e.slice(5);return t&&(n=yield this.decompressMessage(n)),n})}},wr=class extends _n{compressMessage(e){return q(this,null,function*(){return e})}writeMessage(e,t){return q(this,null,function*(){let n=Buffer.allocUnsafe(e.length+5);return n.writeUInt8(0,0),n.writeUInt32BE(e.length,1),e.copy(n,5),n})}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},ac=class extends _n{compressMessage(e){return new Promise((t,n)=>{xs.deflate(e,(i,s)=>{i?n(i):t(s)})})}decompressMessage(e){return new Promise((t,n)=>{xs.inflate(e,(i,s)=>{i?n(i):t(s)})})}},oc=class extends _n{compressMessage(e){return new Promise((t,n)=>{xs.gzip(e,(i,s)=>{i?n(i):t(s)})})}decompressMessage(e){return new Promise((t,n)=>{xs.unzip(e,(i,s)=>{i?n(i):t(s)})})}},lc=class extends _n{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function Fp(r){switch(r){case"identity":return new wr;case"deflate":return new ac;case"gzip":return new oc;default:return new lc(r)}}var Ds=class extends qb.BaseFilter{constructor(e,t){var n;super(),this.sharedFilterConfig=t,this.sendCompression=new wr,this.receiveCompression=new wr,this.currentCompressionAlgorithm="identity";let i=e["grpc.default_compression_algorithm"];if(i!==void 0)if(Bb(i)){let s=Bp.CompressionAlgorithms[i],a=(n=t.serverSupportedEncodingHeader)===null||n===void 0?void 0:n.split(",");(!a||a.includes(s))&&(this.currentCompressionAlgorithm=s,this.sendCompression=Fp(this.currentCompressionAlgorithm))}else Fb.log(Lb.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${i}`)}sendMetadata(e){return q(this,null,function*(){let t=yield e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t})}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let i=t[0];typeof i=="string"&&(this.receiveCompression=Fp(i))}e.remove("grpc-encoding");let n=e.get("grpc-accept-encoding")[0];return n&&(this.sharedFilterConfig.serverSupportedEncodingHeader=n,n.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new wr,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}sendMessage(e){return q(this,null,function*(){var t;let n=yield e,i;return this.sendCompression instanceof wr?i=!1:i=(((t=n.flags)!==null&&t!==void 0?t:0)&2)===0,{message:yield this.sendCompression.writeMessage(n.message,i),flags:n.flags}})}receiveMessage(e){return q(this,null,function*(){return this.receiveCompression.readMessage(yield e)})}};Sn.CompressionFilter=Ds;var cc=class{constructor(e,t){this.channel=e,this.options=t,this.sharedFilterConfig={}}createFilter(e){return new Ds(this.options,this.sharedFilterConfig)}};Sn.CompressionFilterFactory=cc});var zp=p(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.MaxMessageSizeFilterFactory=En.MaxMessageSizeFilter=void 0;var Ub=Rr(),Ls=$(),qs=class extends Ub.BaseFilter{constructor(e,t){super(),this.options=e,this.callStream=t,this.maxSendMessageSize=Ls.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=Ls.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,"grpc.max_send_message_length"in e&&(this.maxSendMessageSize=e["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in e&&(this.maxReceiveMessageSize=e["grpc.max_receive_message_length"])}sendMessage(e){return q(this,null,function*(){if(this.maxSendMessageSize===-1)return e;{let t=yield e;return t.message.length>this.maxSendMessageSize?(this.callStream.cancelWithStatus(Ls.Status.RESOURCE_EXHAUSTED,`Sent message larger than max (${t.message.length} vs. ${this.maxSendMessageSize})`),Promise.reject("Message too large")):t}})}receiveMessage(e){return q(this,null,function*(){if(this.maxReceiveMessageSize===-1)return e;{let t=yield e;return t.length>this.maxReceiveMessageSize?(this.callStream.cancelWithStatus(Ls.Status.RESOURCE_EXHAUSTED,`Received message larger than max (${t.length} vs. ${this.maxReceiveMessageSize})`),Promise.reject("Message too large")):t}})}};En.MaxMessageSizeFilter=qs;var uc=class{constructor(e){this.options=e}createFilter(e){return new qs(this.options,e)}};En.MaxMessageSizeFilterFactory=uc});var qo=p(zs=>{"use strict";Object.defineProperty(zs,"__esModule",{value:!0});zs.ChannelImplementation=void 0;var zb=io(),jb=lo(),Hb=hd(),$b=Mp(),bn=mr(),X=$(),jp=tc(),Gb=Dp(),Wb=qp(),Vb=Up(),Hp=pt(),Fs=ie(),Jb=zp(),Yb=Eo(),Bs=De(),ke=Qe(),li=pn(),Kb=2147483647,Us=0;function Xb(){let r=Us;return Us+=1,Us>=Number.MAX_SAFE_INTEGER&&(Us=0),r}var Qb=[X.Status.OK,X.Status.INVALID_ARGUMENT,X.Status.NOT_FOUND,X.Status.ALREADY_EXISTS,X.Status.FAILED_PRECONDITION,X.Status.ABORTED,X.Status.OUT_OF_RANGE,X.Status.DATA_LOSS];function ci(r,e){return Qb.includes(r)?{code:X.Status.INTERNAL,details:`Invalid status from control plane: ${r} ${X.Status[r]} ${e}`}:{code:r,details:e}}var dc=class{constructor(e,t,n){var i,s,a,o;if(this.credentials=t,this.options=n,this.connectivityState=ke.ConnectivityState.IDLE,this.currentPicker=new bn.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.channelzEnabled=!0,this.callTracker=new li.ChannelzCallTracker,this.childrenTracker=new li.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof jb.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(n&&typeof n!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let l=Bs.parseUri(e);if(l===null)throw new Error(`Could not parse target name "${e}"`);let c=Hp.mapUriDefaultScheme(l);if(c===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},Kb),(s=(i=this.callRefTimer).unref)===null||s===void 0||s.call(i),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new li.ChannelzTrace,this.channelzRef=li.registerChannelzChannel(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=Hp.getDefaultAuthority(c);let u=Yb.mapProxyName(c,n);this.target=u.target,this.options=Object.assign({},this.options,u.extraOptions),this.subchannelPool=$b.getSubchannelPool(((a=n["grpc.use_local_subchannel_pool"])!==null&&a!==void 0?a:0)===0);let d={createSubchannel:(f,g)=>{let y=this.subchannelPool.getOrCreateSubchannel(this.target,f,Object.assign({},this.options,g),this.credentials);return this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",y.getChannelzRef()),y},updateState:(f,g)=>{this.currentPicker=g;let y=this.pickQueue.slice();this.pickQueue=[],this.callRefTimerUnref();for(let{callStream:_,callMetadata:T,callConfig:b,dynamicFilters:B}of y)this.tryPick(_,T,b,B);this.updateState(f)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:f=>{this.channelzEnabled&&this.childrenTracker.refChild(f)},removeChannelzChild:f=>{this.channelzEnabled&&this.childrenTracker.unrefChild(f)}};this.resolvingLoadBalancer=new Hb.ResolvingLoadBalancer(this.target,d,n,f=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=f,this.currentResolutionError=null,process.nextTick(()=>{let g=this.configSelectionQueue;this.configSelectionQueue=[],this.callRefTimerUnref();for(let{callStream:y,callMetadata:_}of g)this.tryGetConfig(y,_);this.configSelectionQueue=[]})},f=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+f.code+' and details "'+f.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},ci(f.code,f.details)),{metadata:f.metadata}));let g=this.configSelectionQueue;this.configSelectionQueue=[],this.callRefTimerUnref();for(let{callStream:y,callMetadata:_}of g)_.getOptions().waitForReady?(this.callRefTimerRef(),this.configSelectionQueue.push({callStream:y,callMetadata:_})):y.cancelWithStatus(f.code,f.details)}),this.filterStackFactory=new jp.FilterStackFactory([new Gb.CallCredentialsFilterFactory(this),new Wb.DeadlineFilterFactory(this),new Jb.MaxMessageSizeFilterFactory(this.options),new Vb.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(n,void 0,2));let h=new Error;Fs.trace(X.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((o=h.stack)===null||o===void 0?void 0:o.substring(h.stack.indexOf(`
`)+1)))}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){Fs.trace(t!=null?t:X.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+Bs.uriToString(this.target)+" "+e)}callRefTimerRef(){var e,t,n,i;!((t=(e=this.callRefTimer).hasRef)===null||t===void 0)&&t.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(i=(n=this.callRefTimer).ref)===null||i===void 0||i.call(n))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(t=(e=this.callRefTimer).unref)===null||t===void 0||t.call(e))}pushPick(e,t,n,i){this.pickQueue.push({callStream:e,callMetadata:t,callConfig:n,dynamicFilters:i}),this.callRefTimerRef()}tryPick(e,t,n,i){var s,a;let o=this.currentPicker.pick({metadata:t,extraPickInfo:n.pickInformation}),l=o.subchannel?"("+o.subchannel.getChannelzRef().id+") "+o.subchannel.getAddress():""+o.subchannel;switch(this.trace("Pick result for call ["+e.getCallNumber()+"]: "+bn.PickResultType[o.pickResultType]+" subchannel: "+l+" status: "+((s=o.status)===null||s===void 0?void 0:s.code)+" "+((a=o.status)===null||a===void 0?void 0:a.details)),o.pickResultType){case bn.PickResultType.COMPLETE:if(o.subchannel===null)e.cancelWithStatus(X.Status.UNAVAILABLE,"Request dropped by load balancing policy");else{if(o.subchannel.getConnectivityState()!==ke.ConnectivityState.READY){Fs.log(X.LogVerbosity.ERROR,"Error: COMPLETE pick result subchannel "+l+" has state "+ke.ConnectivityState[o.subchannel.getConnectivityState()]),this.pushPick(e,t,n,i);break}e.filterStack.sendMetadata(Promise.resolve(t.clone())).then(d=>{var h,f,g;let y=o.subchannel.getConnectivityState();if(y===ke.ConnectivityState.READY)try{let _=o.extraFilterFactories.map(T=>T.createFilter(e));(h=o.subchannel)===null||h===void 0||h.getRealSubchannel().startCallStream(d,e,[...i,..._]),(f=n.onCommitted)===null||f===void 0||f.call(n),(g=o.onCallStarted)===null||g===void 0||g.call(o)}catch(_){let T=_.code;T==="ERR_HTTP2_GOAWAY_SESSION"||T==="ERR_HTTP2_INVALID_SESSION"?(this.trace("Failed to start call on picked subchannel "+l+" with error "+_.message+". Retrying pick",X.LogVerbosity.INFO),this.tryPick(e,t,n,i)):(this.trace("Failed to start call on picked subchanel "+l+" with error "+_.message+". Ending call",X.LogVerbosity.INFO),e.cancelWithStatus(X.Status.INTERNAL,`Failed to start HTTP/2 stream with error: ${_.message}`))}else this.trace("Picked subchannel "+l+" has state "+ke.ConnectivityState[y]+" after metadata filters. Retrying pick",X.LogVerbosity.INFO),this.tryPick(e,t,n,i)},d=>{let{code:h,details:f}=ci(typeof d.code=="number"?d.code:X.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${d.message}`);e.cancelWithStatus(h,f)})}break;case bn.PickResultType.QUEUE:this.pushPick(e,t,n,i);break;case bn.PickResultType.TRANSIENT_FAILURE:if(t.getOptions().waitForReady)this.pushPick(e,t,n,i);else{let{code:d,details:h}=ci(o.status.code,o.status.details);e.cancelWithStatus(d,h)}break;case bn.PickResultType.DROP:let{code:c,details:u}=ci(o.status.code,o.status.details);e.cancelWithStatus(c,u);break;default:throw new Error(`Invalid state: unknown pickResultType ${o.pickResultType}`)}}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(n=>n===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){Fs.trace(X.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+Bs.uriToString(this.target)+" "+ke.ConnectivityState[this.connectivityState]+" -> "+ke.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO",ke.ConnectivityState[this.connectivityState]+" -> "+ke.ConnectivityState[e]),this.connectivityState=e;let t=this.connectivityStateWatchers.slice();for(let n of t)e!==n.currentState&&(n.timer&&clearTimeout(n.timer),this.removeConnectivityStateWatcher(n),n.callback());e!==ke.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}tryGetConfig(e,t){if(e.getStatus()===null)if(this.configSelector===null)this.resolvingLoadBalancer.exitIdle(),this.currentResolutionError&&!t.getOptions().waitForReady?e.cancelWithStatus(this.currentResolutionError.code,this.currentResolutionError.details):(this.configSelectionQueue.push({callStream:e,callMetadata:t}),this.callRefTimerRef());else{let n=this.configSelector(e.getMethod(),t);if(n.status===X.Status.OK){if(n.methodConfig.timeout){let i=new Date;i.setSeconds(i.getSeconds()+n.methodConfig.timeout.seconds),i.setMilliseconds(i.getMilliseconds()+n.methodConfig.timeout.nanos/1e6),e.setConfigDeadline(i),e.filterStack.refresh()}if(n.dynamicFilterFactories.length>0){let s=new jp.FilterStackFactory(n.dynamicFilterFactories).createFilter(e);s.sendMetadata(Promise.resolve(t)).then(a=>{this.tryPick(e,a,n,s.getFilters())})}else this.tryPick(e,t,n,[])}else{let{code:i,details:s}=ci(n.status,"Failed to route call to method "+e.getMethod());e.cancelWithStatus(i,s)}}}_startCallStream(e,t){this.tryGetConfig(e,t.clone())}close(){this.resolvingLoadBalancer.destroy(),this.updateState(ke.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.channelzEnabled&&li.unregisterChannelzRef(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return Bs.uriToString(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&this.resolvingLoadBalancer.exitIdle(),t}watchConnectivityState(e,t,n){if(this.connectivityState===ke.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let i=null;if(t!==1/0){let a=t instanceof Date?t:new Date(t),o=new Date;if(t===-1/0||a<=o){process.nextTick(n,new Error("Deadline passed without connectivity state change"));return}i=setTimeout(()=>{this.removeConnectivityStateWatcher(s),n(new Error("Deadline passed without connectivity state change"))},a.getTime()-o.getTime())}let s={currentState:e,callback:n,timer:i};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,t,n,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===ke.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let a=Xb();this.trace("createCall ["+a+'] method="'+e+'", deadline='+t);let o={deadline:t,flags:s!=null?s:X.Propagate.DEFAULTS,host:n!=null?n:this.defaultAuthority,parentCall:i},l=new zb.Http2CallStream(e,this,o,this.filterStackFactory,this.credentials._getCallCredentials(),a);return this.channelzEnabled&&(this.callTracker.addCallStarted(),l.addStatusWatcher(c=>{c.code===X.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()})),l}};zs.ChannelImplementation=dc});var Kp=p(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.Http2ServerCallStream=Ve.ServerDuplexStreamImpl=Ve.ServerWritableStreamImpl=Ve.ServerReadableStreamImpl=Ve.ServerUnaryCallImpl=void 0;var Gp=require("events"),Cn=require("http2"),pc=require("stream"),Wp=require("zlib"),Vp=require("util"),K=$(),gc=Xe(),Zb=to(),Jp=ie(),Yp="server_call",eC=Vp.promisify(Wp.unzip),tC=Vp.promisify(Wp.inflate);function ui(r){Jp.trace(K.LogVerbosity.DEBUG,Yp,r)}var rC="grpc-accept-encoding",nC="grpc-encoding",iC="grpc-message",sC="grpc-status",$p="grpc-timeout",aC=/(\d{1,8})\s*([HMSmun])/,oC={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},lC={[rC]:"identity,deflate,gzip",[nC]:"identity",[Cn.constants.HTTP2_HEADER_STATUS]:Cn.constants.HTTP_STATUS_OK,[Cn.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},cC={waitForTrailers:!0},hc=class extends Gp.EventEmitter{constructor(e,t,n){super(),this.call=e,this.metadata=t,this.request=n,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};Ve.ServerUnaryCallImpl=hc;var js=class extends pc.Readable{constructor(e,t,n,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=n,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,i)}_read(e){!this.call.consumeUnpushedMessages(this)||this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};Ve.ServerReadableStreamImpl=js;var di=class extends pc.Writable{constructor(e,t,n,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=n,this.request=i,this.cancelled=!1,this.trailingMetadata=new gc.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,n){try{let i=this.call.serializeMessage(e);if(!this.call.write(i)){this.call.once("drain",n);return}}catch(i){i.code=K.Status.INTERNAL,this.emit("error",i)}n()}_final(e){this.call.sendStatus({code:K.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};Ve.ServerWritableStreamImpl=di;var Tn=class extends pc.Duplex{constructor(e,t,n,i,s){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=n,this.deserialize=i,this.cancelled=!1,this.trailingMetadata=new gc.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",a=>{this.call.sendError(a),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};Ve.ServerDuplexStreamImpl=Tn;Tn.prototype._read=js.prototype._read;Tn.prototype._write=di.prototype._write;Tn.prototype._final=di.prototype._final;var fc=class extends Gp.EventEmitter{constructor(e,t,n){super(),this.stream=e,this.handler=t,this.options=n,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=K.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=K.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",i=>{}),this.stream.once("close",()=>{var i;ui("Request to method "+((i=this.handler)===null||i===void 0?void 0:i.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:K.Status.CANCELLED,details:"Cancelled by client",metadata:null}))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in n&&(this.maxSendMessageSize=n["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in n&&(this.maxReceiveMessageSize=n["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){return t==="deflate"?tC(e.subarray(5)):t==="gzip"?eC(e.subarray(5)):t==="identity"?e.subarray(5):Promise.reject({code:K.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,n=Object.assign(Object.assign({},lC),t);this.stream.respond(n,cC)}receiveMetadata(e){let t=gc.Metadata.fromHttp2Headers(e);Jp.isTracerEnabled(Yp)&&ui("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let n=t.get($p);if(n.length>0){let i=n[0].toString().match(aC);if(i===null){let o=new Error("Invalid deadline");return o.code=K.Status.OUT_OF_RANGE,this.sendError(o),t}let s=+i[1]*oC[i[2]]|0,a=new Date;this.deadline=a.setMilliseconds(a.getMilliseconds()+s),this.deadlineTimer=setTimeout(uC,s,this),t.remove($p)}return t.remove(Cn.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(Cn.constants.HTTP2_HEADER_TE),t.remove(Cn.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e,t){let{stream:n}=this,i=0,s=this,a=[],o=this.maxReceiveMessageSize;n.on("data",l),n.on("end",c),n.on("error",c);function l(u){if(i+=u.byteLength,o!==-1&&i>o){n.removeListener("data",l),n.removeListener("end",c),n.removeListener("error",c),t({code:K.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${i} vs. ${o})`});return}a.push(u)}function c(u){if(n.removeListener("data",l),n.removeListener("end",c),n.removeListener("error",c),u!==void 0){t({code:K.Status.INTERNAL,details:u.message});return}if(i===0){t({code:K.Status.INTERNAL,details:"received empty unary message"});return}s.emit("receiveMessage");let d=Buffer.concat(a,i),f=d.readUInt8(0)===1?e:"identity",g=s.getDecompressedMessage(d,f);if(Buffer.isBuffer(g)){s.safeDeserializeMessage(g,t);return}g.then(y=>s.safeDeserializeMessage(y,t),y=>t(y.code?y:{code:K.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}}safeDeserializeMessage(e,t){try{t(null,this.deserializeMessage(e))}catch(n){n.code=K.Status.INTERNAL,t(n)}}serializeMessage(e){let t=this.handler.serialize(e),n=t.byteLength,i=Buffer.allocUnsafe(n+5);return i.writeUInt8(0,0),i.writeUInt32BE(n,1),t.copy(i,5),i}deserializeMessage(e){return this.handler.deserialize(e)}sendUnaryMessage(e,t,n,i){return q(this,null,function*(){if(!this.checkCancelled()){if(n===void 0&&(n=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&n&&(e.metadata=n),this.sendError(e);return}try{let s=this.serializeMessage(t);this.write(s),this.sendStatus({code:K.Status.OK,details:"OK",metadata:n})}catch(s){s.code=K.Status.INTERNAL,this.sendError(s)}}})}sendStatus(e){var t;this.emit("callEnd",e.code),this.emit("streamEnd",e.code===K.Status.OK),!this.checkCancelled()&&(ui("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+K.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var n;let i=Object.assign({[sC]:e.code,[iC]:encodeURI(e.details)},(n=e.metadata)===null||n===void 0?void 0:n.toHttp2Headers());this.stream.sendTrailers(i),this.statusSent=!0}),this.sendMetadata(),this.stream.end()))}sendError(e){let t={code:K.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&typeof e.details=="string"&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:K.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let n=new Zb.StreamDecoder,i=!1,s=!1,a=!1,o=()=>{!a&&i&&!s&&(a=!0,this.pushOrBufferMessage(e,null))};this.stream.on("data",l=>q(this,null,function*(){let c=n.write(l);s=!0,this.stream.pause();for(let u of c){if(this.maxReceiveMessageSize!==-1&&u.length>this.maxReceiveMessageSize){this.sendError({code:K.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${u.length} vs. ${this.maxReceiveMessageSize})`});return}this.emit("receiveMessage");let h=u.readUInt8(0)===1?t:"identity",f=yield this.getDecompressedMessage(u,h);if(!f)return;this.pushOrBufferMessage(e,f)}s=!1,this.stream.resume(),o()})),this.stream.once("end",()=>{i=!0,o()})}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),n=e.push(t);if(t===null||n===!1){this.canPush=!1;break}}return this.canPush}pushOrBufferMessage(e,t){this.isPushPending?this.bufferedMessages.push(t):this.pushMessage(e,t)}pushMessage(e,t){return q(this,null,function*(){if(t===null){ui("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}ui("Received message of length "+t.length),this.isPushPending=!0;try{let n=yield this.deserializeMessage(t);this.canPush?e.push(n)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(n)}catch(n){this.bufferedMessages.length=0,"code"in n&&typeof n.code=="number"&&Number.isInteger(n.code)&&n.code>=K.Status.OK&&n.code<=K.Status.UNAUTHENTICATED||(n.code=K.Status.INTERNAL),e.emit("error",n)}this.isPushPending=!1,this.bufferedMessages.length>0&&this.pushMessage(e,this.bufferedMessages.shift())})}getPeer(){let e=this.stream.session.socket;return e.remoteAddress?e.remotePort?`${e.remoteAddress}:${e.remotePort}`:e.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};Ve.Http2ServerCallStream=fc;function uC(r){let e=new Error("Deadline exceeded");e.code=K.Status.DEADLINE_EXCEEDED,r.sendError(e),r.cancelled=!0,r.emit("cancelled","deadline")}});var yc=p(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});Hs.ServerCredentials=void 0;var Xp=ao(),hi=class{static createInsecure(){return new mc}static createSsl(e,t,n=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw new TypeError("keyCertPairs must be an array");if(typeof n!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let i=[],s=[];for(let a=0;a<t.length;a++){let o=t[a];if(o===null||typeof o!="object")throw new TypeError(`keyCertPair[${a}] must be an object`);if(!Buffer.isBuffer(o.private_key))throw new TypeError(`keyCertPair[${a}].private_key must be a Buffer`);if(!Buffer.isBuffer(o.cert_chain))throw new TypeError(`keyCertPair[${a}].cert_chain must be a Buffer`);i.push(o.cert_chain),s.push(o.private_key)}return new vc({ca:e||Xp.getDefaultRootsData()||void 0,cert:i,key:s,requestCert:n,ciphers:Xp.CIPHER_SUITES})}};Hs.ServerCredentials=hi;var mc=class extends hi{_isSecure(){return!1}_getSettings(){return null}},vc=class extends hi{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var eg=p(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.Server=void 0;var Or=require("http2"),qt=$(),Ar=Kp(),dC=yc(),Qp=pt(),$s=ie(),at=mt(),hC=De(),Te=pn(),{HTTP2_HEADER_PATH:fC}=Or.constants,pC="server";function gC(){}function Zp(r){return{code:qt.Status.UNIMPLEMENTED,details:`The server does not implement the method ${r}`}}function mC(r,e){let t=Zp(e);switch(r){case"unary":return(n,i)=>{i(t,null)};case"clientStream":return(n,i)=>{i(t,null)};case"serverStream":return n=>{n.emit("error",t)};case"bidi":return n=>{n.emit("error",t)};default:throw new Error(`Invalid handlerType ${r}`)}}var _c=class{constructor(e){this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new Te.ChannelzTrace,this.callTracker=new Te.ChannelzCallTracker,this.listenerChildrenTracker=new Te.ChannelzChildrenTracker,this.sessionChildrenTracker=new Te.ChannelzChildrenTracker,this.options=e!=null?e:{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=Te.registerChannelzServer(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,n,i;let s=this.sessions.get(e),a=e.socket,o=a.remoteAddress?at.stringToSubchannelAddress(a.remoteAddress,a.remotePort):null,l=a.localAddress?at.stringToSubchannelAddress(a.localAddress,a.localPort):null,c;if(e.encrypted){let d=a,h=d.getCipher(),f=d.getCertificate(),g=d.getPeerCertificate();c={cipherSuiteStandardName:(t=h.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:h.standardName?null:h.name,localCertificate:f&&"raw"in f?f.raw:null,remoteCertificate:g&&"raw"in g?g.raw:null}}else c=null;return{remoteAddress:o,localAddress:l,security:c,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(n=e.state.localWindowSize)!==null&&n!==void 0?n:null,remoteFlowControlWindow:(i=e.state.remoteWindowSize)!==null&&i!==void 0?i:null}}}trace(e){$s.trace(qt.LogVerbosity.DEBUG,pC,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!="object"||t===null||typeof t!="object")throw new Error("addService() requires two objects as arguments");let n=Object.keys(e);if(n.length===0)throw new Error("Cannot add an empty service to a server");n.forEach(i=>{let s=e[i],a;s.requestStream?s.responseStream?a="bidi":a="clientStream":s.responseStream?a="serverStream":a="unary";let o=t[i],l;if(o===void 0&&typeof s.originalName=="string"&&(o=t[s.originalName]),o!==void 0?l=o.bind(t):l=mC(a,i),this.register(s.path,l,s.responseSerialize,s.requestDeserialize,a)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(n=>{let i=e[n];this.unregister(i.path)})}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,n){if(this.started===!0)throw new Error("server is already started");if(typeof e!="string")throw new TypeError("port must be a string");if(t===null||!(t instanceof dC.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof n!="function")throw new TypeError("callback must be a function");let i=hC.parseUri(e);if(i===null)throw new Error(`Could not parse port "${e}"`);let s=Qp.mapUriDefaultScheme(i);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let a={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?a.maxSessionMemory=this.options["grpc-node.max_session_memory"]:a.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(a.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let o=(f,g)=>{process.nextTick(()=>n(f,g))},l=()=>{let f;if(t._isSecure()){let g=Object.assign(a,t._getSettings());f=Or.createSecureServer(g),f.on("secureConnection",y=>{y.on("error",_=>{this.trace("An incoming TLS connection closed with error: "+_.message)})})}else f=Or.createServer(a);return f.setTimeout(0,gC),this._setupHandlers(f),f},c=(f,g,y)=>f.length===0?Promise.resolve({port:g,count:y}):Promise.all(f.map(_=>{this.trace("Attempting to bind "+at.subchannelAddressToString(_));let T;at.isTcpSubchannelAddress(_)?T={host:_.host,port:g}:T=_;let b=l();return new Promise((B,N)=>{let z=M=>{this.trace("Failed to bind "+at.subchannelAddressToString(_)+" with error "+M.message),B(M)};b.once("error",z),b.listen(T,()=>{let M=b.address(),j;typeof M=="string"?j={path:M}:j={host:M.address,port:M.port};let oe;oe=Te.registerChannelzSocket(at.subchannelAddressToString(j),()=>({localAddress:j,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled),this.channelzEnabled&&this.listenerChildrenTracker.refChild(oe),this.http2ServerList.push({server:b,channelzRef:oe}),this.trace("Successfully bound "+at.subchannelAddressToString(j)),B("port"in j?j.port:g),b.removeListener("error",z)})})})).then(_=>{let T=0;for(let b of _)if(typeof b=="number"&&(T+=1,b!==g))throw new Error("Invalid state: multiple port numbers added from single address");return{port:g,count:T+y}}),u=f=>{if(f.length===0)return Promise.resolve({port:0,count:0});let g=f[0],y=l();return new Promise((_,T)=>{let b=B=>{this.trace("Failed to bind "+at.subchannelAddressToString(g)+" with error "+B.message),_(u(f.slice(1)))};y.once("error",b),y.listen(g,()=>{let B=y.address(),N={host:B.address,port:B.port},z;z=Te.registerChannelzSocket(at.subchannelAddressToString(N),()=>({localAddress:N,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled),this.channelzEnabled&&this.listenerChildrenTracker.refChild(z),this.http2ServerList.push({server:y,channelzRef:z}),this.trace("Successfully bound "+at.subchannelAddressToString(N)),_(c(f.slice(1),B.port,1)),y.removeListener("error",b)})})},d={onSuccessfulResolution:(f,g,y)=>{if(d.onSuccessfulResolution=()=>{},f.length===0){o(new Error(`No addresses resolved for port ${e}`),0);return}let _;at.isTcpSubchannelAddress(f[0])?f[0].port===0?_=u(f):_=c(f,f[0].port,0):_=c(f,1,0),_.then(T=>{if(T.count===0){let b=`No address added out of total ${f.length} resolved`;$s.log(qt.LogVerbosity.ERROR,b),o(new Error(b),0)}else T.count<f.length&&$s.log(qt.LogVerbosity.INFO,`WARNING Only ${T.count} addresses added out of total ${f.length} resolved`),o(null,T.port)},T=>{let b=`No address added out of total ${f.length} resolved`;$s.log(qt.LogVerbosity.ERROR,b),o(new Error(b),0)})},onError:f=>{o(new Error(f.details),0)}};Qp.createResolver(s,d,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),Te.unregisterChannelzRef(t))});this.started=!1,this.sessions.forEach((e,t)=>{t.destroy(Or.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&Te.unregisterChannelzRef(this.channelzRef)}register(e,t,n,i,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:t,serialize:n,deserialize:i,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=s=>{this.channelzEnabled&&Te.unregisterChannelzRef(this.channelzRef),e(s)},n=0;function i(){n--,n===0&&t()}this.started=!1;for(let{server:s,channelzRef:a}of this.http2ServerList)s.listening&&(n++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(a),Te.unregisterChannelzRef(a)),i()}));this.sessions.forEach((s,a)=>{a.closed||(n+=1,a.close(i))}),n===0&&t()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let n=t[Or.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof n!="string"||!n.startsWith("application/grpc")?(e.respond({[Or.constants.HTTP2_HEADER_STATUS]:Or.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){let t=e[fC];this.trace("Received call to method "+t+" at address "+this.serverAddressString);let n=this.handlers.get(t);if(n===void 0)throw this.trace("No handler registered for method "+t+". Sending UNIMPLEMENTED status."),Zp(t);return n}_respondWithError(e,t,n=null){let i=new Ar.Http2ServerCallStream(t,null,this.options);e.code===void 0&&(e.code=qt.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),n==null||n.streamTracker.addCallFailed()),i.sendError(e)}_channelzHandler(e,t){let n=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),n==null||n.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),n==null||n.streamTracker.addCallFailed();return}let i;try{i=this._retrieveHandler(t)}catch(a){this._respondWithError(a,e,n);return}let s=new Ar.Http2ServerCallStream(e,i,this.options);s.once("callEnd",a=>{a===qt.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),n&&(s.once("streamEnd",a=>{a?n.streamTracker.addCallSucceeded():n.streamTracker.addCallFailed()}),s.on("sendMessage",()=>{n.messagesSent+=1,n.lastMessageSentTimestamp=new Date}),s.on("receiveMessage",()=>{n.messagesReceived+=1,n.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(s,i,t)||(this.callTracker.addCallFailed(),n==null||n.streamTracker.addCallFailed(),s.sendError({code:qt.Status.INTERNAL,details:`Unknown handler type: ${i.type}`}))}_streamHandler(e,t){if(this._verifyContentType(e,t)!==!0)return;let n;try{n=this._retrieveHandler(t)}catch(s){this._respondWithError(s,e,null);return}let i=new Ar.Http2ServerCallStream(e,n,this.options);this._runHandlerForCall(i,n,t)||i.sendError({code:qt.Status.INTERNAL,details:`Unknown handler type: ${n.type}`})}_runHandlerForCall(e,t,n){var i;let s=e.receiveMetadata(n),a=(i=s.get("grpc-encoding")[0])!==null&&i!==void 0?i:"identity";s.remove("grpc-encoding");let{type:o}=t;if(o==="unary")vC(e,t,s,a);else if(o==="clientStream")yC(e,t,s,a);else if(o==="serverStream")_C(e,t,s,a);else if(o==="bidi")SC(e,t,s,a);else return!1;return!0}_setupHandlers(e){if(e===null)return;let t=e.address(),n="null";t&&(typeof t=="string"?n=t:n=t.address+":"+t.port),this.serverAddressString=n;let i=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",i.bind(this)),e.on("session",s=>{var a;if(!this.started){s.destroy();return}let o;o=Te.registerChannelzSocket((a=s.socket.remoteAddress)!==null&&a!==void 0?a:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled);let l={ref:o,streamTracker:new Te.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,l);let c=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+c),this.sessionChildrenTracker.refChild(o)),s.on("close",()=>{this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+c),this.sessionChildrenTracker.unrefChild(o),Te.unregisterChannelzRef(o)),this.sessions.delete(s)})})}};Gs.Server=_c;function vC(r,e,t,n){r.receiveUnaryMessage(n,(i,s)=>{if(i){r.sendError(i);return}if(s===void 0||r.cancelled)return;let a=new Ar.ServerUnaryCallImpl(r,t,s);e.func(a,(o,l,c,u)=>{r.sendUnaryMessage(o,l,c,u)})})}function yC(r,e,t,n){let i=new Ar.ServerReadableStreamImpl(r,t,e.deserialize,n);function s(a,o,l,c){i.destroy(),r.sendUnaryMessage(a,o,l,c)}r.cancelled||(i.on("error",s),e.func(i,s))}function _C(r,e,t,n){r.receiveUnaryMessage(n,(i,s)=>{if(i){r.sendError(i);return}if(s===void 0||r.cancelled)return;let a=new Ar.ServerWritableStreamImpl(r,t,e.serialize,s);e.func(a)})}function SC(r,e,t,n){let i=new Ar.ServerDuplexStreamImpl(r,t,e.serialize,e.deserialize,n);r.cancelled||e.func(i)}});var tg=p(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.StatusBuilder=void 0;var Sc=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};Ws.StatusBuilder=Sc});var Ec=p(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.isDuration=lr.durationToMs=lr.msToDuration=void 0;function EC(r){return{seconds:r/1e3|0,nanos:r%1e3*1e6|0}}lr.msToDuration=EC;function bC(r){return r.seconds*1e3+r.nanos/1e6|0}lr.durationToMs=bC;function CC(r){return typeof r.seconds=="number"&&typeof r.nanos=="number"}lr.isDuration=CC});var Cc=p(Vs=>{"use strict";Object.defineProperty(Vs,"__esModule",{value:!0});Vs.BaseSubchannelWrapper=void 0;var bc=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}};Vs.BaseSubchannelWrapper=bc});var Mc=p(cr=>{"use strict";var Tc;Object.defineProperty(cr,"__esModule",{value:!0});cr.setup=cr.OutlierDetectionLoadBalancer=cr.OutlierDetectionLoadBalancingConfig=void 0;var Ys=Qe(),ng=$(),Nr=Ec(),ig=xc(),TC=Rr(),sg=Wt(),RC=Hi(),wC=mr(),rg=mt(),OC=Cc(),AC=ie(),NC="outlier_detection";function ue(r){AC.trace(ng.LogVerbosity.DEBUG,NC,r)}var Ic="outlier_detection",kC=((Tc=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&Tc!==void 0?Tc:"true")==="true",PC={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},IC={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function Rn(r,e,t,n){if(e in r&&typeof r[e]!==t){let i=n?`${n}.${e}`:e;throw new Error(`outlier detection config ${i} parse error: expected ${t}, got ${typeof r[e]}`)}}function Rc(r,e,t){let n=t?`${t}.${e}`:e;if(e in r){if(!Nr.isDuration(r[e]))throw new Error(`outlier detection config ${n} parse error: expected Duration, got ${typeof r[e]}`);if(!(r[e].seconds>=0&&r[e].seconds<=315576e6&&r[e].nanos>=0&&r[e].nanos<=999999999))throw new Error(`outlier detection config ${n} parse error: values out of range for non-negative Duaration`)}}function Js(r,e,t){let n=t?`${t}.${e}`:e;if(Rn(r,e,"number",t),e in r&&!(r[e]>=0&&r[e]<=100))throw new Error(`outlier detection config ${n} parse error: value out of range for percentage (0-100)`)}var ur=class{constructor(e,t,n,i,s,a,o){this.childPolicy=o,this.intervalMs=e!=null?e:1e4,this.baseEjectionTimeMs=t!=null?t:3e4,this.maxEjectionTimeMs=n!=null?n:3e5,this.maxEjectionPercent=i!=null?i:10,this.successRateEjection=s?Object.assign(Object.assign({},PC),s):null,this.failurePercentageEjection=a?Object.assign(Object.assign({},IC),a):null}getLoadBalancerName(){return Ic}toJsonObject(){return{interval:Nr.msToDuration(this.intervalMs),base_ejection_time:Nr.msToDuration(this.baseEjectionTimeMs),max_ejection_time:Nr.msToDuration(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new ur(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(Rc(e,"interval"),Rc(e,"base_ejection_time"),Rc(e,"max_ejection_time"),Js(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");Rn(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),Js(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),Rn(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),Rn(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");Js(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),Js(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),Rn(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),Rn(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new ur(e.interval?Nr.durationToMs(e.interval):null,e.base_ejection_time?Nr.durationToMs(e.base_ejection_time):null,e.max_ejection_time?Nr.durationToMs(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(sg.validateLoadBalancingConfig))}};cr.OutlierDetectionLoadBalancingConfig=ur;var Oc=class extends OC.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((n,i,s)=>{if(this.childSubchannelState=s,!this.ejected)for(let a of this.stateListeners)a(this,i,s)})}getConnectivityState(){return this.ejected?Ys.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,Ys.ConnectivityState.TRANSIENT_FAILURE)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,Ys.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function wc(){return{success:0,failure:0}}var Ac=class{constructor(){this.activeBucket=wc(),this.inactiveBucket=wc()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=wc()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},Nc=class extends TC.BaseFilter{constructor(e){super(),this.callCounter=e}receiveTrailers(e){return e.code===ng.Status.OK?this.callCounter.addSuccess():this.callCounter.addFailure(),e}},kc=class{constructor(e){this.callCounter=e}createFilter(e){return new Nc(this.callCounter)}},Pc=class{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType===wC.PickResultType.COMPLETE){let n=t.subchannel,i=n.getMapEntry();if(i){let s=[...t.extraFilterFactories];return this.countCalls&&s.push(new kc(i.counter)),Object.assign(Object.assign({},t),{subchannel:n.getWrappedSubchannel(),extraFilterFactories:s})}else return Object.assign(Object.assign({},t),{subchannel:n.getWrappedSubchannel()})}else return t}},Ks=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new RC.ChildLoadBalancerHandler(ig.createChildChannelControlHelper(e,{createSubchannel:(t,n)=>{let i=e.createSubchannel(t,n),s=this.addressMap.get(rg.subchannelAddressToString(t)),a=new Oc(i,s);return(s==null?void 0:s.currentEjectionTimestamp)!==null&&a.eject(),s==null||s.subchannelWrappers.push(a),a},updateState:(t,n)=>{t===Ys.ConnectivityState.READY?e.updateState(t,new Pc(n,this.isCountingEnabled())):e.updateState(t,n)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())t.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;ue("Running success rate check");let n=t.request_volume,i=0,s=[];for(let d of this.addressMap.values()){let h=d.counter.getLastSuccesses(),f=d.counter.getLastFailures();h+f>=n&&(i+=1,s.push(h/(h+f)))}if(ue("Found "+i+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),i<t.minimum_hosts)return;let a=s.reduce((d,h)=>d+h)/s.length,o=0;for(let d of s){let h=d-a;o+=h*h}let l=o/s.length,c=Math.sqrt(l),u=a-c*(t.stdev_factor/1e3);ue("stdev="+c+" ejectionThreshold="+u);for(let[d,h]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let f=h.counter.getLastSuccesses(),g=h.counter.getLastFailures();if(f+g<n)continue;let y=f/(f+g);if(ue("Checking candidate "+d+" successRate="+y),y<u){let _=Math.random()*100;ue("Candidate "+d+" randomNumber="+_+" enforcement_percentage="+t.enforcement_percentage),_<t.enforcement_percentage&&(ue("Ejecting candidate "+d),this.eject(h,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;ue("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let n=0;for(let i of this.addressMap.values()){let s=i.counter.getLastSuccesses(),a=i.counter.getLastFailures();s+a>=t.request_volume&&(n+=1)}if(!(n<t.minimum_hosts))for(let[i,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let a=s.counter.getLastSuccesses(),o=s.counter.getLastFailures();if(ue("Candidate successes="+a+" failures="+o),a+o<t.request_volume)continue;if(o*100/(o+a)>t.threshold){let c=Math.random()*100;ue("Candidate "+i+" randomNumber="+c+" enforcement_percentage="+t.enforcement_percentage),c<t.enforcement_percentage&&(ue("Ejecting candidate "+i),this.eject(s,e))}}}eject(e,t){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let n of e.subchannelWrappers)n.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let t of e.subchannelWrappers)t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){this.ejectionTimer=setTimeout(()=>this.runChecks(),e)}runChecks(){let e=new Date;if(ue("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[t,n]of this.addressMap.entries())if(n.currentEjectionTimestamp===null)n.ejectionTimeMultiplier>0&&(n.ejectionTimeMultiplier-=1);else{let i=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),a=new Date(n.currentEjectionTimestamp.getTime());a.setMilliseconds(a.getMilliseconds()+Math.min(i*n.ejectionTimeMultiplier,Math.max(i,s))),a<new Date&&(ue("Unejecting "+t),this.uneject(n))}}}updateAddressList(e,t,n){if(!(t instanceof ur))return;let i=new Set;for(let a of e)i.add(rg.subchannelAddressToString(a));for(let a of i)this.addressMap.has(a)||(ue("Adding map entry for "+a),this.addressMap.set(a,{counter:new Ac,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let a of this.addressMap.keys())i.has(a)||(ue("Removing map entry for "+a),this.addressMap.delete(a));let s=sg.getFirstUsableConfig(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,n),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){ue("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let a=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(a)}else ue("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else{ue("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let a of this.addressMap.values())this.uneject(a),a.ejectionTimeMultiplier=0}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return Ic}};cr.OutlierDetectionLoadBalancer=Ks;function MC(){kC&&ig.registerLoadBalancerType(Ic,Ks,ur)}cr.setup=MC});var xc=p(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var ag=ie();Object.defineProperty(Q,"trace",{enumerable:!0,get:function(){return ag.trace}});Object.defineProperty(Q,"log",{enumerable:!0,get:function(){return ag.log}});var xC=pt();Object.defineProperty(Q,"registerResolver",{enumerable:!0,get:function(){return xC.registerResolver}});var DC=De();Object.defineProperty(Q,"uriToString",{enumerable:!0,get:function(){return DC.uriToString}});var LC=Ec();Object.defineProperty(Q,"durationToMs",{enumerable:!0,get:function(){return LC.durationToMs}});var qC=Ln();Object.defineProperty(Q,"BackoffTimeout",{enumerable:!0,get:function(){return qC.BackoffTimeout}});var Xs=Wt();Object.defineProperty(Q,"createChildChannelControlHelper",{enumerable:!0,get:function(){return Xs.createChildChannelControlHelper}});Object.defineProperty(Q,"registerLoadBalancerType",{enumerable:!0,get:function(){return Xs.registerLoadBalancerType}});Object.defineProperty(Q,"getFirstUsableConfig",{enumerable:!0,get:function(){return Xs.getFirstUsableConfig}});Object.defineProperty(Q,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return Xs.validateLoadBalancingConfig}});var FC=mt();Object.defineProperty(Q,"subchannelAddressToString",{enumerable:!0,get:function(){return FC.subchannelAddressToString}});var BC=Hi();Object.defineProperty(Q,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return BC.ChildLoadBalancerHandler}});var Dc=mr();Object.defineProperty(Q,"UnavailablePicker",{enumerable:!0,get:function(){return Dc.UnavailablePicker}});Object.defineProperty(Q,"QueuePicker",{enumerable:!0,get:function(){return Dc.QueuePicker}});Object.defineProperty(Q,"PickResultType",{enumerable:!0,get:function(){return Dc.PickResultType}});var UC=Rr();Object.defineProperty(Q,"BaseFilter",{enumerable:!0,get:function(){return UC.BaseFilter}});var zC=tc();Object.defineProperty(Q,"FilterStackFactory",{enumerable:!0,get:function(){return zC.FilterStackFactory}});var jC=Gi();Object.defineProperty(Q,"registerAdminService",{enumerable:!0,get:function(){return jC.registerAdminService}});var HC=Cc();Object.defineProperty(Q,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return HC.BaseSubchannelWrapper}});var $C=Mc();Object.defineProperty(Q,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return $C.OutlierDetectionLoadBalancingConfig}})});var hg=p(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.setup=void 0;var og=pt(),ug=require("dns"),dg=require("util"),GC=uo(),Lc=$(),qc=Xe(),WC=ie(),VC=$(),dr=De(),lg=require("net"),JC=Ln(),YC="dns_resolver";function wn(r){WC.trace(VC.LogVerbosity.DEBUG,YC,r)}var cg=443,KC=3e4,XC=dg.promisify(ug.resolveTxt),QC=dg.promisify(ug.lookup);function ZC(...r){let e=[];for(let t=0;t<Math.max.apply(null,r.map(n=>n.length));t++)for(let n of r)t<n.length&&e.push(n[t]);return e}var Fc=class{constructor(e,t,n){var i,s,a;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,wn("Resolver constructed for target "+dr.uriToString(e));let o=dr.splitHostPort(e.path);o===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):lg.isIPv4(o.host)||lg.isIPv6(o.host)?(this.ipResult=[{host:o.host,port:(i=o.port)!==null&&i!==void 0?i:cg}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=o.host,this.port=(s=o.port)!==null&&s!==void 0?s:cg),this.percentage=Math.random()*100,this.defaultResolutionError={code:Lc.Status.UNAVAILABLE,details:`Name resolution failed for target ${dr.uriToString(this.target)}`,metadata:new qc.Metadata};let l={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoff=new JC.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},l),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(a=n["grpc.dns_min_time_between_resolutions_ms"])!==null&&a!==void 0?a:KC,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){wn("Returning IP address for target "+dr.uriToString(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.backoff.stop(),this.backoff.reset();return}if(this.dnsHostname===null)wn("Failed to parse DNS address "+dr.uriToString(this.target)),setImmediate(()=>{this.listener.onError({code:Lc.Status.UNAVAILABLE,details:`Failed to parse DNS address ${dr.uriToString(this.target)}`,metadata:new qc.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;wn("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=QC(e,{all:!0}),this.pendingLookupPromise.then(t=>{this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let n=t.filter(a=>a.family===4),i=t.filter(a=>a.family===6);this.latestLookupResult=ZC(i,n).map(a=>({host:a.address,port:+this.port}));let s="["+this.latestLookupResult.map(a=>a.host+":"+a.port).join(",")+"]";if(wn("Resolved addresses for target "+dr.uriToString(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},t=>{wn("Resolution error for target "+dr.uriToString(this.target)+": "+t.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError)}),this.pendingTxtPromise===null&&(this.pendingTxtPromise=XC(e),this.pendingTxtPromise.then(t=>{this.pendingTxtPromise=null;try{this.latestServiceConfig=GC.extractAndSelectServiceConfig(t,this.percentage)}catch(n){this.latestServiceConfigError={code:Lc.Status.UNAVAILABLE,details:"Parsing service config failed",metadata:new qc.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},t=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.startResolution(),this.backoff.runOnce(),this.startNextResolutionTimer())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?this.continueResolving=!0:this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.stop(),this.stopNextResolutionTimer()}static getDefaultAuthority(e){return e.path}};function eT(){og.registerResolver("dns",Fc),og.registerDefaultScheme("dns")}Qs.setup=eT});var fg=p(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.setup=void 0;var tT=pt(),Bc=class{constructor(e,t,n){this.listener=t,this.addresses=[];let i;e.authority===""?i="/"+e.path:i=e.path,this.addresses=[{path:i}]}updateResolution(){process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{})}destroy(){}static getDefaultAuthority(e){return"localhost"}};function rT(){tT.registerResolver("unix",Bc)}Zs.setup=rT});var yg=p(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.setup=void 0;var pg=require("net"),ea=$(),Uc=Xe(),gg=pt(),mg=De(),nT=ie(),iT="ip_resolver";function vg(r){nT.trace(ea.LogVerbosity.DEBUG,iT,r)}var zc="ipv4",jc="ipv6",sT=443,ta=class{constructor(e,t,n){var i;this.target=e,this.listener=t,this.addresses=[],this.error=null,vg("Resolver constructed for target "+mg.uriToString(e));let s=[];if(!(e.scheme===zc||e.scheme===jc)){this.error={code:ea.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new Uc.Metadata};return}let a=e.path.split(",");for(let o of a){let l=mg.splitHostPort(o);if(l===null){this.error={code:ea.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${o}`,metadata:new Uc.Metadata};return}if(e.scheme===zc&&!pg.isIPv4(l.host)||e.scheme===jc&&!pg.isIPv6(l.host)){this.error={code:ea.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${o}`,metadata:new Uc.Metadata};return}s.push({host:l.host,port:(i=l.port)!==null&&i!==void 0?i:sT})}this.addresses=s,vg("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})})}destroy(){}static getDefaultAuthority(e){return e.path.split(",")[0]}};function aT(){gg.registerResolver(zc,ta),gg.registerResolver(jc,ta)}ra.setup=aT});var Sg=p(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.setup=hr.PickFirstLoadBalancer=hr.PickFirstLoadBalancingConfig=void 0;var _g=Wt(),k=Qe(),ot=mr(),oT=mt(),lT=ie(),cT=$(),uT="pick_first";function na(r){lT.trace(cT.LogVerbosity.DEBUG,uT,r)}var fi="pick_first",dT=250,On=class{getLoadBalancerName(){return fi}constructor(){}toJsonObject(){return{[fi]:{}}}static createFromJson(e){return new On}};hr.PickFirstLoadBalancingConfig=On;var Hc=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:ot.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,extraFilterFactories:[],onCallStarted:null}}},ia=class{constructor(e){this.channelControlHelper=e,this.latestAddressList=[],this.subchannels=[],this.currentState=k.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.triedAllSubchannels=!1,this.subchannelStateCounts={[k.ConnectivityState.CONNECTING]:0,[k.ConnectivityState.IDLE]:0,[k.ConnectivityState.READY]:0,[k.ConnectivityState.SHUTDOWN]:0,[k.ConnectivityState.TRANSIENT_FAILURE]:0},this.subchannelStateListener=(t,n,i)=>{if(this.subchannelStateCounts[n]-=1,this.subchannelStateCounts[i]+=1,t===this.subchannels[this.currentSubchannelIndex]&&i===k.ConnectivityState.TRANSIENT_FAILURE&&this.startNextSubchannelConnecting(),i===k.ConnectivityState.READY){this.pickSubchannel(t);return}else{if(this.triedAllSubchannels&&this.subchannelStateCounts[k.ConnectivityState.IDLE]===this.subchannels.length){this.resetSubchannelList(!1),this.updateState(k.ConnectivityState.IDLE,new ot.QueuePicker(this));return}if(this.currentPick===null)if(this.triedAllSubchannels){let s;this.subchannelStateCounts[k.ConnectivityState.CONNECTING]>0?s=k.ConnectivityState.CONNECTING:this.subchannelStateCounts[k.ConnectivityState.TRANSIENT_FAILURE]>0?s=k.ConnectivityState.TRANSIENT_FAILURE:s=k.ConnectivityState.IDLE,s!==this.currentState&&(s===k.ConnectivityState.TRANSIENT_FAILURE?this.updateState(s,new ot.UnavailablePicker):this.updateState(s,new ot.QueuePicker(this)))}else this.updateState(k.ConnectivityState.CONNECTING,new ot.QueuePicker(this))}},this.pickedSubchannelStateListener=(t,n,i)=>{if(i!==k.ConnectivityState.READY)if(this.currentPick=null,t.unref(),t.removeConnectivityStateListener(this.pickedSubchannelStateListener),this.channelControlHelper.removeChannelzChild(t.getChannelzRef()),this.subchannels.length>0)if(this.triedAllSubchannels){let s;this.subchannelStateCounts[k.ConnectivityState.CONNECTING]>0?s=k.ConnectivityState.CONNECTING:this.subchannelStateCounts[k.ConnectivityState.TRANSIENT_FAILURE]>0?s=k.ConnectivityState.TRANSIENT_FAILURE:s=k.ConnectivityState.IDLE,s===k.ConnectivityState.TRANSIENT_FAILURE?this.updateState(s,new ot.UnavailablePicker):this.updateState(s,new ot.QueuePicker(this))}else this.updateState(k.ConnectivityState.CONNECTING,new ot.QueuePicker(this));else this.updateState(k.ConnectivityState.IDLE,new ot.QueuePicker(this))},this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}startNextSubchannelConnecting(){if(!this.triedAllSubchannels){for(let[e,t]of this.subchannels.entries())if(e>this.currentSubchannelIndex){let n=t.getConnectivityState();if(n===k.ConnectivityState.IDLE||n===k.ConnectivityState.CONNECTING){this.startConnecting(e);return}}this.triedAllSubchannels=!0}}startConnecting(e){clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.subchannels[e].getConnectivityState()===k.ConnectivityState.IDLE&&(na("Start connecting to subchannel with address "+this.subchannels[e].getAddress()),process.nextTick(()=>{this.subchannels[e].startConnecting()})),this.connectionDelayTimeout=setTimeout(()=>{this.startNextSubchannelConnecting()},dT)}pickSubchannel(e){na("Pick subchannel with address "+e.getAddress()),this.currentPick!==null&&(this.currentPick.unref(),this.currentPick.removeConnectivityStateListener(this.pickedSubchannelStateListener)),this.currentPick=e,this.updateState(k.ConnectivityState.READY,new Hc(e)),e.addConnectivityStateListener(this.pickedSubchannelStateListener),e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout)}updateState(e,t){na(k.ConnectivityState[this.currentState]+" -> "+k.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(e=!0){for(let t of this.subchannels)t.removeConnectivityStateListener(this.subchannelStateListener),t.unref(),this.channelControlHelper.removeChannelzChild(t.getChannelzRef());this.currentSubchannelIndex=0,this.subchannelStateCounts={[k.ConnectivityState.CONNECTING]:0,[k.ConnectivityState.IDLE]:0,[k.ConnectivityState.READY]:0,[k.ConnectivityState.SHUTDOWN]:0,[k.ConnectivityState.TRANSIENT_FAILURE]:0},this.subchannels=[],e&&(this.triedAllSubchannels=!1)}connectToAddressList(){this.resetSubchannelList(),na("Connect to address list "+this.latestAddressList.map(e=>oT.subchannelAddressToString(e))),this.subchannels=this.latestAddressList.map(e=>this.channelControlHelper.createSubchannel(e,{}));for(let e of this.subchannels)e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef());for(let e of this.subchannels)if(e.addConnectivityStateListener(this.subchannelStateListener),this.subchannelStateCounts[e.getConnectivityState()]+=1,e.getConnectivityState()===k.ConnectivityState.READY){this.pickSubchannel(e),this.resetSubchannelList();return}for(let[e,t]of this.subchannels.entries()){let n=t.getConnectivityState();if(n===k.ConnectivityState.IDLE||n===k.ConnectivityState.CONNECTING){this.startConnecting(e),this.currentPick===null&&this.updateState(k.ConnectivityState.CONNECTING,new ot.QueuePicker(this));return}}this.currentPick===null&&this.updateState(k.ConnectivityState.TRANSIENT_FAILURE,new ot.UnavailablePicker)}updateAddressList(e,t){(this.subchannels.length===0||!this.latestAddressList.every((n,i)=>e[i]===n))&&(this.latestAddressList=e,this.connectToAddressList())}exitIdle(){(this.currentState===k.ConnectivityState.IDLE||this.triedAllSubchannels)&&this.channelControlHelper.requestReresolution();for(let e of this.subchannels)e.startConnecting();this.currentState===k.ConnectivityState.IDLE&&this.latestAddressList.length>0&&this.connectToAddressList()}resetBackoff(){}destroy(){if(this.resetSubchannelList(),this.currentPick!==null){let e=this.currentPick;e.unref(),e.removeConnectivityStateListener(this.pickedSubchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}getTypeName(){return fi}};hr.PickFirstLoadBalancer=ia;function hT(){_g.registerLoadBalancerType(fi,ia,On),_g.registerDefaultLoadBalancerType(fi)}hr.setup=hT});var bg=p(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});An.setup=An.RoundRobinLoadBalancer=void 0;var fT=Wt(),J=Qe(),sa=mr(),pT=mt(),gT=ie(),mT=$(),vT="round_robin";function Eg(r){gT.trace(mT.LogVerbosity.DEBUG,vT,r)}var aa="round_robin",pi=class{getLoadBalancerName(){return aa}constructor(){}toJsonObject(){return{[aa]:{}}}static createFromJson(e){return new pi}},$c=class{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:sa.PickResultType.COMPLETE,subchannel:t,status:null,extraFilterFactories:[],onCallStarted:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},oa=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=J.ConnectivityState.IDLE,this.currentReadyPicker=null,this.subchannelStateCounts={[J.ConnectivityState.CONNECTING]:0,[J.ConnectivityState.IDLE]:0,[J.ConnectivityState.READY]:0,[J.ConnectivityState.SHUTDOWN]:0,[J.ConnectivityState.TRANSIENT_FAILURE]:0},this.subchannelStateListener=(t,n,i)=>{this.subchannelStateCounts[n]-=1,this.subchannelStateCounts[i]+=1,this.calculateAndUpdateState(),(i===J.ConnectivityState.TRANSIENT_FAILURE||i===J.ConnectivityState.IDLE)&&(this.channelControlHelper.requestReresolution(),t.startConnecting())}}calculateAndUpdateState(){if(this.subchannelStateCounts[J.ConnectivityState.READY]>0){let e=this.subchannels.filter(n=>n.getConnectivityState()===J.ConnectivityState.READY),t=0;this.currentReadyPicker!==null&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),t<0&&(t=0)),this.updateState(J.ConnectivityState.READY,new $c(e,t))}else this.subchannelStateCounts[J.ConnectivityState.CONNECTING]>0?this.updateState(J.ConnectivityState.CONNECTING,new sa.QueuePicker(this)):this.subchannelStateCounts[J.ConnectivityState.TRANSIENT_FAILURE]>0?this.updateState(J.ConnectivityState.TRANSIENT_FAILURE,new sa.UnavailablePicker):this.updateState(J.ConnectivityState.IDLE,new sa.QueuePicker(this))}updateState(e,t){Eg(J.ConnectivityState[this.currentState]+" -> "+J.ConnectivityState[e]),e===J.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannelStateCounts={[J.ConnectivityState.CONNECTING]:0,[J.ConnectivityState.IDLE]:0,[J.ConnectivityState.READY]:0,[J.ConnectivityState.SHUTDOWN]:0,[J.ConnectivityState.TRANSIENT_FAILURE]:0},this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList(),Eg("Connect to address list "+e.map(n=>pT.subchannelAddressToString(n))),this.subchannels=e.map(n=>this.channelControlHelper.createSubchannel(n,{}));for(let n of this.subchannels){n.ref(),n.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(n.getChannelzRef());let i=n.getConnectivityState();this.subchannelStateCounts[i]+=1,(i===J.ConnectivityState.IDLE||i===J.ConnectivityState.TRANSIENT_FAILURE)&&n.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return aa}};An.RoundRobinLoadBalancer=oa;function yT(){fT.registerLoadBalancerType(aa,oa,pi)}An.setup=yT});var Rg=p(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.experimental=R.StatusBuilder=R.getClientChannel=R.ServerCredentials=R.Server=R.setLogVerbosity=R.setLogger=R.load=R.loadObject=R.CallCredentials=R.ChannelCredentials=R.waitForClientReady=R.closeClient=R.Channel=R.makeGenericClientConstructor=R.makeClientConstructor=R.loadPackageDefinition=R.Client=R.compressionAlgorithms=R.propagate=R.connectivityState=R.status=R.logVerbosity=R.Metadata=R.credentials=void 0;var la=Za();Object.defineProperty(R,"CallCredentials",{enumerable:!0,get:function(){return la.CallCredentials}});var _T=qo();Object.defineProperty(R,"Channel",{enumerable:!0,get:function(){return _T.ChannelImplementation}});var ST=sc();Object.defineProperty(R,"compressionAlgorithms",{enumerable:!0,get:function(){return ST.CompressionAlgorithms}});var ET=Qe();Object.defineProperty(R,"connectivityState",{enumerable:!0,get:function(){return ET.ConnectivityState}});var ca=lo();Object.defineProperty(R,"ChannelCredentials",{enumerable:!0,get:function(){return ca.ChannelCredentials}});var Cg=Lo();Object.defineProperty(R,"Client",{enumerable:!0,get:function(){return Cg.Client}});var ua=$();Object.defineProperty(R,"logVerbosity",{enumerable:!0,get:function(){return ua.LogVerbosity}});Object.defineProperty(R,"status",{enumerable:!0,get:function(){return ua.Status}});Object.defineProperty(R,"propagate",{enumerable:!0,get:function(){return ua.Propagate}});var Gc=ie(),Wc=Bo();Object.defineProperty(R,"loadPackageDefinition",{enumerable:!0,get:function(){return Wc.loadPackageDefinition}});Object.defineProperty(R,"makeClientConstructor",{enumerable:!0,get:function(){return Wc.makeClientConstructor}});Object.defineProperty(R,"makeGenericClientConstructor",{enumerable:!0,get:function(){return Wc.makeClientConstructor}});var bT=Xe();Object.defineProperty(R,"Metadata",{enumerable:!0,get:function(){return bT.Metadata}});var CT=eg();Object.defineProperty(R,"Server",{enumerable:!0,get:function(){return CT.Server}});var TT=yc();Object.defineProperty(R,"ServerCredentials",{enumerable:!0,get:function(){return TT.ServerCredentials}});var RT=tg();Object.defineProperty(R,"StatusBuilder",{enumerable:!0,get:function(){return RT.StatusBuilder}});R.credentials={combineChannelCredentials:(r,...e)=>e.reduce((t,n)=>t.compose(n),r),combineCallCredentials:(r,...e)=>e.reduce((t,n)=>t.compose(n),r),createInsecure:ca.ChannelCredentials.createInsecure,createSsl:ca.ChannelCredentials.createSsl,createFromSecureContext:ca.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:la.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:la.CallCredentials.createFromGoogleCredential,createEmpty:la.CallCredentials.createEmpty};R.closeClient=r=>r.close();R.waitForClientReady=(r,e,t)=>r.waitForReady(e,t);R.loadObject=(r,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};R.load=(r,e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};R.setLogger=r=>{Gc.setLogger(r)};R.setLogVerbosity=r=>{Gc.setLoggerVerbosity(r)};R.getClientChannel=r=>Cg.Client.prototype.getChannel.call(r);var da=Mo();Object.defineProperty(R,"ListenerBuilder",{enumerable:!0,get:function(){return da.ListenerBuilder}});Object.defineProperty(R,"RequesterBuilder",{enumerable:!0,get:function(){return da.RequesterBuilder}});Object.defineProperty(R,"InterceptingCall",{enumerable:!0,get:function(){return da.InterceptingCall}});Object.defineProperty(R,"InterceptorConfigurationError",{enumerable:!0,get:function(){return da.InterceptorConfigurationError}});var Tg=pn();Object.defineProperty(R,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return Tg.getChannelzServiceDefinition}});Object.defineProperty(R,"getChannelzHandlers",{enumerable:!0,get:function(){return Tg.getChannelzHandlers}});var wT=Gi();Object.defineProperty(R,"addAdminServicesToServer",{enumerable:!0,get:function(){return wT.addAdminServicesToServer}});var OT=xc();R.experimental=OT;var AT=hg(),NT=fg(),kT=yg(),PT=Sg(),IT=bg(),MT=Mc(),xT=pn(),DT=Kl().version;Gc.trace(ua.LogVerbosity.DEBUG,"index","Loading @grpc/grpc-js version "+DT),AT.setup(),NT.setup(),kT.setup(),PT.setup(),IT.setup(),MT.setup(),xT.setup()});var LT=exports&&exports.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),qT=exports&&exports.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),FT=exports&&exports.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&LT(e,r,t);return qT(e,r),e};Object.defineProperty(exports,"__esModule",{value:!0});var BT=require("child_process"),UT=FT(Da()),zT=(ed(),iu(Zu)),jT=(nd(),iu(rd)),wg=Rg(),HT=[];function $T(r){UT.debug(r),HT.push(r)}process.env.IS_BACKGROUND?GT():(console.log("spawning"),$T("foreground"),(0,BT.spawn)(process.execPath,process.argv.slice(1),{detached:!0,stdio:"inherit",env:eu(Zc({},process.env),{IS_BACKGROUND:"1"})}).unref());function GT(){var a;let e=`${process.env.ACTIONS_CACHE_URL||"http://localhost:3056/"}_apis/artifactcache/`,t=(a=process.env.ACTIONS_RUNTIME_TOKEN)!=null?a:"",n=new zT.ActionsCache(e,t),i=new jT.HttpServer(n);i.on("close",()=>{console.log("Goodbye: "+JSON.stringify(i.getStats()))});let s=new wg.Server;s.bindAsync("0.0.0.0:4000",wg.ServerCredentials.createInsecure(),()=>{s.start()}),i.listen(3055)}
/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
